# 第3回：Driveアップロードが合図になる！Gemini要約×Chat連携の方法

**動画時間**: 10分
**学習目標**: Geminiを使ったファイル要約機能を理解し、Drive→Gemini要約→Chat通知のエージェントを構築する。AIステップの使い方とGeminiのソース設定を習得する

---

## 1. 導入（0:00-1:00）

### 講師セリフ

「皆さん、こんにちは。第3回では、AIの本領発揮です。

Driveにファイルがアップロードされたら、Geminiが自動で要約して、Chatに通知する。このエージェントを作ります。

**（画面：Driveにファイルアップロード→Gemini要約→Chat通知の流れ）**

これができると、長い資料を読む時間が大幅に短縮されます。要点だけをGeminiがまとめてくれるので、確認工数が80%削減できます。

今日は、Geminiの活用方法、AIステップの使い方、そしてソース設定など、AI自動化の核心に迫ります。」

---

## 2. Before / After の提示（1:00-2:00）

### 講師セリフ

「具体的にどう変わるのか、Before/Afterで見ていきましょう。

### Before：手作業での確認

**（画面：Before の状況を表示）**

1. Driveにファイルがアップロードされる
2. ファイルを開いて内容を確認（10分）
3. 要点を整理してメモを作成（5分）
4. Chatに手動で共有（3分）
5. **合計：1件18分**

### After：自動化後

**（画面：After の状況を表示）**

1. Driveにファイルがアップロードされる
2. Geminiが自動で要約→Chatに通知（0秒）
3. **確認工数80%削減**

このように、Geminiを活用することで、ファイルの確認と共有が完全自動化されます。」

---

## 3. デモ（見せ場）（2:00-3:00）

### 講師セリフ

「それでは、完成形をお見せします。

**（画面：Driveの特定フォルダにPDFファイルをアップロード）**

このフォルダにプロジェクト提案書をアップロードします。アップロードすると…

**（画面：数秒後、Chatに要約通知が表示される）**

ほら、Chatに要約が届きました！Geminiが10ページの資料を、3つの要点にまとめてくれています。

**（画面：要約内容をアップで表示）**

このように、ファイルの主要なポイントが、わかりやすく整理されています。

これを、今から一緒に作っていきます。」

---

## 4. 構築手順の全体像（3:00-4:00）

### 講師セリフ

「エージェントの構築手順は、3ステップです。

**（画面：3ステップの図を表示）**

### ステップ1：スターター（Driveフォルダ）を設定

どのDriveフォルダを監視するか、選択します。

### ステップ2：Gemini要約ステップを追加

Geminiにファイルを要約させるAIステップを追加します。ここで、プロンプトとソース設定を行います。

### ステップ3：Chat通知を設定

Geminiの要約を、変数を使ってChat通知に含めます。

たったこれだけです。それでは、実際の画面操作を見ていきましょう。」

---

## 5. 設定実演（4:00-8:00）

### 講師セリフ

「それでは、実際に設定していきます。

### ① エージェントを新規作成

**（画面：workflows.workspace.google.com にアクセス）**

Flowsにアクセスし、今回はカスタムエージェントを手動で作成します。

**（画面：「New agent」ボタンをクリック）**

「New agent」をクリックします。

### ② スターター設定：Driveフォルダを選ぶ

**（画面：スターター選択画面）**

スターターは「When a file is added to a Drive folder」（Driveフォルダにファイルが追加されたとき）を選択します。

**（画面：フォルダ選択）**

監視したいDriveフォルダを選択します。今回は「Project Proposals」フォルダを選びます。

### ③ Gemini要約ステップを追加

**（画面：「Add step」をクリック）**

次に、「Add step」をクリックして、ステップを追加します。

**（画面：AIステップ一覧）**

ここで重要なのが、**AIステップの選択**です。Workspace Flowsには、様々なAIステップがあります。

- **Summarize**：テキストから要点を取得
- **Ask Gemini**：一般的な質問やテキスト生成
- **Extract**：テキストから特定の情報を抽出
- **Decide**：AIを使った条件判定

今回は、ファイルの要約なので、「**Summarize**」を選択します。

### ④ Summarizeステップの設定

**（画面：Summarize設定画面）**

Summarizeステップには、事前定義されたオプションがあります。

**（画面：「What to summarize」欄）**

「What to summarize」（何を要約するか）で、変数を追加します。

「Variables」ボタンをクリックして、「Link to the file」（ファイルへのリンク）を選択します。

**重要**：ファイルパスではなく、「Link to the file」を選択してください。

**（画面：カスタムプロンプト入力）**

次に、要約の内容や形式を指定します。「Custom request」（カスタムリクエスト）を選択し、以下のようなプロンプトを入力します。

```
以下のファイルを要約してください。
要点を3つの箇条書きでまとめ、カジュアルで寄り添うトーンで書いてください。
```

**プロンプトのベストプラクティス**：

1. **コンテキストを明記**：Geminiはエージェントの他のステップを認識しないため、プロンプトに十分なコンテキストを提供
2. **変数を参照**：前のステップのデータを参照するために変数を追加
3. **具体的に指示**：トーン（カジュアル、ビジネスライク）、文量（3行、5つの箇条書き）、観点（マーケティング、技術）を明確に

### ⑤ Geminiのソース設定

**（画面：ソース設定）**

次に、重要な設定が「Geminiのソース設定」です。

Geminiが参照できるソースを選択できます。

- **Google Workspace と Web**（デフォルト）：Gmail、Chat、Drive、カレンダーなど、あなたがアクセスできるすべてのWorkspaceデータとWebを参照できます
- **Web のみ**：公開Webサイトのみを参照します。組織のデータへのアクセスは許可されません

**（画面：ソース選択画面）**

**重要**：今回は、アップロードされたファイルを要約するため、「Google Workspace と Web」を選択します。

ただし、Geminiからの返信を外部に自動共有するエージェントでは、「Webのみ」を選択して、組織データの意図しない共有を防いでください。

### ⑥ Chat通知ステップを追加

**（画面：「Add step」をクリック）**

「Add step」をクリックして、Chat通知ステップを追加します。

**（画面：「Send a message in Chat」を選択）**

「Send a message in Chat」を選択します。

**（画面：Chatスペース選択）**

Chatスペースを選択します。第2回で学んだとおり、候補から選択してください。

**（画面：メッセージ編集）**

メッセージ内容を編集します。ここで、Geminiの要約を変数で追加します。

**（画面：変数追加）**

「Variables」ボタンをクリックして、Summarizeステップの「Response from Gemini」（Geminiからの応答）を選択します。

これで、Geminiが生成した要約が、Chat通知に含まれます。

例えば、こんなメッセージを作成できます：

```
📄 新しいファイルがアップロードされました

📁 ファイル名: [File name]
📅 アップロード日時: [Upload time]

📝 Geminiによる要約:
[Response from Gemini]

ファイルはこちら: [Link to the file]
```

### ⑦ テスト実行と有効化

**（画面：「Test run」ボタンをクリック）**

設定が完了したら、「Test run」でテストします。

**（画面：Chatに通知が表示）**

テストが成功したら、「Turn on」で有効化します。

これで、エージェントが本番稼働します！」

---

## 6. AIステップの活用ポイント（8:00-9:00）

### 講師セリフ

「AIステップの活用について、もう少し詳しく説明します。

### AIステップの種類と使い分け

**（画面：AIステップの比較表）**

- **Ask Gemini**：一般的な質問やテキスト生成に最適。最も柔軟ですが、プロンプトの作成が必要
- **Summarize**：テキスト要約に最適化。事前定義されたオプションで簡単に設定可能
- **Extract**：特定の情報（電話番号、住所、アクションアイテム）の抽出に最適
- **Decide**：AIを使った条件判定。複雑な条件を自然言語で指定可能

### 変数を使ったAIステップのチェーン

エージェントでは、複数のAIステップを使用できます。

例えば：
1. 「Extract」ステップで、フォーム回答から質問を抽出
2. 「Ask Gemini」ステップで、抽出した質問を使って回答を生成
3. その回答をメールで送信

このように、変数を使ってAIステップをつなげることで、高度な自動化が実現できます。

### プロンプトのベストプラクティス

1. **コンテキストを明記**：「以下のファイルを要約してください」のように、何を処理するか明確に
2. **トーンを指定**：「カジュアル」「ビジネスライク」「専門的」
3. **文量を指定**：「3行で」「5つの箇条書きで」
4. **観点を指定**：「マーケティングの観点から」「技術的な観点から」」

---

## 7. 注意点・活用ポイント（9:00-9:30）

### 講師セリフ

「いくつか、注意点と活用ポイントをお伝えします。

### 注意点1：ファイル形式の対応

Geminiは、PDF、Docs、Slides、Sheets に対応しています。画像ファイルや動画ファイルは要約できません。

### 注意点2：ソース設定の重要性

組織のデータが意図せず共有されるのを防ぐため、外部に自動共有するエージェントでは「Webのみ」を選択してください。

### 注意点3：変数の選択

要約対象は「Link to the file」を選択してください。ファイルパスやファイル名では動作しません。

### 活用ポイント：条件分岐との組み合わせ

次回学ぶ条件分岐を使うと、さらに高度な自動化が可能になります。

例えば：
- 緊急度の高いファイルだけを要約して通知
- ファイル形式に応じて、異なる要約方法を適用」

---

## 8. まとめ・次回予告（9:30-10:00）

### 講師セリフ

「今日は、Geminiを使ったファイル要約エージェントを作りました。

### 今日のポイント

1. AIステップは**Summarize, Ask Gemini, Extract, Decide**など用途に応じて選択
2. **Summarize**ステップで事前定義されたオプションを活用
3. 要約対象は「**Link to the file**」を変数で指定
4. **Geminiのソース設定**で、参照できるデータを制御
5. プロンプトには**コンテキスト、トーン、文量、観点**を明記
6. Geminiの応答を変数で後のステップに渡す

**（画面：今日のポイントを箇条書きで表示）**

次回は、最大のつまづきポイント「Chatスペース連携エラー」を徹底解説します。

**（画面：次回のタイトルを表示）**

次回：「もう迷わない！Chatスペース連携エラーを確実に解消する方法」

よくあるエラー事例と、確実な解決方法をお伝えします。それでは、次回もお楽しみに！」

---

## 画面表示資料一覧

1. Driveにファイルアップロード→Gemini要約→Chat通知の流れ（0:15）
2. Before の状況を表示（1:00）
3. After の状況を表示（1:30）
4. Driveの特定フォルダにPDFファイルをアップロード（2:00）
5. Chatに要約通知が表示される（2:20）
6. 要約内容をアップで表示（2:40）
7. 3ステップの図（3:00）
8. workflows.workspace.google.com にアクセス（4:00）
9. 「New agent」ボタンをクリック（4:15）
10. スターター選択画面（4:30）
11. フォルダ選択（4:45）
12. 「Add step」をクリック（5:00）
13. AIステップ一覧（5:15）
14. Summarize設定画面（5:30）
15. 「What to summarize」欄（5:45）
16. カスタムプロンプト入力（6:00）
17. ソース設定（6:30）
18. ソース選択画面（6:45）
19. Chat通知ステップを追加（7:00）
20. メッセージ編集（7:15）
21. 変数追加（7:30）
22. Test run ボタン（7:45）
23. AIステップの比較表（8:00）
24. 今日のポイントまとめ（9:30）
25. 次回のタイトル表示（9:50）

---

## デモで使用する設定・ファイル

- テスト用のDriveフォルダ（「Project Proposals」など）
- テスト用のPDFファイル（プロジェクト提案書など）
- テスト用のChatスペース（「Team Workspace」など）

### Summarizeプロンプト例

```
以下のファイルを要約してください。
要点を3つの箇条書きでまとめ、カジュアルで寄り添うトーンで書いてください。
```

---

## 講師への補足指示

- **AIステップの重要性**：AIステップの種類と使い分けを丁寧に説明してください
- **ソース設定の強調**：Geminiのソース設定の重要性を強調してください。組織データ保護の観点から非常に重要です
- **プロンプトのベストプラクティス**：良いプロンプトの書き方を具体例とともに説明してください
- **変数のチェーン**：変数を使ってAIステップをつなげる方法を説明してください
- **実演のポイント**：実際の画面操作を、ゆっくり、はっきりと見せてください
- **テンポ**：AIステップの説明は重要なので、時間をかけて丁寧に進めてください
