# 第4回：もう迷わない！Chatスペース連携エラーを確実に解消する方法

**動画時間**: 10分
**学習目標**: Chatスペース連携で発生する典型的なエラーを理解し、確実に解決できるようになる

---

## 1. 導入（0:00-1:00）

### 講師セリフ

「皆さん、こんにちは。第4回では、Google Workspace Flowsで**最もつまづきやすいポイント**、『Chatスペース連携』のエラー解決方法を徹底解説します。

**（画面：エラーメッセージの例）**

多くの人が、こんな経験をしています：
- スペース名を入力しても動かない！
- Webhook URLを貼り付けてもエラー！
- テストは成功するのに、本番で通知が届かない！

**（画面：第2回、第3回の復習シーン）**

第2回と第3回で、Chatスペース連携の基本はお伝えしましたが、今日はさらに深掘りして、**よくあるエラーパターンと確実な解決方法**をお伝えします。

これを見れば、もうChatスペース連携で迷うことはありません！」

---

## 2. よくあるエラー3選と原因（1:00-4:00）

### 講師セリフ

「まず、よくあるエラーを3つ見ていきましょう。

### エラー1：スペース名を手動入力してしまう

**（画面：❌ 失敗例を表示）**

❌ **失敗例**：
スペース欄に「Marketing Team」と全部手動で入力

**なぜダメなのか？**
Workspace Flowsは、スペース名ではなく、**スペースの内部ID**で識別します。手動入力では、IDが取得できないため、エラーになります。

**（画面：⭕ 正解を表示）**

⭕ **正解**：
1. スペース欄をクリック
2. スペース名の一部（例：「Market」）を入力
3. 表示された候補から選択

候補から選択することで、スペースIDが自動的に設定されます。

### エラー2：Webhook URLを貼り付けてしまう

**（画面：❌ 失敗例を表示）**

❌ **失敗例**：
「Webhook URLが必要だと思って、Chatスペースの設定からWebhook URLをコピーして、スペース欄に貼り付け」

**なぜダメなのか？**
Workspace Flowsの**内部統合**では、Webhook URLは不要です。Webhook URLが必要なのは、Slack や Microsoft Teams など、**外部サービスとの連携**の場合のみです。

**（画面：⭕ 正解を表示）**

⭕ **正解**：
Google Workspace内のChatスペースへの通知には、Webhook URLは不要。候補から選択するだけでOKです。

### エラー3：参加していないスペースを選択してしまう

**（画面：❌ 失敗例を表示）**

❌ **失敗例**：
自分が参加していないChatスペースを選択

**なぜダメなのか？**
エージェントは、**あなたのアカウント権限**で動作します。あなたが参加していないスペースには、エージェントも通知を送れません。

**（画面：⭕ 正解を表示）**

⭕ **正解**：
1. 事前に、通知を送りたいChatスペースに参加
2. 参加後、候補から選択

**（画面：3つのエラーまとめ表）**

この3つが、最も多いエラーパターンです。」

---

## 3. 正しい設定方法の実演（4:00-7:00）

### 講師セリフ

「それでは、正しい設定方法を、実際の画面で確認していきましょう。

### ステップ1：Chatスペースに参加する

**（画面：Google Chatの画面）**

まず、通知を送りたいChatスペースに参加します。

スペースを開いて、「Add people」（ユーザーを追加）から、自分自身を追加します。すでに参加している場合は、このステップはスキップしてください。

### ステップ2：エージェント編集画面でスペース欄をクリック

**（画面：Workspace Flowsのエージェント編集画面）**

エージェント編集画面で、「Send a message in Chat」ステップを開きます。

「Space」欄をクリックします。

### ステップ3：スペース名の一部を入力

**（画面：入力欄に「Market」と入力）**

スペース名の一部を入力します。例えば、「Marketing Team」というスペースなら、「Market」と入力します。

### ステップ4：候補から選択

**（画面：候補が表示される）**

入力すると、候補が表示されます。この候補から、目的のスペースをクリックして選択します。

**（画面：選択後、スペース名が表示される）**

選択すると、スペース名が表示されます。これで、スペースIDが正しく設定されました。

### ステップ5：テスト実行で確認

**（画面：「Test run」ボタンをクリック）**

「Test run」をクリックして、テスト実行します。

**（画面：Chatに通知が表示される）**

Chatに通知が届けば、成功です！

**（画面：エラーが表示される場合）**

もしエラーが表示される場合は、以下を確認してください：
- スペースに参加しているか
- 候補から選択したか（手動入力していないか）
- スペースが削除されていないか」

---

## 4. 内部統合とWebhookの違い（7:00-8:30）

### 講師セリフ

「ここで、「内部統合」と「Webhook」の違いを整理しておきましょう。

### 内部統合（Internal Integration）

**（画面：内部統合の図）**

- **使用場面**：Google Workspace内のサービス（Chat、Drive、Gmail、Calendar）と連携する場合
- **設定方法**：スペースやフォルダを候補から選択するだけ
- **Webhook URL**：不要
- **セキュリティ**：Workspace内で完結するため、安心

**例**：
- Chatスペースへの通知
- Driveフォルダへのファイル追加
- Gmailでのメール送信

### Webhook（外部統合）

**（画面：Webhookの図）**

- **使用場面**：Slack、Microsoft Teams、Asanaなど、**外部サービス**と連携する場合
- **設定方法**：外部サービスのWebhook URLを設定
- **Webhook URL**：必要
- **セキュリティ**：外部サービスにデータが送信されるため、信頼できるサービスのみと連携

**例**：
- Slackチャンネルへの通知
- Microsoft Teamsへのメッセージ送信
- Asanaタスクの作成

**（画面：比較表）**

| 項目 | 内部統合 | Webhook |
|------|---------|---------|
| 対象 | Google Workspace内 | 外部サービス |
| 設定 | 候補から選択 | Webhook URL設定 |
| URL | 不要 | 必要 |
| セキュリティ | Workspace内で完結 | 外部にデータ送信 |

**重要**：Google ChatへはGeminiからの要約を通知する場合でも、内部統合を使用します。Webhook URLは不要です。」

---

## 5. トラブルシューティング（8:30-9:30）

### 講師セリフ

「最後に、その他のよくあるトラブルと解決方法をお伝えします。

### トラブル1：テストは成功するのに、本番で通知が届かない

**原因**：
エージェントを「Turn on」していない可能性があります。

**解決方法**：
エージェント編集画面で、「Turn on」ボタンをクリックして、エージェントを有効化してください。

### トラブル2：通知が遅れて届く

**原因**：
Workspace Flowsは、リアルタイムではなく、数分の遅延が発生する場合があります。

**解決方法**：
通常、1〜5分程度の遅延は正常です。10分以上遅延する場合は、エージェントのアクティビティを確認してください。

### トラブル3：エージェントが突然動かなくなった

**原因**：
- スペースが削除された
- スペースから除外された
- フォームやDriveフォルダの権限が変更された

**解決方法**：
エージェントのアクティビティでエラーを確認し、権限を再設定してください。

### アクティビティの確認方法

**（画面：My agents 画面）**

1. Flowsホーム画面で「My agents」をクリック
2. エージェントの横にある「More」→「Activity」をクリック
3. エラーログを確認

エラーメッセージから、原因を特定できます。」

---

## 6. まとめ・次回予告（9:30-10:00）

### 講師セリフ

「今日は、Chatスペース連携のエラー解決方法を学びました。

### 今日のポイント

1. **スペースは候補から選択**（手動入力NG）
2. **Webhook URLは不要**（内部統合の場合）
3. **事前にスペースに参加**（権限確認）
4. **内部統合とWebhookの違い**を理解
5. **アクティビティでエラー確認**

**（画面：今日のポイントを箇条書きで表示）**

次回は最終回。作成したエージェントをチーム全員で使える仕組みにする方法を学びます。

**（画面：次回のタイトルを表示）**

次回：「チーム全員で使える仕組みに変える！自動化フローのテンプレート化と共有術」

エージェントの共有方法、権限設定、チーム展開のポイントをお伝えします。それでは、次回もお楽しみに！」

---

## 画面表示資料一覧

1. エラーメッセージの例（0:15）
2. 第2回、第3回の復習シーン（0:30）
3. ❌ 失敗例：スペース名を手動入力（1:00）
4. ⭕ 正解：候補から選択（1:30）
5. ❌ 失敗例：Webhook URL貼り付け（2:00）
6. ⭕ 正解：Webhook URL不要（2:30）
7. ❌ 失敗例：参加していないスペース（3:00）
8. ⭕ 正解：事前に参加（3:30）
9. 3つのエラーまとめ表（3:45）
10. Google Chatの画面（4:00）
11. エージェント編集画面（4:30）
12. 入力欄に「Market」と入力（5:00）
13. 候補が表示される（5:15）
14. 選択後、スペース名が表示される（5:30）
15. 「Test run」ボタンをクリック（6:00）
16. Chatに通知が表示される（6:15）
17. エラーが表示される場合（6:30）
18. 内部統合の図（7:00）
19. Webhookの図（7:30）
20. 比較表（8:00）
21. My agents 画面（8:30）
22. 今日のポイントまとめ（9:30）
23. 次回のタイトル表示（9:50）

---

## デモで使用する設定・ファイル

- テスト用のChatスペース（「Marketing Team」など）
- エラー例のスクリーンショット
- 正しい設定例のスクリーンショット
- アクティビティ画面のスクリーンショット

---

## 講師への補足指示

- **用語の統一**：「フロー」ではなく「エージェント」を使用してください
- **エラー解決の重要性**：この動画で、受講者のつまづきを解消することが最重要です
- **実演のポイント**：正しい設定方法を、ゆっくり、丁寧に見せてください
- **トラブルシューティング**：よくあるトラブルと解決方法を具体的に説明してください
- **前向きな雰囲気**：「エラーは誰でも経験するもの」という安心感を与えてください
- **次回への期待**：最終回のチーム展開に期待を持たせてください
