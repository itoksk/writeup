# 第2回：グラフもAIにおまかせ！PythonコードをChatGPTに書かせる技術（10分）

## オープニング（0:00-0:30）

### 導入フレーズ
「みなさん、こんにちは。売上データ分析×ChatGPT研修の第2回へようこそ。

前回は、ChatGPTにCSVファイルを読み込ませて傾向を分析する方法を学びました。

今日は、『手作業グラフはもう卒業。ChatGPTにPythonを書かせて、一瞬でビジュアル分析！』というテーマで進めていきます。

プログラミング経験がゼロでも大丈夫。ChatGPTがすべてのコードを書いてくれます。」

## 1. 現状の課題とゴール設定（0:30-1:30）

### Before状態の確認
「現在、みなさんはExcelでグラフを作成する際、こんな作業をしているはずです。

データ範囲を選択して...
挿入タブからグラフを選んで...
軸ラベルを設定して...
色を調整して...

1つのグラフを作るのに5分。
複数の視点でグラフを作ると30分はかかりますよね。

しかも、Excelの棒グラフだけでは、季節変動や移動平均といった高度な分析は表現しづらい。」

### After状態の提示
「でも今日の10分間で、ChatGPTを使って以下のことができるようになります：

- 棒グラフ、線グラフ、複合グラフの自動生成
- 移動平均線の追加
- 前年同期比のビジュアル化
- カスタマイズ可能な美しいグラフ

しかも、コードは一行も書きません。すべてChatGPTに依頼するだけです。」

## 2. 基本デモンストレーション（1:30-4:00）

### データの準備
「まず、前回と同じsales_data_monthly.csvを使います。

ChatGPTの画面を開いて、ファイルをアップロードしてください。

アップロードが完了したら、次のステップに進みます。」

### 基本的なグラフ生成プロンプト
「では、最初のプロンプトを入力してみましょう。

『この売上CSVをもとに、月ごとの売上を棒グラフにするPythonコードを作ってください。グラフには日本語のタイトルとラベルを付けてください。』

エンターキーを押します。」

### 生成されたコードの解説
「見てください！ChatGPTが完全なPythonコードを生成してくれました。

```python
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

# 日本語フォントの設定
plt.rcParams['font.family'] = 'sans-serif'
plt.rcParams['font.sans-serif'] = ['Hiragino Sans']

# データの読み込み
df = pd.read_csv('sales_data_monthly.csv')

# グラフの作成
plt.figure(figsize=(12, 6))
plt.bar(df['Month'], df['Sales'], color='steelblue')
plt.title('月別売上推移', fontsize=16)
plt.xlabel('月', fontsize=12)
plt.ylabel('売上（円）', fontsize=12)
plt.xticks(rotation=45)
plt.grid(axis='y', alpha=0.3)
plt.tight_layout()
plt.show()
```

このコードについて、重要な部分だけ説明します：
- pandas：データを扱うライブラリ
- matplotlib：グラフを描くライブラリ
- 日本語フォントの設定も自動で含まれています」

### コードの実行方法
「このコードを実行する方法は3つあります：

1. Google Colabを使う（推奨）
2. ローカルのPython環境
3. ChatGPT上で直接実行（Code Interpreter機能）

今日はGoogle Colabで実演します。

Google Colabを開いて、新しいノートブックを作成。
先ほどのコードをコピー＆ペースト。
実行ボタンをクリック。

...はい！美しい棒グラフが表示されました！」

## 3. 高度なグラフ作成（4:00-6:30）

### 複合グラフの作成
「次は、もう少し高度なグラフを作ってみましょう。

新しいプロンプトを入力します：

『売上データから以下を含む複合グラフを作成するPythonコードを生成してください：
1. 月別売上の棒グラフ
2. 3ヶ月移動平均の線グラフ
3. 前年同月比の折れ線グラフ（第2軸）
4. 平均値の水平線』

...ChatGPTが生成したコードを見てください。」

### 生成された高度なコード
「今度はより複雑なコードが生成されました：

```python
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

# データ読み込みと前処理
df = pd.read_csv('sales_data_monthly.csv')
df['Moving_Avg'] = df['Sales'].rolling(window=3).mean()
df['YoY_Growth'] = df['Sales'].pct_change(12) * 100

# 図の設定
fig, ax1 = plt.subplots(figsize=(14, 7))

# 第1軸：棒グラフと移動平均
ax1.bar(df['Month'], df['Sales'], alpha=0.7, color='steelblue', label='売上')
ax1.plot(df['Month'], df['Moving_Avg'], color='red', linewidth=2, label='3ヶ月移動平均')
ax1.axhline(y=df['Sales'].mean(), color='green', linestyle='--', label='平均値')

# 第2軸：前年同月比
ax2 = ax1.twinx()
ax2.plot(df['Month'], df['YoY_Growth'], color='orange', marker='o', label='前年同月比(%)')

# ラベルとタイトル
ax1.set_xlabel('月')
ax1.set_ylabel('売上（円）')
ax2.set_ylabel('前年同月比（%）')
plt.title('売上分析ダッシュボード')

# 凡例
ax1.legend(loc='upper left')
ax2.legend(loc='upper right')

plt.grid(True, alpha=0.3)
plt.show()
```

このコードで、プロ級の分析グラフが完成します！」

### カスタマイズの方法
「さらに、グラフをカスタマイズしたい場合は、ChatGPTに追加の指示を出します：

『グラフの色を会社のブランドカラー（青:#004B87）に変更して、売上が目標値を超えた月を赤で強調してください』

ChatGPTは即座に修正版のコードを提供してくれます。」

## 4. エラー対処とトラブルシューティング（6:30-8:00）

### よくあるエラーと対処法
「実際に使っていると、エラーに遭遇することがあります。

エラー例1：ModuleNotFoundError
対処法：ChatGPTに『このエラーが出ました：[エラーメッセージ]。修正してください』と伝える

エラー例2：日本語が文字化けする
対処法：『日本語フォントの設定を追加してください』とChatGPTに依頼

エラー例3：グラフが表示されない
対処法：『plt.show()を追加してください』と指示」

### デバッグのコツ
「エラーが出たときの黄金ルール：

1. エラーメッセージをそのままChatGPTにコピペ
2. 『このエラーを修正してください』と依頼
3. ChatGPTが修正版を提供
4. それでも動かない場合は、環境を指定（例：Google Colab環境で）

この方法で、99%のエラーは解決できます。」

## 5. 実務での活用パターン（8:00-9:00）

### 定型レポート用テンプレート
「実務でよく使うグラフパターンを紹介します：

月次レポート用：
『月別売上と目標達成率を並べた棒グラフを作成』

四半期レビュー用：
『四半期ごとの売上推移と成長率を複合グラフで表示』

年次総括用：
『12ヶ月の売上、移動平均、季節指数を1つのグラフに』

これらのプロンプトをテンプレート化しておけば、毎回5秒でグラフが作成できます。」

### 継続的な活用のコツ
「グラフ作成を習慣化するためのコツを紹介します：

**プロンプトテンプレートの活用：**
よく使うプロンプトは保存しておき、データ部分だけ変更して再利用しましょう。

例：
『[データ名]から[期間]の[項目]を[グラフ種類]で作成してください』

**段階的な改善：**
1. 最初は基本的な棒グラフから始める
2. 慣れてきたら色やラベルを追加指示
3. さらに複合グラフに挑戦

無理をせず、少しずつレベルアップしていきましょう。」

## 6. まとめと次回予告（9:00-10:00）

### 本日の成果確認
「今日学んだことを振り返りましょう：

1. ChatGPTにPythonコードを書かせる方法
2. 基本的なグラフから複合グラフまでの作成
3. エラーが出ても慌てない対処法
4. 実務で使えるテンプレートパターン

グラフを自動生成できると、傾向がもっと"見える化"されます。

これで、月次レポートの作成時間が30分から5分に短縮できるはずです。」

### 次回予告
「次回第3回では、いよいよ『来月の売上を予測する』という、より高度な分析に挑戦します。

ChatGPTに予測モデルを構築させて、根拠のある売上予測を実現する方法を学びます。

統計の知識がなくても大丈夫。ChatGPTがすべて説明してくれます。

それでは、今日学んだグラフ作成を、ぜひ実際の業務データで試してみてください。

第2回の講座は以上です。お疲れさまでした！」

---

## 講師用メモ

### タイムキーパー
- 0:00-0:30：オープニング
- 0:30-1:30：課題設定
- 1:30-4:00：基本デモ（最重要）
- 4:00-6:30：高度なグラフ
- 6:30-8:00：エラー対処
- 8:00-9:00：活用パターン
- 9:00-10:00：まとめ

### デモの注意点
- Google Colabは事前に開いておく
- サンプルデータは複数パターン準備
- エラーは意図的に1つ発生させて対処法を実演

### 受講者のレベル別対応
- 初級者：基本グラフの作成に集中
- 中級者：複合グラフまで挑戦
- 上級者：カスタマイズや自動化まで紹介

---

## 上級テクニック（経験者向け）

### GPTsを使った更なる効率化
「ChatGPTのGPTs機能を使うと、さらに効率化できます：

**GPTs設定のメリット：**
- 分析用Pythonコードを事前にアップロード
- 毎回同じ分析を瞬時に実行
- チーム全体で同じ分析基準を共有
- エラー処理も自動化

**設定手順：**
1. ChatGPTの「Explore GPTs」から「Create a GPT」を選択
2. Knowledgeセクションに分析スクリプトをアップロード
3. Instructionsに定型分析の指示を記載
4. チームメンバーと共有

これで、CSVをアップロードするだけで、常に同じ品質の分析レポートが生成されます。

### 高度なカスタマイズ技法
**複雑なスタイリング指示：**
- 「企業ブランドカラー（#004B87）を使用」
- 「フォントサイズを14pt、タイトルを18ptに」
- 「背景をグラデーションにして透明度0.7に設定」
- 「凡例の位置を右上、枠線なしに」

**動的なグラフ生成：**
- 「データが更新されたら自動でグラフを再生成」
- 「閾値を超えた項目を赤色で強調表示」
- 「季節ごとに異なる色分けを適用」