# A/Bテスト管理シート設定ガイド

## 1. Google Sheetsでの初期設定

### シートの作成
1. 新しいGoogle Sheetsを作成
2. シート名を「ABテスト管理」に変更
3. 提供されたCSVファイルをインポート

### データのインポート方法
1. ファイル → インポート
2. 「ABテスト管理_テンプレート.csv」をアップロード
3. インポート場所：「現在のシートを置換する」を選択
4. セパレータの種類：「カンマ」を選択

## 2. スクリプトの設定

### Google Apps Scriptの追加
1. 拡張機能 → Apps Script
2. 提供された「ABテスト自動分析スクリプト.gs」の内容をコピー＆ペースト
3. プロジェクト名を「AI承認ABテスト分析」に変更
4. 保存（Ctrl+S または Cmd+S）

### 初回実行の準備
1. 関数選択で「testAnalysis」を選択
2. 実行ボタンをクリック
3. 権限の承認（初回のみ）
   - 「権限を確認」→「詳細」→「安全でないページに移動」→「許可」

## 3. データ形式の確認

### 必須列の構成
- A列: 日付（例：2024-01-01）
- B列: 案件内容（テキスト）
- C列: プロンプト版（「プロンプトA」または「プロンプトB」）
- D列: AI判断（承認/条件付き承認/却下）
- E列: AI信頼度（例：85%）
- F列: 実際結果（成功/失敗/期待通り等）
- G列: 正誤判定（1または0）
- H列: カテゴリ（システム投資/マーケティング/人材育成）
- I列: 金額レンジ（例：30万円）
- J列: 備考（任意）

### 正誤判定の計算式
G列に以下の計算式を設定：
```
=IF(AND(D2<>"", F2<>""), IF(OR(AND(D2="承認", OR(F2="成功", F2="期待通り", F2="大成功", F2="問題なし")), AND(D2="却下", OR(F2="却下正解", F2="見送り正解", F2="代替案採用")), AND(D2="条件付き承認", OR(F2="成功", F2="段階実施で成功", F2="テスト後成功", F2="効果あり", F2="段階導入で成功", F2="最適化後成功"))), 1, 0), "")
```

## 4. トラブルシューティング

### データが読み込まれない場合
1. シート名が「ABテスト管理」になっているか確認
2. ヘッダー行（1行目）が正しく設定されているか確認
3. プロンプト版の値が完全一致しているか確認（スペースなど）

### 精度が0%になる場合
1. G列（正誤判定）に値が入っているか確認
2. C列のプロンプト版が「プロンプトA」「プロンプトB」と完全一致しているか確認
3. スクリプトのログを確認（表示 → ログ）

### デバッグ方法
1. Apps Scriptエディタで「testAnalysis」関数を実行
2. 表示 → ログ でデバッグ情報を確認
3. コンソールに出力される内容を確認

## 5. 週次自動実行の設定

### トリガーの設定
1. Apps Scriptエディタで時計アイコンをクリック
2. 「トリガーを追加」をクリック
3. 以下を設定：
   - 実行する関数：analyzeABTest
   - イベントのソース：時間主導型
   - 時間ベースのトリガーのタイプ：週ベースのタイマー
   - 曜日：月曜日
   - 時刻：午前9時〜10時

## 6. 分析結果の確認

### 自動生成される「分析結果」シート
- 分析日時
- プロンプトA/Bの精度
- 改善率
- サンプル数
- 統計的有意性
- 勝者判定

### ログでの詳細確認
Apps Scriptの実行ログで以下を確認：
- 各プロンプトの詳細な精度
- カテゴリ別の分析結果
- 失敗パターンの詳細
- 改善提案

## 7. 運用のベストプラクティス

### データ入力のタイミング
- AI判断（D〜E列）：リアルタイムで自動入力
- 実際結果（F列）：3ヶ月後に手動で更新
- 正誤判定（G列）：計算式で自動判定

### 改善サイクル
1. 2週間以上のデータ収集
2. 週次分析の実行
3. 結果に基づくプロンプト改善
4. 新しいA/Bテストの開始

### 注意事項
- サンプル数30件以上で統計的有意性を判定
- カテゴリごとに偏りがないようデータを収集
- 季節性を考慮した長期的な評価