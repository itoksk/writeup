# 第4回：現場で使うためのカスタマイズ術と知っておくべき注意点

**動画時間**: 10分
**学習目標**: テンプレートのカスタマイズ方法、高度な機能、セキュリティ考慮事項を理解する

---

## 1. 導入（0:00-1:00）

### 講師セリフ

「皆さん、こんにちは。前回は、Studioの機能と実践的な活用事例を学びました。

今回は、この講座の最終回として、**現場で実際に使うためのカスタマイズ術と、知っておくべき注意点**を解説します。

**（画面：今日のアジェンダを表示）**

今日学ぶこと：
1. テンプレートのカスタマイズ方法
2. Apps Scriptによる拡張
3. セキュリティとアクセス制御
4. よくあるトラブルと対処法
5. 導入時のベストプラクティス

これらを学ぶことで、Studioを安全かつ効果的に現場に導入できるようになります。」

---

## 2. テンプレートのカスタマイズ（1:00-3:00）

### 講師セリフ

「まず、テンプレートをカスタマイズする方法を見ていきましょう。

**（画面：テンプレート編集画面）**

### ステップの追加

テンプレートに新しいステップを追加できます。

**（画面：ステップ追加ボタン）**

例えば、メール要約エージェントに「Sheetsに記録」ステップを追加すると：

1. Geminiがメールを要約
2. Chatに通知
3. **Sheetsにログを記録**（追加）

これで、要約履歴を後から確認できるようになります。

### ステップの順序変更

ステップの順序はドラッグ&ドロップで変更できます。

**（画面：ドラッグ&ドロップの様子）**

処理の順序を変えたい場合や、条件分岐を追加したい場合に便利です。

### 条件分岐の追加

Geminiの判断結果に基づいて、次のアクションを変えることができます。

**（画面：条件分岐の設定）**

例：
- 優先度が「高」→ 即座にChat通知
- 優先度が「低」→ 日次サマリーに含める

### 変数の活用

変数を使うことで、前のステップの出力を次のステップで使えます。

**（画面：変数選択の画面）**

変数の例：
- `{gemini_response}` - Geminiの出力
- `{sender_email}` - メール送信者
- `{file_name}` - ファイル名

これらを組み合わせて、動的なメッセージを作成できます。」

---

## 3. Apps Scriptによる拡張（3:00-5:00）

### 講師セリフ

「より高度なカスタマイズが必要な場合は、Apps Scriptを使って独自のステップを作成できます。

**（画面：Apps Script連携の説明）**

### Apps Scriptでできること

**① カスタムAPI連携**

社内システムやサードパーティAPIと連携する独自のステップを作成できます。

**② 複雑なデータ処理**

標準ステップでは対応できない複雑な計算やデータ変換を実装できます。

**③ Vertex AI連携**

GeminiとVertex AIを連携させ、より高度なAI機能を組み込めます。

### カスタムステップの作成手順

**（画面：開発者向けドキュメント）**

1. Apps Scriptでスクリプトを作成
2. StudioのカスタムステップとしてリンクWORK
3. エージェントでカスタムステップを使用

**（画面：コード例）**

```javascript
// カスタムステップの例
function processData(input) {
  // 入力データを処理
  const result = {
    processed: true,
    summary: '処理完了',
    data: input
  };
  return result;
}
```

### 注意点

**（画面：注意点一覧）**

- Apps Scriptの知識が必要
- 実行時間の制限あり
- エラーハンドリングを適切に実装
- テスト環境で十分に検証してから本番導入」

---

## 4. セキュリティとアクセス制御（5:00-7:00）

### 講師セリフ

「Studioを現場で使う際は、セキュリティを十分に考慮する必要があります。

**（画面：セキュリティ考慮事項）**

### ① アクセス制御

**エージェントの権限**

エージェントは、作成したユーザーの権限で動作します。自分がアクセスできないデータには、エージェントもアクセスできません。

**共有時の注意**

エージェントを共有する際は、共有相手がアクセスすべきデータのみを扱うエージェントに限定しましょう。

### ② データの取り扱い

**Geminiへのデータ送信**

エージェント内でGeminiを使用すると、処理対象のデータがGeminiに送信されます。機密情報を含む場合は注意が必要です。

**外部サービス連携**

サードパーティサービス（Asana、Jira等）と連携する際、データが外部に送信されます。組織のセキュリティポリシーを確認してください。

### ③ 管理者の制御

**（画面：管理コンソールの設定）**

管理者は、以下を制御できます：
- Studioの有効化/無効化
- OU/グループ単位でのアクセス制御
- 外部連携の許可/制限
- 監査ログの確認

### ④ ベストプラクティス

**（画面：セキュリティベストプラクティス）**

1. **最小権限の原則**：必要最小限のデータのみを扱う
2. **機密データの除外**：個人情報や機密情報は自動化の対象から除外
3. **定期的な監査**：エージェントの動作を定期的に確認
4. **チーム内レビュー**：重要なエージェントは複数人でレビュー」

---

## 5. よくあるトラブルと対処法（7:00-8:30）

### 講師セリフ

「Studioを使っていると、いくつかのトラブルに遭遇することがあります。よくある問題と対処法を紹介します。

**（画面：トラブルシューティングガイド）**

### トラブル1：エージェントが動作しない

**原因**：
- スターターの設定ミス
- 権限不足
- サービス側の一時的な問題

**対処法**：
- スターターの条件を確認
- テスト実行で動作確認
- 管理者に権限を確認
- しばらく待ってから再試行

### トラブル2：Geminiの出力が期待と異なる

**原因**：
- プロンプトが曖昧
- 入力データが複雑すぎる
- 言語設定の問題

**対処法**：
- プロンプトをより具体的に記述
- 出力形式を明確に指定
- 「日本語で回答して」を追加
- 入力データを事前に整理

### トラブル3：Chat通知が届かない

**原因**：
- Chatスペースへのアクセス権限がない
- スペースIDの設定ミス
- Chatアプリが無効化されている

**対処法**：
- Chatスペースのメンバーシップを確認
- スペースを再選択
- 管理者にChatの設定を確認

### トラブル4：外部連携エラー

**原因**：
- API認証の問題
- サービス側の制限
- ネットワークの問題

**対処法**：
- 連携を再認証
- サービスの状態を確認
- 管理者に問い合わせ」

---

## 6. 導入時のベストプラクティス（8:30-9:30）

### 講師セリフ

「最後に、Studioを組織に導入する際のベストプラクティスをお伝えします。

**（画面：導入ステップ）**

### ステップ1：小さく始める

いきなり複雑なエージェントを作るのではなく、シンプルなものから始めましょう。

**推奨**：
- まずは自分だけで使うエージェントから
- テンプレートをそのまま使う
- 1つのエージェントで1つの目的

### ステップ2：効果を測定する

導入前後で、どれくらい時間が節約できたかを測定しましょう。

**測定項目**：
- 作業時間の削減
- 対応スピードの向上
- エラーや漏れの減少

### ステップ3：チームに展開する

効果が確認できたら、チームに展開します。

**展開時のポイント**：
- エージェントを共有機能で配布
- 使い方のドキュメントを作成
- 質問窓口を設置

### ステップ4：継続的に改善する

定期的にエージェントを見直し、改善しましょう。

**改善のサイクル**：
- 実行履歴を確認
- エラーがあれば原因を特定
- プロンプトや設定を調整
- 新しいユースケースを検討」

---

## 7. まとめ・講座全体の振り返り（9:30-10:00）

### 講師セリフ

「以上で、『Google Workspace Studioの活用』講座は終了です。

### 今日のポイント

**（画面：今日のポイントを箇条書きで表示）**

1. **テンプレートのカスタマイズ**：ステップの追加・順序変更・条件分岐
2. **Apps Script拡張**：カスタムステップで高度な処理を実装
3. **セキュリティ**：最小権限の原則、機密データの除外、定期的な監査
4. **トラブル対処**：よくある問題と解決方法を把握
5. **導入ベストプラクティス**：小さく始めて、効果を測定し、段階的に展開

### 講座全体の振り返り

**（画面：講座全体のまとめ）**

**第1回**：Google Workspace Studioとは
- Gemini 3搭載のAIエージェント作成プラットフォーム
- プログラミング不要、自然言語で構築

**第2回**：登録と基本操作
- studio.workspace.google.comにアクセス
- テンプレートからエージェント作成

**第3回**：機能と活用事例
- スターター、Geminiステップ、サードパーティ連携
- フォーム通知、ファイル要約、会議準備、サポートトリアージ

**第4回**：カスタマイズと注意点
- テンプレートのカスタマイズ、Apps Script拡張
- セキュリティ考慮事項、ベストプラクティス

### 次のステップ

**（画面：次のステップを表示）**

1. 自分の業務で自動化できそうな作業を1つ選ぶ
2. テンプレートを使ってエージェントを作成する
3. 1週間運用して効果を測定する
4. チームに共有して展開する

皆さんがGoogle Workspace Studioを活用して、業務を効率化されることを願っています。

ご視聴ありがとうございました！」

---

## 画面表示資料一覧

1. 今日のアジェンダ（0:30）
2. テンプレート編集画面（1:00）
3. ステップ追加ボタン（1:30）
4. ドラッグ&ドロップの様子（1:50）
5. 条件分岐の設定（2:10）
6. 変数選択の画面（2:30）
7. Apps Script連携の説明（3:00）
8. 開発者向けドキュメント（3:40）
9. カスタムステップのコード例（4:00）
10. Apps Script注意点一覧（4:40）
11. セキュリティ考慮事項（5:00）
12. 管理コンソールの設定（5:50）
13. セキュリティベストプラクティス（6:30）
14. トラブルシューティングガイド（7:00）
15. 導入ステップ（8:30）
16. 今日のポイントまとめ（9:30）
17. 講座全体のまとめ（9:40）
18. 次のステップ（9:50）

---

## 講師への補足指示

- **実務視点**：現場で実際に使う際の注意点を強調
- **セキュリティ重視**：特にセキュリティ部分は丁寧に説明
- **トラブル対処**：受講者がつまずきそうなポイントを先回りして説明
- **ベストプラクティス**：小さく始めて段階的に展開することの重要性
- **振り返り**：講座全体を通じて学んだことを整理
- **次のアクション**：受講者が明日から取り組めるような具体的な次のステップを提示
- **感謝**：講座の最後なので、受講者への感謝を込めて締めくくる
