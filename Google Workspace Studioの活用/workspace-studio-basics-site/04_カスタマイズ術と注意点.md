# 第4回：現場で使うためのカスタマイズ術と知っておくべき注意点

**第4回 / 全4回（最終回）**

テンプレートのカスタマイズ、他ツールにはないWorkspace Studioの強み、
Apps Scriptとの組み合わせ、セキュリティ考慮事項、導入のベストプラクティスを学びます。

---

## テンプレートのカスタマイズ

### 01. ステップの追加
新しいステップを追加して機能を拡張。例：Sheetsへのログ記録を追加。

### 02. 順序変更
ドラッグ&ドロップでステップの順序を変更。処理フローを最適化。

### 03. 条件分岐
Geminiの判断結果に基づいて次のアクションを分岐。優先度別に対応を変える。

### 04. 変数の活用
前のステップの出力を変数として次のステップで使用。動的なメッセージ作成。

### よく使う変数
- `{gemini_response}` - Geminiの出力
- `{sender_email}` - メール送信者
- `{file_name}` - ファイル名
- `{form_response}` - フォーム回答内容

---

## 他のエージェントツールとの違い

### Workspace内で完結する安心感
Google Workspace Studioの最大の特徴は、**すべてがGoogle Workspaceの中で完結する**ことです。これは他のエージェントツールにはない大きなメリットです。

### 01. APIキー管理が不要
従来のAIエージェントツールでは、OpenAI APIキーやGoogle Cloud APIキーの取得・管理が必要でした。Workspace Studioでは一切不要です。

### 02. 認証情報の漏洩リスクなし
APIキーをコードに埋め込んだり、環境変数で管理する必要がないため、認証情報の漏洩リスクがありません。

### 03. データがGoogle内に留まる
処理対象のデータはGoogleのインフラ内で処理されます。サードパーティサービスにデータを送信する必要がありません。

### 04. 課金・コスト管理が簡単
API使用量の計算や従量課金の心配がありません。対応エディションであれば追加コストなしで利用可能です。

### 05. 管理者による一元管理
組織のIT管理者がGoogle管理コンソールから一元的に制御できます。シャドーITのリスクを軽減。

### 06. エンタープライズグレードのセキュリティ
Google Workspaceのセキュリティ基盤（監査ログ、DLP、アクセス制御）がそのまま適用されます。

### 他のツールとの比較

ZapierやMake、n8nなどの自動化ツールでAIエージェントを構築する場合：
- **APIキーの取得**が必要（OpenAI、Claude、Gemini APIなど）
- **従量課金**の管理が必要（予期せぬ高額請求のリスク）
- **認証情報の管理**が必要（安全な保管、定期的なローテーション）
- **データの外部送信**が発生（コンプライアンス上の懸念）

Workspace Studioなら、これらの心配事をすべてスキップして、**すぐにAIエージェントの構築に集中**できます。

---

## Apps Scriptとの組み合わせ

### 重要な注意点
Workspace StudioとApps Scriptは別々のツールです。Workspace Studio内にApps Scriptを直接組み込む機能はありません。ただし、それぞれを別々に作成し、組み合わせて活用することは可能です。

### 01. 役割分担で活用
Workspace StudioでAI処理を行い、Apps Scriptで複雑なデータ加工やAPI連携を担当する、という役割分担が可能。

### 02. Sheetsを中継点に
Workspace StudioがSheetsに書き込み → Apps ScriptがonEdit()トリガーで後続処理を実行、という連携パターン。

### 03. それぞれの強みを活かす
AI判断・要約はWorkspace Studio、外部API連携・複雑なロジックはApps Script、という使い分け。

### Apps Script側の例：Workspace StudioがSheetsに書き込んだ後に実行

```javascript
// Apps Script側の例：Workspace StudioがSheetsに書き込んだ後に実行
function onEdit(e) {
  const sheet = e.source.getActiveSheet();
  if (sheet.getName() === 'AIOutput') {
    // Workspace Studioが書き込んだデータを取得
    const aiResult = e.range.getValue();
    // 外部APIに送信するなどの後続処理
    sendToExternalSystem(aiResult);
  }
}
```

### 組み合わせ活用のポイント
- **シンプルに保つ**：可能な限りWorkspace Studio単体で完結させる
- **明確な責任分担**：どの処理をどちらが担当するか明確に
- **中間データの設計**：SheetsやDriveを中継点として活用
- **エラー時の考慮**：片方が失敗した場合のリカバリー方法を検討

---

## セキュリティとアクセス制御

### 01. アクセス制御
エージェントは作成したユーザーの権限で動作します。共有時は、共有相手がアクセスすべきデータのみを扱うエージェントに限定しましょう。

### 02. データの取り扱い
Geminiを使用すると処理対象のデータがGeminiに送信されます。外部サービス連携時はデータが外部に送信されます。組織のセキュリティポリシーを確認してください。

### 03. 利用条件と年齢制限
Workspace Studioは、Business Starter/Standard/Plus、Enterprise Standard/Plus、Education Fundamentals/Standard/Plus エディション、またはGoogle AI Ultra for Business / Google AI Pro for Educationアドオンが必要です。**18歳未満のユーザーはAI機能を使用できません。**

### 04. 管理者の制御
管理者はGoogle管理コンソール > 生成AI > Gemini for Workspace から、Studioの有効化/無効化、OU/グループ単位でのアクセス制御、外部連携の許可/制限、監査ログの確認が可能です。

[公式ドキュメント: Workspace Studioの管理](https://support.google.com/a/answer/16703803?hl=ja)

### セキュリティベストプラクティス
- **最小権限の原則**：必要最小限のデータのみを扱う
- **機密データの除外**：個人情報や機密情報は自動化の対象から除外
- **定期的な監査**：エージェントの動作を定期的に確認
- **チーム内レビュー**：重要なエージェントは複数人でレビュー

---

## よくあるトラブルと対処法

### トラブル1：エージェントが動作しない
- **原因**：スターターの設定ミス、権限不足、サービス側の一時的な問題
- **対処法**：スターターの条件を確認 → テスト実行で動作確認 → 管理者に権限を確認 → しばらく待ってから再試行

### トラブル2：Geminiの出力が期待と異なる
- **原因**：プロンプトが曖昧、入力データが複雑すぎる、言語設定の問題
- **対処法**：プロンプトをより具体的に記述 → 出力形式を明確に指定 → 「日本語で回答して」を追加 → 入力データを事前に整理

### トラブル3：Chat通知が届かない
- **原因**：Google Chatが無効化されている、DM通知の権限がない
- **対処法**：Google Chatアプリを確認 → 管理者にChatの設定を確認（※Chatスペースへの投稿機能は正式リリースで削除されました）

### トラブル4：外部連携エラー
- **原因**：API認証の問題、サービス側の制限、ネットワークの問題
- **対処法**：連携を再認証 → サービスの状態を確認 → 管理者に問い合わせ

---

## 導入時のベストプラクティス

### 01. 最初から作り込まない - スモールスタートが成功の鍵

新しいツールを使い始めると、つい「あれもこれも」と機能を盛り込みたくなります。しかし、最初から複雑なエージェントを作ろうとすると、うまく動かないときに原因特定が難しくなり、結局挫折してしまいがちです。

#### 1エージェント1目的
「メール要約して、分類して、返信も作成」ではなく、まずは「メール要約」だけ。うまくいったら次の機能を追加。

#### テンプレートをそのまま使う
最初はテンプレートをカスタマイズせずにそのまま使う。動作を理解してから少しずつ自分の業務に合わせて調整。

#### 完璧を求めない
80%の精度で十分。Geminiの出力が完璧でなくても、手作業より速ければ価値がある。運用しながら改善。

### よくある失敗パターン
- **最初から複雑な条件分岐**：まずは単純なフローで動かしてから分岐を追加
- **プロンプトの過度な最適化**：シンプルな指示から始めて、必要に応じて詳細化
- **複数サービスの同時連携**：まずは1つのサービス（例：Gmailだけ）で試す

---

### 02. 作ったものはチームでシェアしよう

せっかくエージェントを作れるようになっても、一人で抱え込んでしまうと「自分だけ業務が増える」という本末転倒な状態になりかねません。作ったエージェントは積極的にチームで共有し、みんなで効率化の恩恵を受けましょう。

#### 共有することのメリット
- **チーム全体の生産性向上**：一人が作ったエージェントで、チーム全員が時間を節約できる
- **知見の蓄積**：「こういう使い方ができる」という発見がチーム内で共有される
- **改善のスピードアップ**：複数人の目で見ることで、より良いプロンプトや設定が見つかる
- **属人化の防止**：作った人が異動・退職しても、エージェントは残り続ける

#### 共有機能を活用
Workspace Studioの共有機能で、エージェントをチームメンバーに配布。Googleドライブと同じ感覚で共有可能。

#### 使い方も一緒に共有
「このエージェント便利だよ」だけでなく、どんな場面で使うと効果的か、注意点は何かも伝える。

#### フィードバックを歓迎
「ここがうまくいかない」「こう改善したらどう？」という声を集めて、エージェントを育てていく。

### シェア文化を育てるヒント
- **定期的な共有会**：月1回「今月作ったエージェント発表会」のような場を設ける
- **エージェントカタログ**：チーム内で使えるエージェントの一覧をSheetsやドキュメントでまとめる
- **成功事例の見える化**：「このエージェントで月○時間削減できた」を数字で共有
- **初心者へのサポート**：詳しい人が初めての人をサポートする文化を作る

---

### 03. 導入の推奨ステップ

| Step | アクション | 内容 |
|------|----------|------|
| 1 | 小さく始める | シンプルなエージェントから |
| 2 | 効果を測定 | 時間削減を数値化 |
| 3 | チームに展開 | 共有機能で配布 |
| 4 | 継続的に改善 | フィードバックを反映 |

### 具体的なステップ
- **Step 1**：まずは自分だけで使うエージェントから開始（テンプレートそのまま）
- **Step 2**：1週間ほど運用して、作業時間の削減や対応スピードの向上を確認
- **Step 3**：効果が確認できたら、チームメンバーに共有して使ってもらう
- **Step 4**：使用者からのフィードバックを元に、プロンプトや設定を調整
- **Step 5**：うまくいったら、別の業務でも同じアプローチで展開

---

## 講座全体の振り返り

### 第1回：Google Workspace Studioとは
Gemini 3搭載のAIエージェント作成プラットフォーム。プログラミング不要で自然言語で構築。

### 第2回：登録と基本操作
studio.workspace.google.comにアクセス。テンプレートからエージェントを作成し、テスト実行で動作確認。

### 第3回：機能と活用事例
スターター、Geminiステップ、サードパーティ連携。フォーム通知、ファイル要約、会議準備、サポートトリアージの事例。

### 第4回：カスタマイズと注意点
テンプレートのカスタマイズ、Workspace内完結のメリット、Apps Scriptとの組み合わせ、セキュリティ考慮事項。

---

## 次のアクション

| Step | アクション | 内容 |
|------|----------|------|
| 1 | 業務を1つ選ぶ | 自動化できそうな作業を特定 |
| 2 | エージェント作成 | テンプレートを使って構築 |
| 3 | 1週間運用 | 効果を測定して検証 |
| 4 | チームに共有 | 共有機能で展開 |

---

**講座を受講いただきありがとうございました！**

Google Workspace Studioを活用して、業務を効率化されることを願っています。
