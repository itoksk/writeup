# Lesson 5 事前準備ガイド

承認依頼エージェントと承認監視エージェントをテストするための事前準備手順です。

---

## 1. スプレッドシートの作成

Google スプレッドシートで「**承認管理シート**」という名前のファイルを新規作成してください。

---

## 2. 承認者マスタシートの作成

### シート名
`承認者マスタ`

### 列構成

| 列 | 列名 | 説明 |
|---|---|---|
| A | 申請者名 | 申請を行う社員の名前 |
| B | 部署 | 申請者が所属する部署 |
| C | 直属上長 | 申請者の直属上長の名前 |
| D | 直属上長メール | 直属上長のメールアドレス |
| E | 部門長 | 申請者が所属する部門の長の名前 |
| F | 部門長メール | 部門長のメールアドレス |

### サンプルデータ

以下のデータをコピーしてスプレッドシートに貼り付けてください。

```
申請者名	部署	直属上長	直属上長メール	部門長	部門長メール
山田太郎	営業部	佐藤課長	sato-kacho@example.com	田中部長	tanaka-bucho@example.com
佐藤花子	マーケティング部	鈴木課長	suzuki-kacho@example.com	田中部長	tanaka-bucho@example.com
鈴木一郎	営業部	佐藤課長	sato-kacho@example.com	田中部長	tanaka-bucho@example.com
田中美咲	情報システム部	高橋課長	takahashi-kacho@example.com	伊藤部長	ito-bucho@example.com
高橋健二	開発部	渡辺課長	watanabe-kacho@example.com	伊藤部長	ito-bucho@example.com
渡辺理恵	カスタマーサポート部	小林課長	kobayashi-kacho@example.com	山本部長	yamamoto-bucho@example.com
```

### 完成イメージ

| 申請者名 | 部署 | 直属上長 | 直属上長メール | 部門長 | 部門長メール |
|---|---|---|---|---|---|
| 山田太郎 | 営業部 | 佐藤課長 | sato-kacho@example.com | 田中部長 | tanaka-bucho@example.com |
| 佐藤花子 | マーケティング部 | 鈴木課長 | suzuki-kacho@example.com | 田中部長 | tanaka-bucho@example.com |
| 鈴木一郎 | 営業部 | 佐藤課長 | sato-kacho@example.com | 田中部長 | tanaka-bucho@example.com |
| 田中美咲 | 情報システム部 | 高橋課長 | takahashi-kacho@example.com | 伊藤部長 | ito-bucho@example.com |
| 高橋健二 | 開発部 | 渡辺課長 | watanabe-kacho@example.com | 伊藤部長 | ito-bucho@example.com |
| 渡辺理恵 | カスタマーサポート部 | 小林課長 | kobayashi-kacho@example.com | 山本部長 | yamamoto-bucho@example.com |

---

## 3. 承認待ちリストシートの作成

### シート名
`承認待ちリスト`

### 列構成

| 列 | 列名 | 説明 |
|---|---|---|
| A | 申請日時 | 申請が届いた日時 |
| B | 申請者 | 申請者の名前 |
| C | 種類 | 経費申請 / 稟議 / 休暇申請 / その他 |
| D | 金額 | 申請金額（該当なしの場合は空欄） |
| E | 承認者 | 決定された承認者の名前 |
| F | ステータス | 承認待ち / 承認済 / 差し戻し / 却下 |
| G | リマインド期限 | リマインドを送る期限（日時） |
| H | エスカレーション期限 | エスカレーションを送る期限（日時） |

### ヘッダー行のみ作成

最初はヘッダー行のみ作成し、データは空にしておきます。エージェントが自動で行を追加します。

```
申請日時	申請者	種類	金額	承認者	ステータス	リマインド期限	エスカレーション期限
```

---

## 4. 承認監視エージェントのテスト用データ

承認監視エージェントをテストする場合は、以下のサンプルデータを「承認待ちリスト」シートに手動で追加してください。

### テスト用サンプルデータ

```
申請日時	申請者	種類	金額	承認者	ステータス	リマインド期限	エスカレーション期限
2024/01/13 10:00	山田太郎	経費申請	30080	佐藤課長	承認待ち	2024/01/15 10:00	2024/01/16 10:00
2024/01/12 14:00	田中美咲	稟議	12100000	伊藤部長	承認待ち	2024/01/13 14:00	2024/01/14 14:00
2024/01/15 09:00	高橋健二	休暇申請		渡辺課長	承認待ち	2024/01/16 09:00	2024/01/17 09:00
```

### 期待される判定結果

テスト実行日が2024/01/15の場合：

| 申請者 | 種類 | 状態 |
|---|---|---|
| 山田太郎 | 経費申請 | リマインド対象（48時間以上経過） |
| 田中美咲 | 稟議 | エスカレーション対象（72時間以上経過） |
| 高橋健二 | 休暇申請 | 期限内（まだ対応不要） |

---

## 5. 経営層マスタ（オプション）

50万円以上の稟議で2段階承認が必要な場合、経営層の情報も管理できます。

### シート名（オプション）
`経営層マスタ`

| 役職 | 氏名 | メールアドレス |
|---|---|---|
| 代表取締役 | 社長太郎 | ceo@example.com |
| 取締役CFO | 財務花子 | cfo@example.com |
| 取締役CTO | 技術一郎 | cto@example.com |

---

## 6. 完成後のスプレッドシート構成

```
承認管理シート（スプレッドシートファイル）
├── 承認者マスタ（シート1）
│   └── 申請者と承認者の紐付け
├── 承認待ちリスト（シート2）
│   └── 処理中の申請一覧
└── 経営層マスタ（シート3・オプション）
    └── 高額稟議の承認者
```

---

## 7. テスト前チェックリスト

- [ ] スプレッドシート「承認管理シート」を作成した
- [ ] 「承認者マスタ」シートを作成し、サンプルデータを入力した
- [ ] 「承認待ちリスト」シートを作成し、ヘッダー行を入力した
- [ ] テスト用メールの申請者名（山田太郎など）が承認者マスタに登録されている
- [ ] エージェント作成時に正しいスプレッドシートを選択した

---

## 8. 注意事項

### メールアドレスについて
- サンプルでは `@example.com` を使用していますが、実際のテストでは自分や同僚のメールアドレスに変更してください
- 外部送信は未対応のため、承認者へは手動で転送します

### 申請者名の一致について
- テストメールの「申請者」欄の名前と、承認者マスタの「申請者名」列が一致している必要があります
- 一致しない場合、Geminiが承認者を特定できません

### 日付形式について
- 申請日時、リマインド期限、エスカレーション期限は `YYYY/MM/DD HH:MM` 形式で入力してください
- 例: `2024/01/15 10:00`
