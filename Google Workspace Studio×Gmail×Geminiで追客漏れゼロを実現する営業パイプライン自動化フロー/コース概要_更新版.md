# Google Workspace Studio × Gmail × Geminiで "追客漏れゼロ" を実現する営業パイプライン自動化フロー

## コース概要
Google Workspace Studioの正式リリースに対応した、営業メール業務を自動化するコースです。5つのレッスンで、見込み顧客メールの自動要約、追客漏れ防止、営業資料の自動整理、確度高い案件の優先アラートを実現します。

## 対象者
- 毎日50-100件のメールに追われている営業担当者
- メール確認に1時間以上かけている方
- 追客漏れによる失注を防ぎたい方
- 営業資料の整理に時間がかかっている方

## 正式リリース版の用語（重要）
- **スターター (Starter)**: エージェントを起動するトリガー
  - スケジュールスターター: 定期実行
  - Gmail - Email received: メール受信時
  - Forms - Form submitted: フォーム送信時
- **ステップ (Step)**: エージェントが実行するアクション
  - Geminiステップ: AI処理
  - Gmailステップ: メール操作
  - Sheetsステップ: スプレッドシート操作
  - Driveステップ: ファイル操作
  - Chat DMステップ: 個人DM通知
  - 条件分岐ステップ: 条件による処理分岐
- **エージェント (Agent)**: スターターとステップで構成された自動化フロー

## Chat通知に関する重要な変更
**正式リリースでの変更点:**
- Chatスペースへの投稿機能は削除されました
- Chat通知は個人へのDM（ダイレクトメッセージ）のみ利用可能です
- チーム共有が必要な場合は、Gmailでのメール送信または Sheets への記録をご利用ください

## カリキュラム（全5回）

### 第1回：案件メール地獄から脱出する
**Google Workspace Studioで営業メール仕事を分解する**
- 営業メール業務の課題を整理
- 5つのエージェントによる自動化の全体像を理解
- 事前準備と利用条件の確認

### 第2回：見込み顧客メールを10分で把握
**要約・重要顧客優先・緊急案件アラートの自動化**
- **スターター**: スケジュールスターター（毎朝9時）
- **ステップ**: Gmailステップ（検索）→ Geminiステップ（要約・分類）→ Chat DMステップ（通知）
- 毎朝、見込み顧客メールをGeminiが自動要約
- 重要顧客を優先表示、緊急案件はDMでアラート通知

### 第3回：追客漏れゼロの受信トレイ
**要対応案件メールの自動ラベル化＆次アクション設計**
- **スターター**: Gmail - Email received（メール受信時）
- **ステップ**: Geminiステップ（判定）→ 条件分岐ステップ → Gmailステップ（ラベル付与）→ Chat DMステップ（通知）
- メール受信時に要対応を自動判定
- 「要対応」ラベル付与、Geminiが次のアクションを提案

### 第4回：提案資料と見積書を完全自動整理
**Drive保存 × 定期送信フローで営業資料を整流化**
- **フロー1**: 添付ファイル自動保存エージェント
  - **スターター**: Gmail - Email received（has:attachment）
  - **ステップ**: Geminiステップ（分類）→ Driveステップ（保存）→ Chat DMステップ（通知）
- **フロー2**: 週次資料レポートエージェント
  - **スターター**: スケジュールスターター（毎週月曜9時）
  - **ステップ**: Driveステップ（一覧取得）→ Geminiステップ（レポート作成）→ Chat DMステップ（送信）
- 提案資料・見積書を案件フォルダに自動保存
- 週次で資料一覧レポートを自動送信

### 第5回：キーワード監視で確度高い案件を逃さない
**"使える営業フロー"に仕上げる最終調整**
- **スターター**: Gmail - Email received（キーワードフィルター）
- **ステップ**: Geminiステップ（確度判定）→ 条件分岐ステップ → Gmailステップ（ラベル付与）→ Chat DMステップ（優先アラート）
- 営業キーワード（契約/発注/見積もり等）を監視
- 確度高い案件を優先アラート
- 複数エージェントを統合して運用

## 作成するエージェント一覧
1. **見込み顧客メール要約エージェント** - スケジュールスターター → 毎朝要約通知
2. **追客漏れゼロエージェント** - Gmailスターター → ラベル付与＋次アクション
3. **営業資料自動整理エージェント** - Gmailスターター → Drive保存
4. **週次資料レポートエージェント** - スケジュールスターター → 週次レポート
5. **確度高案件監視エージェント** - Gmailスターター → 優先アラート

## 達成できる効果
- メール確認時間: 1時間/日 → 12分/日（80%削減）
- 追客漏れ: 月1-2件 → 0件
- 資料探索時間: 30分/回 → 即座（95%削減）
- 年間削減時間: 約250時間

## カスタムステップについて

### 基本方針
Workspace Studioはノーコードツールとしての価値が高いため、**まずは標準ステップでの実装を推奨**します。
カスタムステップは、標準ステップでは対応できない処理が必要な場合のみ検討してください。

### カスタムステップが必要なケース
- 外部APIとの連携（CRM、SFA等）
- 複雑な計算処理
- 独自のデータ変換ロジック
- 標準ステップにない特殊な処理

### カスタムステップの作成方法
Apps Scriptでカスタムステップを作成します。以下は公式ドキュメントの計算機サンプルです。

#### appsscript.json（マニフェストファイル）
```json
{
  "timeZone": "America/Los_Angeles",
  "exceptionLogging": "STACKDRIVER",
  "runtimeVersion": "V8",
  "addOns": {
    "common": {
      "name": "Calculator",
      "logoUrl": "https://www.gstatic.com/images/branding/productlogos/calculator_search/v1/web-24dp/logo_calculator_search_color_1x_web_24dp.png",
      "useLocaleFromApp": true
    },
    "flows": {
      "workflowElements": [
        {
          "id": "actionElement",
          "state": "ACTIVE",
          "name": "Calculate",
          "description": "Asks the user for two values and a math operation, then performs the math operation on the values and outputs the result.",
          "workflowAction": {
            "inputs": [
              {
                "id": "value1",
                "description": "value1",
                "cardinality": "SINGLE",
                "dataType": { "basicType": "INTEGER" }
              },
              {
                "id": "value2",
                "description": "value2",
                "cardinality": "SINGLE",
                "dataType": { "basicType": "INTEGER" }
              },
              {
                "id": "operation",
                "description": "operation",
                "cardinality": "SINGLE",
                "dataType": { "basicType": "STRING" }
              }
            ],
            "outputs": [
              {
                "id": "result",
                "description": "Calculated result",
                "cardinality": "SINGLE",
                "dataType": { "basicType": "INTEGER" }
              }
            ],
            "onConfigFunction": "onConfigCalculateFunction",
            "onExecuteFunction": "onExecuteCalculateFunction"
          }
        }
      ]
    }
  }
}
```

#### Calculator.gs（実行コード）
```javascript
// 設定画面のUIを生成
function onConfigCalculateFunction() {
  var card = {
    "sections": [
      {
        "header": "Action sample: Calculate",
        "widgets": [
          {
            "textInput": {
              "name": "value1",
              "label": "First value",
              "hostAppDataSource": {
                "workflowDataSource": { "includeVariables": true }
              }
            }
          },
          {
            "selectionInput": {
              "name": "operation",
              "label": "Operation",
              "type": "DROPDOWN",
              "items": [
                { "text": "+", "value": "+" },
                { "text": "-", "value": "-" },
                { "text": "x", "value": "x" },
                { "text": "/", "value": "/" }
              ]
            }
          },
          {
            "textInput": {
              "name": "value2",
              "label": "Second value",
              "hostAppDataSource": {
                "workflowDataSource": { "includeVariables": true }
              }
            }
          }
        ]
      }
    ]
  };
  return pushCard(card);
}

// ステップ実行時の処理
function onExecuteCalculateFunction(event) {
  var value1 = event.workflow.actionInvocation.inputs["value1"].integerValues[0];
  var value2 = event.workflow.actionInvocation.inputs["value2"].integerValues[0];
  var operation = event.workflow.actionInvocation.inputs["operation"].stringValues[0];
  var calculatedValue = 0;

  if (operation == "+") calculatedValue = value1 + value2;
  else if (operation == "-") calculatedValue = value1 - value2;
  else if (operation == "x") calculatedValue = value1 * value2;
  else if (operation == "/") calculatedValue = value1 / value2;

  const variableDataMap = {
    "result": AddOnsResponseService.newVariableData().addIntegerValue(calculatedValue)
  };
  return outputVariables(variableDataMap);
}
```

### 重要な注意事項
- カスタムステップはApps Scriptの知識が必要です
- デプロイとバージョン管理が必要になります
- まずは標準ステップで実現可能か十分に検討してください
- ノーコードの利点を活かすため、カスタムステップは最小限に

詳細ドキュメント: https://developers.google.com/workspace/add-ons/studio/quickstart-calculator?hl=ja

## 必要条件
- Google Workspace（Business Starter/Standard/Plus、Enterprise Standard/Plus）アカウント
- またはGoogle AI Ultra for Businessアドオン
- 管理コンソールでGemini for Workspaceが有効化されていること
- 18歳以上のユーザー

## アクセス
studio.workspace.google.com
