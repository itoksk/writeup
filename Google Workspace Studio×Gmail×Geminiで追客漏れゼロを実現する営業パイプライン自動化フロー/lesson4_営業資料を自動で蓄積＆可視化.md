# 第4回：提案資料と見積書を完全自動整理！
## Drive保存 × 定期送信フローで営業資料を整流化

---

## この回の目標

2つの独立したエージェントを作成し、提案資料・見積書の管理と営業活動の可視化を実現します。

---

## Before / After

### BEFORE：受講前
- 提案書・見積書がメールに埋もれる
- 「あの見積書どこ？」と探す時間
- 今週何をやったか振り返れない
- 営業活動が見えない

### AFTER：受講後
- 提案書・見積書が自動でDriveに整理
- 週次レポートで活動を振り返り
- どの顧客と活発にやり取りしているか一目瞭然

---

## 今回やること

| 作業 | 内容 |
|------|------|
| 作業1 | 提案資料・見積書の自動保存エージェントの作成 |
| 作業2 | 週次レポート定期送信エージェントの作成 |

> **ポイント**
> この2つのエージェントは**独立して動作**します。それぞれ単体で使えるので、片方だけ作成しても構いません。

---

## 作業1：提案資料・見積書の自動保存エージェント

重要顧客からの提案書・見積書などの営業資料を自動でGoogle Driveに保存し、通知を送ります。

### 事前準備

Google Driveに**「営業資料」**フォルダを作成してください。提案書・見積書はこのフォルダに保存されます。

### フロー

```
Gmailスターター（重要顧客 + has:attachment）
    ↓
Driveステップ（保存）
    ↓
Chat DMステップ（通知）
```

### 作成手順

| Step | 内容 | 詳細 |
|------|------|------|
| 01 | Gmailスターター設定 | Gmail - Email received / フィルター設定 |
| 02 | Driveステップ（保存） | Drive - Upload file / 提案書・見積書をDriveに保存 |
| 03 | Chat DMステップ（通知） | Chat - Direct message / 保存完了を通知 |

---

### Step 1: Gmailスターター設定

重要顧客から添付ファイル付きメールを受信したときに起動します。

**フィルター条件：**

```
(from:yamada@a-corp.co.jp OR from:tanaka@b-inc.com) has:attachment
```

> **設定のコツ**
> - `has:attachment` で添付ファイル付きメールのみ対象
> - 重要顧客のメールアドレスを `from:` で指定
> - 複数の送信者は `OR` で連結

---

### Step 2: Driveステップ（ファイル保存）

| 項目 | 設定 |
|------|------|
| ステップ | Drive - Upload file |
| 保存先 | 「営業資料」フォルダを選択 |
| ファイル | {attachment}（メールの添付ファイル） |

---

### Step 3: Chat DMステップ（通知）

保存完了を自分にDMで通知します。

**メッセージ：**

```
📁 営業資料を保存しました

【送信者】{sender_name} ({sender_email})
【件名】{email_subject}
【ファイル名】{attachment_name}
【保存先】営業資料フォルダ

📧 メールを確認: {email_link}
```

---

## 作業2：週次レポート定期送信エージェント

スプレッドシートのデータを読み込み、Geminiで分析して週次レポートを定期送信します。

### 事前準備

Google Sheetsで**「営業資料ログ」**スプレッドシートを作成し、営業活動データを入力しておいてください。

**スプレッドシートの形式例：**

| 日付 | 送信者名 | 送信者メール | 件名 | ファイル名 | ファイル種類 | 案件ステージ | 緊急度 |
|------|----------|--------------|------|------------|--------------|--------------|--------|
| 2025-01-06 | 山田太郎 | yamada@a-corp.co.jp | 提案書送付 | 提案書_v1.pdf | 提案書 | 提案中 | MEDIUM |
| 2025-01-07 | 鈴木花子 | suzuki@b-inc.com | 見積書の件 | 見積書.pdf | 見積書 | 見積もり | HIGH |

> **データ入力について**
> このスプレッドシートは手動で入力するか、他のツール（Zapierなど）で自動入力してください。
> より高度な自動入力設定は[応用編：スプレッドシート連携](advanced_スプレッドシート連携で営業ログを自動記録.md)を参照してください。

### フロー

```
スケジュールスターター（毎週月曜9時）
    ↓
Sheetsステップ（データ読み込み）
    ↓
Geminiステップ（分析）
    ↓
Chat DMステップ（レポート定期送信）
```

### 作成手順

| Step | 内容 | 詳細 |
|------|------|------|
| 01 | スケジュールスターター設定 | Scheduled / 毎週月曜 9:00 AM |
| 02 | Sheetsステップ（読み込み） | Sheets - Read spreadsheet / データ取得 |
| 03 | Geminiステップ（分析） | ログデータを分析してサマリー生成 |
| 04 | Chat DMステップ（定期送信） | 週次レポートを定期送信 |

---

### Step 1: スケジュールスターター設定

| 項目 | 設定 |
|------|------|
| スターター | Scheduled |
| 頻度 | Weekly |
| 曜日 | Monday |
| 時刻 | 9:00 AM |
| タイムゾーン | Asia/Tokyo |

---

### Step 2: Sheetsステップ（データ読み込み）

| 項目 | 設定 |
|------|------|
| ステップ | Sheets - Read spreadsheet |
| スプレッドシート | 「営業資料ログ」を選択 |
| 範囲 | 全データ（デフォルト） |

出力は `sheets_data` に保存されます。

---

### Step 3: Geminiステップ（分析）

**プロンプト：**

```
以下は今週の営業資料ログデータです。
このデータを分析して、提案書・見積書の整理状況レポートを作成してください。

ログデータ:
{sheets_data}

以下の形式で出力してください：

📊 今週の営業資料レポート

【今週の概要】
- 保存された資料数と主な種類（提案書、見積書など）を要約

【活発な商談】
- 送信者名/会社ごとに資料数を集計
- 複数の資料がある顧客は特に注目

【資料の種類別集計】
- 提案書: X件
- 見積書: X件
- 契約書: X件
- その他: X件

【案件ステージ別状況】
- 問い合わせ: X件
- 提案中: X件
- 見積もり: X件
- 契約交渉: X件

【注目ポイント】
- 緊急度HIGHの案件をリストアップ
- 契約書や見積書がある場合は、商談が進んでいる可能性を指摘
- 今週フォローすべき顧客を提案

データがない場合は「今週は新規データはありません」と出力してください。
```

出力は `weekly_report` に保存します。

---

### Step 4: Chat DMステップ（レポート定期送信）

**メッセージ：**

```
{weekly_report}

---
📋 詳細は「営業資料ログ」スプレッドシートで確認できます
```

---

## 週次レポートの出力例

```
📊 今週の営業資料レポート

【今週の概要】
今週は10件の資料が保存されました。
提案書3件、見積書3件、契約書2件、その他2件と、複数の商談が活発に動いています。

【活発な商談】
- 山田太郎（A社）：2件（提案書×2）→ 提案書を改訂中
- 鈴木花子（B社）：2件（見積書、発注書）→ 発注段階に進行！
- 佐藤一郎（D社）：1件（契約書）→ 契約交渉中

【資料の種類別集計】
- 提案書: 3件
- 見積書: 3件
- 契約書: 2件
- その他: 2件

【案件ステージ別状況】
- 問い合わせ: 2件
- 提案中: 3件
- 見積もり: 3件
- 契約交渉: 2件

【注目ポイント】
⭐ B社は発注書が届いています！最優先で対応してください。
⭐ D社は契約交渉中。契約締結に向けた最終確認を進めましょう。
⭐ A社は提案書を複数回改訂中。顧客の要望を確認してください。
```

---

## Before / After 比較表

| 項目 | Before | After |
|------|--------|-------|
| 提案書・見積書の保存 | 手動でダウンロード・アップロード | 自動でDriveに整理 |
| 資料の検索 | メールを探し回る | Driveで即座に検索 |
| 営業活動の把握 | 何をやったか分からない | 週次レポートで可視化 |
| フォローすべき顧客 | 自分で判断 | Geminiが提案 |

---

## 運用のコツ

### 提案資料・見積書の自動保存

- フォルダが整理しやすいよう、顧客別サブフォルダを作成しても良い
- 大量のファイルが溜まったら、定期的に整理

### 週次レポート定期送信

- スプレッドシートのデータは定期的に更新
- レポートは週明けのタスク整理に活用
- 「注目ポイント」を参考にフォロー優先順位を決定

### より高度な連携

提案書・見積書の保存時に自動でスプレッドシートにログを記録したい場合は、[応用編：スプレッドシート連携で営業ログを自動記録](advanced_スプレッドシート連携で営業ログを自動記録.md)を参照してください。

---

## 次回予告（最終回）

### 第5回：キーワード監視で確度高い案件を逃さない！
**"使える営業フロー"に仕上げる最終調整**

最終回は、営業キーワード（契約/発注/検討など）を監視して確度高い案件を優先アラートします。
また、これまで作成したエージェントを統合し、実際に"使える営業フロー"として運用開始する方法を学びます。
