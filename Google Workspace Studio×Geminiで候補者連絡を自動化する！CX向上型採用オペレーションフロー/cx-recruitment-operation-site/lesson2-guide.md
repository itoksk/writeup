# 第2回：面接前準備を自動化！カレンダー × Gemini × Chatで候補者へ必要情報を自動送信する

## 学習目標

面接予定をCalendarから検知し、Geminiで候補者情報を要約、面接官へChat通知するエージェントを作成する

---

## 自動生成プロンプト

以下のプロンプトをWorkspace Studioの「Create agent」画面で入力すると、エージェントが自動生成されます。

```
面接予定をCalendarから検知し、Geminiで候補者情報を要約、面接官へChat通知するエージェントを作成する
```

---

## エージェントのフロー

| ステップ | 内容 | 詳細 |
|---------|------|------|
| S | スターター：会議に基づいて | Calendarの会議（面接）の前に自動でフローを開始 |
| 1 | アクション：会議情報を取得 | イベントタイトル、開始時刻、参加者リスト、説明文を取得 |
| 2 | 決める：面接かどうかを判定 | タイトルに「面接」「Interview」「選考」を含むか判定 |
| 3 | 条件確認 | TRUE→次へ進む、FALSE→フロー終了 |
| 4 | Geminiに聞く | 候補者情報を要約 |
| 5 | チャットで通知する | 自分へのDMで面接準備情報を配信 |

---

## エージェント設定

| 項目 | 設定値 |
|------|--------|
| エージェント名 | Interview Prep Notification |
| Description | Sends interview preparation summary to interviewers before meetings |
| スターター | 会議に基づいて（会議の10分前に開始） |
| 時間オフセット | 10分（単位：分） |
| 対象ミーティング | 全てのミーティング（または特定のミーティングを選択可） |
| 条件分岐 | タイトルに「面接」「Interview」「選考」を含む場合のみ実行 |
| Chat送信先 | 自分へのDM |
| 出力言語 | Japanese |

---

## プロンプト：Gemini（候補者情報要約）

```
あなたは面接準備を担当するHRアシスタントです。

候補者名: {candidate_name}
応募ポジション: {position}
履歴書の内容: {resume_content}

面接官向けに以下の情報を含む簡潔なサマリーを作成してください：
1. 主要なスキル・資格（3つのポイント）
2. 関連する経験のハイライト
3. 面接で確認すべきポイント
4. 特筆すべき点や懸念事項

サマリーは200語以内で簡潔にまとめてください。
```

---

## Chatメッセージテンプレート

```
【面接準備情報】

本日 {interview_time} からの面接情報です。

■ 候補者: {candidate_name}
■ 応募ポジション: {position}

■ 候補者サマリー
{resume_summary}

■ 履歴書リンク
{resume_link}

面接頑張ってください！
```

---

## フォールバックメッセージ（履歴書が見つからない場合）

```
【面接準備情報 - 要確認】

本日 {interview_time} からの面接があります。

■ 候補者: {candidate_name}
■ 応募ポジション: {position}

⚠️ 候補者の履歴書が自動取得できませんでした。
以下のフォルダを手動でご確認ください：
{folder_link}

お手数をおかけしますが、よろしくお願いいたします。
```

---

## Driveファイル検索クエリ

```
title contains '{candidate_name}' and
(title contains '履歴書' or title contains '職務経歴書' or title contains 'Resume' or title contains 'CV')
```

---

## 推奨フォルダ構造

```
採用書類/
├── [候補者名A]_[日付]/
│   ├── 履歴書_[候補者名].pdf
│   └── 職務経歴書_[候補者名].pdf
├── [候補者名B]_[日付]/
│   └── 履歴書_[候補者名].pdf
└── [候補者名C]_[日付]/
    └── ...
```

---

## Calendar命名規則

イベントタイトル: **「面接：[候補者名]（[ポジション]）」**

例: 「面接：山田太郎（エンジニア）」

この形式により、候補者名とポジション情報を自動抽出できます。

---

## 「決める」ステップの設定

| 条件 | アクション |
|------|----------|
| タイトルに「面接」を含む | TRUE → 次のステップへ |
| タイトルに「Interview」を含む | TRUE → 次のステップへ |
| タイトルに「選考」を含む | TRUE → 次のステップへ |
| 上記以外 | FALSE → フロー終了 |

---

## 変数一覧

| 変数名 | 内容 | 取得元 |
|--------|------|--------|
| {event_title} | イベントタイトル | スターター（会議に基づいて） |
| {event_start} | 開始時刻 | スターター（会議に基づいて） |
| {event_end} | 終了時刻 | スターター（会議に基づいて） |
| {attendees} | 参加者リスト | スターター（会議に基づいて） |
| {description} | イベント説明文 | スターター（会議に基づいて） |
| {is_interview} | 面接かどうか | 「決める」ステップの結果 |
| {candidate_summary} | 候補者サマリー | Gemini生成 |

---

## テスト確認ポイント

- [ ] 「会議に基づいて」スターターが正しく設定されているか
- [ ] 時間オフセットが10分（会議前）に設定されているか
- [ ] 会議情報（タイトル、参加者、説明文）が正しく取得されているか
- [ ] 「決める」ステップで面接かどうか正しく判定されているか
- [ ] 通常の会議（面接以外）ではフローが終了するか
- [ ] Geminiの要約が適切な内容・長さか
- [ ] Chatメッセージが自分のDMに正しく届くか
- [ ] カレンダー変更後、5分以内に同期されるか確認

---

## まとめ

- 「会議に基づいて」スターターで面接前に自動起動
- 時間オフセット10分で面接前に通知を配信
- 「決める」ステップで面接かどうかを自動判定
- 条件分岐で面接のみをフィルタリング
- Geminiで候補者情報を自動要約
- Chat通知で自分のDMに面接情報を配信
- 自然言語プロンプトでフローを自動生成
- **CX向上：面接官の準備時間を10分→0分に短縮**
