Google Workspace StudioÃ— Geminiã§å€™è£œè€…é€£çµ¡ã‚’è‡ªå‹•åŒ–ã™ã‚‹ï¼â€œCXå‘ä¸Šå‹â€ æ¡ç”¨ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼ã€€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚³ãƒ¼ã‚¹ã¯ã€  
å…ƒã€…æ¡ä»¶åˆ†å²ã§â€œç¾å ´ä»•æ§˜â€ã«ã‚«ã‚¹ã‚¿ãƒ ï¼Google Workspace FlowsÃ—Geminiã§ä¼šè­°ãƒ»ä¾é ¼ãƒ»ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•æ•´ç†ã™ã‚‹å®Ÿå‹™æ´»ç”¨ã‚³ãƒ¼ã‚¹.mdãŒåŸæœ¬ã ã£ãŸã‚“ã ã‘ã©ã€

- æ¡ç”¨æ¥­å‹™ã®æ‰‹ä½œæ¥­ãŒæ¶ˆãˆãªã„ç†ç”±ã‚’è¦‹æŠœãï¼å€™è£œè€…é€£çµ¡ãƒ•ãƒ­ãƒ¼ã®å…¨ä½“åƒã‚’ç†è§£ã™ã‚‹  
- é¢æ¥å‰æº–å‚™ã‚’è‡ªå‹•åŒ–ï¼ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ Ã— Gemini Ã— Chatã§å€™è£œè€…ã¸å¿…è¦æƒ…å ±ã‚’è‡ªå‹•é€ä¿¡ã™ã‚‹  
- é¢æ¥å¾Œä½œæ¥­ã‚’ã‚¼ãƒ­ã«ã™ã‚‹ï¼è¦ç´„ï¼†è©•ä¾¡ãƒã‚¤ãƒ³ãƒˆã‚’Gmail/Chatã¸è‡ªå‹•é€ä¿¡ã™ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä½œã‚‹  
- é…å»¶ã—ãªã„æ¡ç”¨é‹ç”¨ï¼é¢æ¥ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ»è©•ä¾¡æå‡ºãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’è‡ªå‹•åŒ–ã™ã‚‹  
- æ¡ç”¨ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Œå…¨è‡ªå‹•åŒ–ï¼é¸è€ƒãƒ•ãƒ­ãƒ¼å…¨ä½“ã‚’Flowã§ä¸€æœ¬åŒ–ã™ã‚‹æ–¹æ³•

ã®ã‚³ãƒ¼ã‚¹åã¨ãªã‚‹ã‚ˆã†ã«ã€

ğŸ”¥ã€æ¡ç”¨ç‰ˆï¼šä¼šè­°ã‚³ãƒ¼ã‚¹ã®ä¸­èº«ã‚’ â€œæ¡ç”¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³â€ ã«å¯„ã›ãŸãƒªãƒ¡ã‚¤ã‚¯ä¾‹ã€‘

â€»æ§‹é€ ã¯ 1mm ã‚‚å¤‰ãˆãšã«ã€è¨€è‘‰ã ã‘æ¡ç”¨å‘ã‘ã«å¤‰æ›´ã—ã¦ã„ã¾ã™  
â€»è¬›å¸«ã«ã‚‚è² æ‹…ã‚¼ãƒ­

ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼  
âœ…ç¬¬1æœ¬  
æ¡ç”¨æ¥­å‹™ã®æ‰‹ä½œæ¥­ãŒæ¶ˆãˆãªã„ç†ç”±ã‚’è¦‹æŠœãï¼å€™è£œè€…é€£çµ¡ãƒ•ãƒ­ãƒ¼ã®å…¨ä½“åƒã‚’ç†è§£ã™ã‚‹

ï¼ˆå…ƒï¼šä¼šè­°é‹å–¶ã®æ‰‹ä½œæ¥­ãŒãªãœæ¶ˆãˆãªã„ã®ã‹ï¼Ÿã®ç½®æ›ï¼‰

ä¼šè­° â†’ æ¡ç”¨ ã«ç½®ãæ›ãˆã‚‹ã ã‘ã§æ–‡è„ˆãŒè‡ªç„¶ã«æˆç«‹ã—ã¾ã™ã€‚

é€£çµ¡æ¼ã‚Œ

æ—¥ç¨‹èª¿æ•´åœ°ç„

è©•ä¾¡å…±æœ‰ã®é…ã‚Œ

ãªã©ã€æ¡ç”¨ã®å®Ÿå‹™èª²é¡Œãã®ã¾ã¾ï¼é•å’Œæ„Ÿãªã—ã€‚

ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼  
âœ…ç¬¬2æœ¬  
é¢æ¥å‰æº–å‚™ã‚’è‡ªå‹•åŒ–ï¼ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ Ã— Gemini Ã— Chatã§å€™è£œè€…ã¸å¿…è¦æƒ…å ±ã‚’è‡ªå‹•é€ä¿¡ã™ã‚‹

ï¼ˆå…ƒï¼šä¼šè­°å‰ä½œæ¥­ã®è‡ªå‹•åŒ–ï¼‰

ï¼ ä¼šè­°å‰ã®è³‡æ–™æº–å‚™ â†’ é¢æ¥å‰ã®æ¡ˆå†…ãƒ»äº‹å‰ä¾é ¼ ã«è»¢æ›ã™ã‚‹ã ã‘ã€‚

è‡ªç„¶ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹é …ç›®ï¼š

é¢æ¥æ¡ˆå†…ãƒ¡ãƒ¼ãƒ«

äº‹å‰èª²é¡Œã®é€ä»˜

é¢æ¥æ‹…å½“è€…ã¸ã®ãƒªãƒã‚¤ãƒ³ãƒ‰

é¢æ¥ãƒ«ãƒ¼ãƒ URLã®è‡ªå‹•é…ä¿¡

æ§‹é€ ã¯å®Œå…¨ä¸€è‡´ â†’ å®Ÿå‹™ã§ã‚‚å¤§ããåˆºã•ã‚‹ã€‚

ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼  
âœ…ç¬¬3æœ¬  
é¢æ¥å¾Œä½œæ¥­ã‚’ã‚¼ãƒ­ã«ã™ã‚‹ï¼è¦ç´„ï¼†è©•ä¾¡ãƒã‚¤ãƒ³ãƒˆã‚’Gmail/Chatã¸è‡ªå‹•é€ä¿¡ã™ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä½œã‚‹

ï¼ˆå…ƒï¼šä¼šè­°å¾Œä½œæ¥­ã‚’ã‚¼ãƒ­ã«ï¼‰

å…ƒã®ä¼šè­°å¾Œè¦ç´„ã‚’  
é¢æ¥ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¦ç´„ ã«è»¢æ›ã™ã‚‹ã ã‘ã€‚

é¢æ¥ã®å†…å®¹

å€™è£œè€…ã®å¼·ã¿ãƒ»æ‡¸å¿µ

æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

åˆå¦åˆ¤æ–­ã«å¿…è¦ãªè¦ç‚¹

ã“ã‚Œã‚‰ã‚’ Gemini ãŒè¦ç´„ â†’ Flow ãŒè‡ªå‹•é€ä¿¡  
ï¼äººäº‹ã®æœ€å¤§ã®è² æ‹…ã‚’å‰Šæ¸›ã§ãã‚‹ã€‚

ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼  
âœ…ç¬¬4æœ¬  
é…å»¶ã—ãªã„æ¡ç”¨é‹ç”¨ï¼é¢æ¥ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ»è©•ä¾¡æå‡ºãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’è‡ªå‹•åŒ–ã™ã‚‹

ï¼ˆå…ƒï¼šé…å»¶ã‚¼ãƒ­ã®ä¼šè­°é‹å–¶ï¼‰

ä¼šè­°ã®ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’  
å€™è£œè€…é€£çµ¡ã‚„è©•ä¾¡æå‡ºãƒªãƒã‚¤ãƒ³ãƒ‰ã«ç½®æ›ã™ã‚‹ã€‚

ä¾‹ï¼š

é¢æ¥å‰æ—¥ã®å€™è£œè€…ãƒªãƒã‚¤ãƒ³ãƒ‰

é¢æ¥æ‹…å½“è€…ã¸ã®ã€Œè©•ä¾¡ç™»éŒ²ã—ã¦ãã ã•ã„ã€é€šçŸ¥

æ¬¡é¢æ¥æ—¥ç¨‹ç¢ºå®šã‚’ä¿ƒã™ãƒ•ã‚©ãƒ­ãƒ¼

â†’ å®Ÿéš›ã«è¶…ä½¿ãˆã‚‹ã‚„ã¤ã€‚

ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼  
âœ…ç¬¬5æœ¬  
æ¡ç”¨ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Œå…¨è‡ªå‹•åŒ–ï¼é¸è€ƒãƒ•ãƒ­ãƒ¼å…¨ä½“ã‚’Flowã§ä¸€æœ¬åŒ–ã™ã‚‹æ–¹æ³•

ï¼ˆå…ƒï¼šå…¨ãƒ•ãƒ­ãƒ¼ã®çµ±åˆï¼‰

ã“ã“ã¯ãã®ã¾ã¾ã§ã‚‚é•å’Œæ„Ÿã‚¼ãƒ­ã€‚  
æ¡ç”¨ã¯ã€Œå·¥ç¨‹ãŒé€£é–ã—ã¦ã„ã‚‹ã€ã®ã§ã€çµ±åˆã™ã‚‹æ„å‘³ãŒå¼·ã„ã€‚

æ›¸é¡é¸è€ƒ â†’ é¢æ¥è¨­å®š â†’ è©•ä¾¡å…±æœ‰ â†’ æ¬¡é¢æ¥ â†’ å†…å®šæ‰‹ç¶šã  
ã‚’ Flow ã§ã¤ãªã’ã‚‹æ¦‚è¦èª¬æ˜ã«ã™ã‚Œã°å®Œç’§ã€‚

ã§æ§‹æˆã—ç›´ã—ã¦ã»ã—ã„ã€‚

ãŸã ã€ã“ã“ã¾ã§ã®è¿½åŠ æƒ…å ±ï¼ˆã‚¹ãƒ†ãƒƒãƒ—ã¨ã‹ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã¨ã‹Geminiã®æ´»ç”¨ã¨ã‹ï¼‰ã¨ã€å…¬å¼æƒ…å ±ã«ã‚ˆã£ã¦å¤‰æ›´ã—ãªã‘ã‚Œã°ã„ã‘ãªã„ã“ã¨ãŒã‚ã‚Œã°ã€æ”¹å–„ã—ã¦ã€ã‚³ãƒ¼ã‚¹ã‚’ä½œã‚Šæ›¿ãˆã¦ã€ãã®æ¦‚è¦ã‚’æ–°ã—ã„mdãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šå‡ºã—ã¦ãã ã•ã„ã€‚  
ãã—ã¦ã€Google Workspace StudioÃ— Geminiã§å€™è£œè€…é€£çµ¡ã‚’è‡ªå‹•åŒ–ã™ã‚‹ï¼â€œCXå‘ä¸Šå‹â€ æ¡ç”¨ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼ã€€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚³ãƒ¼ã‚¹ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚  
ã¾ãŸã€ã‚«ã‚¹ã‚¿ãƒ ã‚¹ãƒ†ãƒƒãƒ—ã‚’ä½œã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã®ã§ã€å¿…è¦ãªã‚‰ãã‚Œã‚‚ç´¹ä»‹ã—ã¦ã»ã—ã„ã€‚  
ãŸã ã€ã›ã£ã‹ããƒãƒ¼ã‚³ãƒ¼ãƒ‰ã®ãƒ„ãƒ¼ãƒ«ãªã®ã«ã€ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯å…ƒã‚‚å­ã‚‚ãªã„ã®ã§ã€ãã“ã¯æ³¨æ„ã—ã¦ã»ã—ã„ã§ã™ã€‚  
[https://developers.google.com/workspace/add-ons/studio/quickstart-calculator?hl=ja\#next-steps](https://developers.google.com/workspace/add-ons/studio/quickstart-calculator?hl=ja#next-steps)

appscript.json

```json
{
 "timeZone": "America/Los_Angeles",
 "exceptionLogging": "STACKDRIVER",
 "runtimeVersion": "V8",
 "addOns": {
   "common": {
     "name": "Calculator",
     "logoUrl": "https://www.gstatic.com/images/branding/productlogos/calculator_search/v1/web-24dp/logo_calculator_search_color_1x_web_24dp.png",
     "useLocaleFromApp": true
   },
   "flows": {
     "workflowElements": [
       {
         "id": "actionElement",
         "state": "ACTIVE",
         "name": "Calculate",
         "description": "Asks the user for two values and a math operation, then performs the math operation on the values and outputs the result.",
         "workflowAction": {
           "inputs": [
             {
               "id": "value1",
               "description": "value1",
               "cardinality": "SINGLE",
               "dataType": {
                 "basicType": "INTEGER"
               }
             },
             {
               "id": "value2",
               "description": "value2",
               "cardinality": "SINGLE",
               "dataType": {
                 "basicType": "INTEGER"
               }
             },
             {
               "id": "operation",
               "description": "operation",
               "cardinality": "SINGLE",
               "dataType": {
                 "basicType": "STRING"
               }
             }
           ],
           "outputs": [
             {
               "id": "result",
               "description": "Calculated result",
               "cardinality": "SINGLE",
               "dataType": {
                 "basicType": "INTEGER"
               }
             }
           ],
           "onConfigFunction": "onConfigCalculateFunction",
           "onExecuteFunction": "onExecuteCalculateFunction"
         }
       }
     ]
   }
 }
}

```

Calculator.gs

```javascript
/**
* This script defines a custom step for Google Workspace Studio.
* The step, named "Calculate", takes two numbers and an operation as input
* and returns the result of the calculation.
*
* The script includes functions to:
*
* 1.  Define the configuration UI for the step using Card objects:
*
*     - `onConfigCalculateFunction()`: Generates the main configuration card.
*     - Helper functions like `pushCard()`, `saveButton()` to build card components.
*
* 2.  Handle the execution of the step.
*
*     - `onExecuteCalculateFunction()`: Retrieves inputs, performs the calculation,
*       and returns outputs.
*
* To learn more, see the following quickstart guide:
* https://developers.google.com/workspace/add-ons/studio/quickstart
*/

/**
* Creates an action response to push a new card onto the card stack.
*
* This function generates an action object that, when returned, causes the
* provided card to be pushed onto the card stack, making it the currently
* displayed card in the configuration UI.
* @param {Object} card The Card object to push.
* @return {Object} The action response object.
*/
function pushCard(card) {
 return {

     "action": {
       "navigations": [{
           "push_card": card
         }
       ]
     }  }; 
}

/**
* Creates an action response to update the currently displayed card.
*
* This function generates an action object that, when returned, causes the
* currently displayed card to be replaced with the provided card in the
* configuration UI.
* @param {Object} card The Card object to update.
* @return {Object} The render actions object.
*/
function updateCard(card) {
 return {
   "render_actions": {
     "action": {
       "navigations": [{
           "update_card": card
         }
       ]
     }
   }
 };
}

/**
* Creates a button configuration object for saving the step.
*
* This function generates a button definition that, when clicked, triggers
* a save action for the current step configuration.
* @return {Object} The button widget object.
*/
function saveButton() {
 return {
     "text": "Save",
     "onClick": {
       "hostAppAction" : {
         "workflowAction" : {
           "saveWorkflowAction" : {}
         }
       }
     },
   };
}

/**
* Creates a button configuration object for a refresh action.
*
* This function generates a button definition that, when clicked, triggers
* a function to refresh the current card.
* @param {string} functionName The name of the Apps Script function to call on click.
* @return {Object} The button widget object.
*/
function refreshButton(functionName) {
 return {
     "text": "Refresh",
     "onClick": {
       "action" : {
         "function" : functionName
       }
     },
   };
}


/**
* Generates and displays a configuration card for the sample calculation action.
*
* This function creates a card with input fields for two values and a dropdown
* for selecting an arithmetic operation. The card also includes a "Save"
* button to save the action configuration for the step.
*
* The input fields are configured to let the user select outputs from previous
* steps as input values using the `hostAppDataSource` property.
* This function is called when the user adds or edits the "Calculate" step in the UI.
* @return {Object} The action response object containing the card to display.
*/
function onConfigCalculateFunction() {
 var card = {
   "sections": [
     {
       "header": "Action sample: Calculate",
       "widgets": [
         {
           "textInput": {
             "name": "value1",
             "label": "First value",
             "hostAppDataSource" : {
               "workflowDataSource" : {
                 "includeVariables" : true
               }
             }
           }
         },
         {
           "selectionInput": {
             "name": "operation",
             "label": "Operation",
             "type": "DROPDOWN",
             "items": [
               {
                 "text": "+",
                 "value": "+",
               },
               {
                 "text": "-",
                 "value": "-",
               },
               {
                 "text": "x",
                 "value": "x",
               },
               {
                 "text": "/",
                 "value": "/",
               }
             ]
           }
         },
         {
           "textInput": {
             "name": "value2",
             "label": "Second value",
             "hostAppDataSource" : {
               "workflowDataSource" : {
                 "includeVariables" : true
               }
             }
           }
         }
       ]
     }
   ]
 };
 return pushCard(card);
}

/**
* Gets an integer value from variable data, handling both string and integer formats.
*
* This function attempts to extract an integer value from the provided variable data.
* It checks if the data contains string values and, if so, parses the first string
* as an integer. If integer values are present, it returns the first integer.
* @param {Object} variableData The variable data object from the event.
* @return {number} The extracted integer value.
*/
function getIntValue(variableData) {
 if (variableData.stringValues) {
   return parseInt(variableData.stringValues[0]);
 }
 return variableData.integerValues[0];
}

/**
* Returns output variables from a step.
*
* This function constructs an object that, when returned, sends the
* provided variable values as output from the current step.
* The variable values are logged to the console for debugging purposes.
*/
function outputVariables(variableDataMap) {
const workflowAction = AddOnsResponseService.newReturnOutputVariablesAction()
  .setVariableDataMap(variableDataMap);

const hostAppAction = AddOnsResponseService.newHostAppAction()
  .setWorkflowAction(workflowAction);

const renderAction = AddOnsResponseService.newRenderActionBuilder()
  .setHostAppAction(hostAppAction)
  .build();

return renderAction;
}

/**
* Executes the calculation action based on the inputs from an event.
*
* This function retrieves input values ("value1", "value2") and the "operation"
* from the event, performs the calculation, and returns the "result" and
* "log" as output variables.
* This function is called when the agent reaches this custom step.
* @param {Object} event The event object passed by the runtime.
* @return {Object} The output variables object.
*/
function onExecuteCalculateFunction(event) {
console.log("output: " + JSON.stringify(event));
var calculatedValue = 0;
var value1 = event.workflow.actionInvocation.inputs["value1"].integerValues[0];
var value2 = event.workflow.actionInvocation.inputs["value2"].integerValues[0];
var operation = event.workflow.actionInvocation.inputs["operation"].stringValues[0];


if (operation == "+") {
  calculatedValue = value1 + value2;
} else if (operation == "-") {
  calculatedValue = value1 - value2;
} else if (operation == "x") {
  calculatedValue = value1 * value2;
} else if (operation == "/") {
  calculatedValue = value1 / value2;
}

const variableDataMap = { "result": AddOnsResponseService.newVariableData().addIntegerValue(calculatedValue) };

return outputVariables(variableDataMap);
}

```
