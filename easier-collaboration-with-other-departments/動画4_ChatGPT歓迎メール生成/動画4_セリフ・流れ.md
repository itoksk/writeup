# 動画4: ChatGPT AI歓迎メール生成！Googleフォームトリガーで内定者一人ひとりに最適化された感動メールを自動送信

**撮影時間**: 10分  
**目標**: Google Apps Script × ChatGPT API統合でフォームトリガー型AI歓迎メールシステムをマスター

---

## 🎬 オープニング（0:00-1:00）

### **セリフ**
「前回、Googleフォームとスプレッドシートの完璧な連携システムが完成しましたね。今回は、そのデータを使って『感動』を生み出します！」

「ChatGPT APIで、内定者一人ひとりに最適化された、心温まる歓迎メールを自動生成し、フォーム送信と同時に自動送信します。もう画一的なテンプレートメールはおしまいです。」

**【画面】**: 従来のテンプレートメール vs AI生成個別メールの比較

---

## 📊 AI活用の価値（1:00-2:00）

### **セリフ**
「なぜAIによる個別化が重要なのでしょうか？」

**【画面】**: 統計データ表示
- テンプレートメール開封率: 60%
- 個別化メール開封率: 85%
- 内定者満足度: 2.5倍向上

「人は『自分のために書かれた』と感じる文章に、強く心を動かされます。AIがあれば、それを大規模に実現できるんです。」

---

## 🏗️ 実装アーキテクチャ（2:00-3:00）

### **セリフ**
「今回の実装構成を確認しましょう」

**【画面】**: 技術フロー図

```
Googleフォーム送信（トリガー）
    ↓
Google Apps Script（自動実行）
    ↓
スプレッドシートからデータ取得
    ↓
ChatGPT APIコール
    ↓
個別メール生成
    ↓
Gmail API送信
    ↓
配信完了ログ
```

「フォーム送信をトリガーに、Google Apps ScriptがChatGPT APIを呼び出し、内定者情報を基に個別メールを生成。リアルタイムでGmail APIから自動送信します。」

---

## 🛠️ 実装デモ Part1: ChatGPT API設定（3:00-4:30）

### **セリフ**
「まず、ChatGPT APIとの連携を設定します」

#### **Step 1**: API設定（3:00-3:30）
**【操作・セリフ】**:
1. Apps Script → プロジェクト設定 → スクリプトプロパティ
2. 「OPENAI_API_KEY」を設定
3. 「セキュリティ上、APIキーは絶対にコードに直接書きません」

#### **Step 2**: API呼び出し関数（3:30-4:30）
**【コード実演】**:
```javascript
function callChatGPTAPI(prompt, model = 'gpt-4') {
  const apiKey = PropertiesService.getScriptProperties()
    .getProperty('OPENAI_API_KEY');
  
  const url = 'https://api.openai.com/v1/chat/completions';
  const payload = {
    model: model,
    messages: [
      {
        role: 'system',
        content: 'あなたは経験豊富で心温かい人事担当者です。'
      },
      {
        role: 'user', 
        content: prompt
      }
    ],
    max_tokens: 1000,
    temperature: 0.7
  };
  
  const options = {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${apiKey}`,
      'Content-Type': 'application/json'
    },
    payload: JSON.stringify(payload)
  };
  
  return UrlFetchApp.fetch(url, options);
}
```

---

## ⚡ 実装デモ Part2: 個別メール生成（4:30-6:30）

### **セリフ**
「ここからが今回の核心部分です。内定者情報を基に、ChatGPTで個別メールを生成します」

#### **Step 1**: プロンプト設計（4:30-5:15）
**【セリフ・コード】**:
「効果的なプロンプトの秘訣は、具体的な指示と文脈情報です」

```javascript
function generatePersonalizedWelcomeEmail(employeeData) {
  const departmentContext = getDepartmentContext(employeeData.department);
  
  const prompt = `
あなたは経験豊富で心温かい人事担当者です。
新入社員に感動的な歓迎メールを作成してください。

【内定者情報】
氏名: ${employeeData.name}
入社日: ${employeeData.startDate}
配属部署: ${employeeData.department} 
職種: ${employeeData.position}
雇用形態: ${employeeData.employmentType}

【部署の特色】
${departmentContext.description}

【期待する成果】
${departmentContext.expectations}

【要求事項】
1. 温かみのある、しかしプロフェッショナルな口調
2. 職種・部署に特化した具体的な期待内容を含める
3. 会社への帰属意識を高める内容
4. 不安を和らげ、やる気を引き出す内容
5. 400-600文字程度
6. HTMLメール形式

メール件名も含めて生成してください。
`;

  const response = callChatGPTAPI(prompt);
  return parseEmailResponse(response);
}
```

#### **Step 2**: 部署別カスタマイズ（5:15-6:00）
**【セリフ】**: 「部署ごとの特色を反映させることで、より具体的で魅力的なメールになります」

**【コード実演】**:
```javascript
function getDepartmentContext(department) {
  const contexts = {
    '営業部': {
      description: 'お客様との関係構築と売上拡大が主要な使命です。',
      expectations: '顧客理解力、提案力、コミュニケーション能力の向上を期待しています。'
    },
    '開発部': {
      description: '最新技術を活用した高品質なシステム開発に取り組んでいます。',
      expectations: 'プログラミングスキル、システム設計能力、チーム開発スキルの向上を期待しています。'
    }
    // 他の部署も同様に設定
  };
  
  return contexts[department] || defaultContext;
}
```

#### **Step 3**: タスクリスト生成（6:00-6:30）
**【セリフ】**: 「メールだけでなく、個別のタスクリストも自動生成します」

---

## 🎯 完成デモ（6:30-8:00）

### **セリフ**
「では、実際にAI生成メールシステムをテストしてみましょう！」

#### **実演**
**【操作・セリフ】**:
1. **対象データ選択**: 「山田花子さん（開発部・システムエンジニア）のデータを使用」

2. **AI生成実行**: 
   - 関数実行ボタンクリック
   - 「ChatGPT APIにリクエスト送信中...」
   - Apps Script実行ログをリアルタイム表示

3. **生成結果確認**:
   - 件名: 「【山田花子様】開発部チーム一同、心からお待ちしております！」
   - 本文: 職種特化の内容、部署の期待、具体的な初週予定
   - 「見てください！テンプレートとは全く違う、個別化された内容です」

4. **メール送信**:
   - Gmail API経由で自動送信
   - 送信ログ確認
   - 「たった30秒で、感動的な歓迎メールが完成・送信されました！」

---

## 🛡️ 堅牢性設計（8:00-8:45）

### **セリフ**
「実用的なシステムには、エラー対応も重要です」

#### **フォールバック戦略**
**【コード表示】**:
```javascript
function robustEmailGeneration(employeeData) {
  try {
    // 第一選択: AI生成メール
    return generateAIEmail(employeeData);
  } catch (aiError) {
    console.log('AI生成失敗、テンプレートにフォールバック');
    try {
      // 第二選択: 高品質テンプレート  
      return generateTemplateEmail(employeeData);
    } catch (templateError) {
      // 最終選択: 基本メール
      return generateBasicEmail(employeeData);
    }
  }
}
```

**【セリフ】**: 「ChatGPT APIが使えない場合でも、高品質なテンプレートで継続。完全に止まることはありません」

---

## 📊 効果測定（8:45-9:15）

### **セリフ**
「AI個別化の効果を数値で確認してみましょう」

**【画面】**: 効果比較グラフ
- **開封率**: 60% → 85% (41%向上)
- **返信率**: 5% → 15% (3倍向上)  
- **満足度**: 3.2/5 → 4.6/5 (44%向上)
- **作成時間**: 15分/件 → 30秒/件 (97%短縮)

**【セリフ】**: 「AIによる個別化で、量と質の両方で劇的な改善を実現できます」

---

## 🎯 まとめ・次回予告（9:15-10:00）

### **セリフ**
「今日学んだこと」
- ChatGPT API とGoogle Apps Script の統合
- 効果的なプロンプト設計
- 部署別カスタマイズ手法
- 堅牢なフォールバック戦略

**【次回予告】**:
「次回は、このAI技術をさらに発展させて、人事部専用のAIアシスタントを開発します。プロンプト不要で、誰でも高品質な案内文を生成できる環境を構築します！」

---

## 🎥 撮影メモ

### **画面構成**
- **メイン**: Apps Script エディタ
- **サブ**: ChatGPT APIレスポンス、Gmail送信結果
- **分割**: コード編集と実行結果の同時表示

### **デモのポイント**
1. **API設定**: セキュリティ重視の設定方法
2. **プロンプト設計**: 効果的な指示文の作成  
3. **リアルタイム生成**: 実際のAI生成過程
4. **結果比較**: テンプレート vs AI生成の違い

### **強調ポイント**
- AIの個別化能力
- 技術的実装の簡単さ
- エラー対応の重要性
- 実用性の高さ

この実装により、受講者はAIの力を実感し、次のステップへの強いモチベーションを得ます。