# 動画5: Google Apps Script WebAppで「人事専用AI」を開発！プロンプト不要で高品質な案内文を誰でも生成

**撮影時間**: 10分  
**目標**: Google Apps Script WebAppとChatGPT APIで人事専用AIアシスタントを構築

---

## 🎬 オープニング（0:00-1:00）

### **セリフ**
「前回、ChatGPT APIの威力を体感していただきました。でも『プロンプトを毎回考えるのは大変』『他の人事メンバーも使えるようにしたい』と思いませんでしたか？」

「今回は、Google Apps Script WebAppを使って、プロンプト不要で誰でも使える『人事専用AIアシスタント』を開発します！」

**【画面】**: 完成形のWebアプリ画面を先に見せる

---

## 🎯 WebApp開発のメリット（1:00-2:00）

### **セリフ**
「なぜWebアプリ化が重要なのでしょうか？」

**【画面】**: Before/After比較
- Before: Apps Scriptコードを直接実行（技術者のみ）
- After: ブラウザで簡単操作（誰でも使用可能）

「チーム全体で AI の恩恵を受けられ、プロンプト設計も不要。しかもGoogle環境内で安全に運用できます。」

---

## 🏗️ WebApp設計思想（2:00-3:00）

### **セリフ**
「今回構築するWebアプリの全体設計をご説明します」

**【画面】**: アーキテクチャ図
```
Webブラウザ（UI）
    ↓
Google Apps Script WebApp
    ↓
ChatGPT API（AI処理）
    ↓
結果表示・ダウンロード
```

「ユーザーは簡単な情報を入力するだけ。AIが専門的な人事文書を自動生成します。」

---

## 🛠️ 実装デモ Part1: WebApp基盤構築（3:00-5:00）

### **セリフ**
「では、実際にWebアプリを作ってみましょう！」

#### **Step 1**: HTML UI作成（3:00-4:00）
**【操作・セリフ】**:
1. Apps Script → 「新しいファイル」→ 「HTML」
2. ファイル名: 「index.html」

**【コード実演】**:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>人事専用AIアシスタント</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin: 20px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #4285f4; color: white; padding: 15px 30px; border: none; border-radius: 4px; cursor: pointer; }
        .result { margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>🤖 人事専用AIアシスタント</h1>
    
    <div class="form-group">
        <label>生成タイプ:</label>
        <select id="contentType">
            <option value="welcome">歓迎メール</option>
            <option value="onboarding">入社案内文書</option>
            <option value="reminder">リマインダー通知</option>
        </select>
    </div>
    
    <div class="form-group">
        <label>氏名:</label>
        <input type="text" id="name" placeholder="山田花子">
    </div>
    
    <div class="form-group">
        <label>職種:</label>
        <input type="text" id="position" placeholder="システムエンジニア">
    </div>
    
    <div class="form-group">
        <label>入社日:</label>
        <input type="date" id="startDate">
    </div>
    
    <div class="form-group">
        <label>部署:</label>
        <select id="department">
            <option value="営業部">営業部</option>
            <option value="開発部">開発部</option>
            <option value="マーケティング部">マーケティング部</option>
            <option value="人事部">人事部</option>
        </select>
    </div>
    
    <button onclick="generateContent()">✨ AI生成実行</button>
    
    <div id="result" class="result" style="display:none;">
        <h3>生成結果:</h3>
        <div id="generatedContent"></div>
        <button onclick="downloadContent()">📥 ダウンロード</button>
    </div>

    <script>
        function generateContent() {
            const data = {
                contentType: document.getElementById('contentType').value,
                name: document.getElementById('name').value,
                position: document.getElementById('position').value,
                startDate: document.getElementById('startDate').value,
                department: document.getElementById('department').value
            };
            
            // Google Apps Script 関数を呼び出し
            google.script.run
                .withSuccessHandler(displayResult)
                .withFailureHandler(displayError)
                .generateHRContent(data);
        }
        
        function displayResult(content) {
            document.getElementById('generatedContent').innerHTML = content;
            document.getElementById('result').style.display = 'block';
        }
        
        function displayError(error) {
            alert('エラーが発生しました: ' + error.message);
        }
    </script>
</body>
</html>
```

#### **Step 2**: サーバーサイド関数（4:00-5:00）
**【コード実演】**:
```javascript
function doGet() {
  return HtmlService.createTemplateFromFile('index')
    .evaluate()
    .setTitle('人事専用AIアシスタント')
    .addMetaTag('viewport', 'width=device-width, initial-scale=1');
}

function generateHRContent(data) {
  console.log('AI生成開始:', data);
  
  try {
    let prompt = '';
    
    // コンテンツタイプに応じてプロンプトを自動生成
    switch(data.contentType) {
      case 'welcome':
        prompt = createWelcomePrompt(data);
        break;
      case 'onboarding':
        prompt = createOnboardingPrompt(data);
        break;
      case 'reminder':
        prompt = createReminderPrompt(data);
        break;
    }
    
    const aiResponse = callChatGPTAPI(prompt);
    const result = JSON.parse(aiResponse.getContentText());
    
    return result.choices[0].message.content;
    
  } catch (error) {
    console.error('AI生成エラー:', error);
    throw new Error('AI生成に失敗しました');
  }
}
```

---

## ⚡ 実装デモ Part2: AI機能統合（5:00-7:00）

### **セリフ**
「WebAppの基盤ができました。次に、用途別のAI生成機能を実装します」

#### **Step 1**: プロンプト自動生成（5:00-6:00）
**【セリフ・コード】**:
「ユーザーはプロンプトを考える必要なし。システムが最適なプロンプトを自動生成します」

```javascript
function createWelcomePrompt(data) {
  return `
あなたは経験豊富で温かい人事担当者です。
以下の新入社員への歓迎メールを作成してください。

【新入社員情報】
氏名: ${data.name}
職種: ${data.position}
入社日: ${data.startDate}
部署: ${data.department}

【要件】
1. 温かく歓迎する口調
2. ${data.position}・${data.department}に特化した内容
3. 300-400文字程度
4. HTMLメール形式
5. 会社への期待感を高める内容

件名も含めて生成してください。
`;
}

function createOnboardingPrompt(data) {
  return `
${data.name}さん（${data.position}、${data.department}）の入社案内文書を作成してください。

【要件】
1. 入社初日のスケジュール
2. 必要な準備物
3. 会社の基本情報
4. 部署の紹介
5. 緊急連絡先
6. よくある質問と回答

プロフェッショナルで親しみやすい文書にしてください。
`;
}
```

#### **Step 2**: エラーハンドリング（6:00-7:00）
**【セリフ】**: 「Webアプリでは、ユーザーフレンドリーなエラー対応が重要です」

```javascript
function generateHRContentWithFallback(data) {
  try {
    // AI生成を試行
    return generateAIContent(data);
  } catch (aiError) {
    console.log('AI生成失敗、テンプレートを使用');
    // 高品質テンプレートにフォールバック
    return generateTemplateContent(data);
  }
}
```

---

## 🎯 完成デモ（7:00-8:30）

### **セリフ**
「完成したWebアプリを実際に使ってみましょう！」

#### **実演**
**【操作・セリフ】**:
1. **WebApp公開**:
   - デプロイ → 新しいデプロイメント
   - 「誰でもアクセス可能に設定」
   - WebApp URLを取得

2. **ブラウザでアクセス**:
   - 新しいブラウザタブで開く
   - 「きれいなUIが表示されました」

3. **歓迎メール生成テスト**:
   - コンテンツタイプ: 歓迎メール
   - 氏名: 田中一郎
   - 職種: 営業担当
   - 入社日: 2024年4月15日
   - 部署: 営業部
   - 「AI生成実行」ボタンクリック

4. **結果確認**:
   - 「15秒でAI生成完了！」
   - 営業部特化の歓迎メール表示
   - HTMLフォーマットで美しく整形
   - ダウンロード機能も動作

**【セリフ】**: 「プロンプトを一切書かずに、プロ品質の文書が完成しました！」

---

## 📊 利用統計・管理機能（8:30-9:00）

### **セリフ**
「実用的なWebアプリには、利用状況の把握も重要です」

#### **利用ログ機能**
**【コード表示】**:
```javascript
function logUsage(userData, generationType, success) {
  const logSheet = getOrCreateUsageLogSheet();
  
  logSheet.appendRow([
    new Date(),
    Session.getActiveUser().getEmail(),
    generationType,
    userData.name,
    userData.department,
    success ? 'Success' : 'Failed',
    new Date()
  ]);
}

function getUsageStats() {
  const logSheet = getOrCreateUsageLogSheet();
  const data = logSheet.getDataRange().getValues();
  
  // 統計情報を集計
  const stats = {
    totalGenerations: data.length - 1,
    successRate: calculateSuccessRate(data),
    popularContentTypes: getPopularTypes(data)
  };
  
  return stats;
}
```

**【セリフ】**: 「どの部署がよく使っているか、成功率はどうかなど、改善に役立つデータが蓄積されます」

---

## 🎯 まとめ・次回予告（9:00-10:00）

### **セリフ**
「今日学んだこと」
- Google Apps Script WebApp開発
- ユーザーフレンドリーなUI設計
- プロンプト自動生成システム
- エラーハンドリングと統計機能

**【実現できたこと】**:
- 技術知識不要でAI活用
- チーム全体での利用
- 品質の統一化
- 利用状況の可視化

**【次回予告】**:
「次回は、このWebアプリで生成したコンテンツを、Google APIを使って実際に配信します。Gmail、Calendar、Chatなど、複数のサービスを連携させた統合自動化システムを構築します！」

---

## 🎥 撮影メモ

### **画面構成**
- **メイン**: Apps Script エディタ（HTML + JavaScript）
- **サブ**: ブラウザ（WebApp実行画面）
- **分割**: コーディングと動作確認の同時表示

### **デモの流れ**
1. UI設計とコーディング
2. サーバーサイド実装
3. デプロイと動作確認
4. 実際の利用シーン

### **強調ポイント**
- 使いやすさ（UX）
- 技術的簡潔性
- チーム利用の価値
- 拡張性の高さ

この実装により、AI技術をチーム全体で活用できる実用的なシステムが完成します。