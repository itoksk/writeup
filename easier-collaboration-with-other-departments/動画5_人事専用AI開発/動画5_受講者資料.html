<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•ç”»5: Google Apps Script WebAppã§äººäº‹å°‚ç”¨AIé–‹ç™ºï¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¸è¦ã§èª°ã§ã‚‚ä½¿ãˆã‚‹</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #4285f4;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            border-left: 5px solid #4285f4;
            padding-left: 15px;
            margin-top: 40px;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .webapp-demo {
            background-color: #e8f0fe;
            border: 2px solid #4285f4;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .before {
            background-color: #ffebee;
            border-left: 5px solid #f44336;
            padding: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .after {
            background-color: #e8f5e8;
            border-left: 5px solid #4caf50;
            padding: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .ui-design {
            background-color: #fff3e0;
            border: 2px solid #ff9800;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .ai-features {
            background-color: #f3e5f5;
            border: 2px solid #9c27b0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .webapp-mockup {
            background: #f8f9fa;
            border: 2px solid #4285f4;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .feature-highlight {
            background: linear-gradient(90deg, #e8f0fe 0%, #f3e5f5 100%);
            border-left: 5px solid #4285f4;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .success-tip {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .form-preview {
            background: #ffffff;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .form-field {
            margin: 15px 0;
        }
        
        .form-field label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #495057;
        }
        
        .form-field input, .form-field select, .form-field textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .btn-primary {
            background: #4285f4;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 0;
        }
        
        @media (max-width: 768px) {
            .before-after {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ äººäº‹å°‚ç”¨AI WebAppé–‹ç™ºï¼ãƒãƒ¼ãƒ å…¨ä½“ã§AIæ´»ç”¨ã‚’å®Ÿç¾</h1>
        
        <div class="highlight-box">
            <h2 style="border: none; color: white; margin-top: 0;">ğŸ¯ ã“ã®å‹•ç”»ã§å­¦ã¶ã“ã¨</h2>
            <ul>
                <li>Google Apps Script WebAppé–‹ç™ºã®åŸºç¤ã‹ã‚‰å¿œç”¨</li>
                <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªUI/UXè¨­è¨ˆ</li>
                <li>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè‡ªå‹•ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰</li>
                <li>ãƒãƒ¼ãƒ åˆ©ç”¨ã®ãŸã‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨çµ±è¨ˆæ©Ÿèƒ½</li>
            </ul>
        </div>

        <h2>ğŸš€ WebAppé–‹ç™ºã®é©å‘½çš„ä¾¡å€¤</h2>
        
        <div class="before-after">
            <div class="before">
                <h3>âŒ å¾“æ¥ã®AIåˆ©ç”¨æ–¹æ³•</h3>
                <ul>
                    <li><strong>åˆ©ç”¨è€…é™å®š:</strong> æŠ€è¡“è€…ã®ã¿ãŒApps Scriptå®Ÿè¡Œ</li>
                    <li><strong>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆ:</strong> æ¯å›è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚‹</li>
                    <li><strong>æ“ä½œè¤‡é›‘:</strong> ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ã§ã®ä½œæ¥­</li>
                    <li><strong>å“è³ªä¸å®‰å®š:</strong> äººã«ã‚ˆã£ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®è³ªãŒé•ã†</li>
                    <li><strong>å­¦ç¿’ã‚³ã‚¹ãƒˆ:</strong> æ–°ãƒ¡ãƒ³ãƒãƒ¼ã®æ•™è‚²ãŒå¤§å¤‰</li>
                </ul>
            </div>
            
            <div class="after">
                <h3>âœ… WebAppåŒ–ã«ã‚ˆã‚‹æ”¹é©</h3>
                <ul>
                    <li><strong>åˆ©ç”¨è€…æ‹¡å¤§:</strong> äººäº‹éƒ¨å…¨å“¡ãŒãƒ–ãƒ©ã‚¦ã‚¶ã§åˆ©ç”¨</li>
                    <li><strong>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè‡ªå‹•:</strong> ã‚·ã‚¹ãƒ†ãƒ ãŒæœ€é©ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ</li>
                    <li><strong>æ“ä½œç°¡å˜:</strong> ç¾ã—ã„Webãƒ•ã‚©ãƒ¼ãƒ ã§ç›´æ„Ÿæ“ä½œ</li>
                    <li><strong>å“è³ªä¸€å®š:</strong> AIå°‚é–€å®¶è¨­è¨ˆã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½¿ç”¨</li>
                    <li><strong>å³æˆ¦åŠ›:</strong> æ–°ãƒ¡ãƒ³ãƒãƒ¼ã‚‚åˆæ—¥ã‹ã‚‰æ´»ç”¨å¯èƒ½</li>
                </ul>
            </div>
        </div>

        <h2>ğŸ—ï¸ WebApp ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ</h2>
        
        <div class="webapp-demo">
            <h3>ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³</h3>
            <div class="code-block">
ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰
        â†“
Google Apps Script WebApp
        â†“
ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè‡ªå‹•ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³
        â†“
ChatGPT APIï¼ˆAIå‡¦ç†ï¼‰
        â†“
çµæœè¡¨ç¤ºãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
        â†“
åˆ©ç”¨çµ±è¨ˆãƒ­ã‚°ï¼ˆæ”¹å–„ãƒ‡ãƒ¼ã‚¿ï¼‰
</div>
            <p><strong>ğŸ¯ è¨­è¨ˆæ€æƒ³ï¼š</strong> æŠ€è¡“çŸ¥è­˜ã‚¼ãƒ­ã®äººäº‹æ‹…å½“è€…ã§ã‚‚ã€ãƒ—ãƒ­å“è³ªã®AIç”Ÿæˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä½œæˆã§ãã‚‹ã‚·ã‚¹ãƒ†ãƒ </p>
        </div>

        <h2>ğŸ¨ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ</h2>
        
        <div class="ui-design">
            <h3>ğŸ–¥ï¸ WebAppç”»é¢ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
            
            <div class="form-preview">
                <h2 style="text-align: center; color: #4285f4;">ğŸ¤– äººäº‹å°‚ç”¨AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</h2>
                
                <div class="form-field">
                    <label>ç”Ÿæˆã‚¿ã‚¤ãƒ—:</label>
                    <select>
                        <option>æ­“è¿ãƒ¡ãƒ¼ãƒ«</option>
                        <option>å…¥ç¤¾æ¡ˆå†…æ–‡æ›¸</option>
                        <option>ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€šçŸ¥</option>
                        <option>ç ”ä¿®è³‡æ–™</option>
                    </select>
                </div>
                
                <div class="form-field">
                    <label>æ°å:</label>
                    <input type="text" placeholder="å±±ç”°èŠ±å­" />
                </div>
                
                <div class="form-field">
                    <label>è·ç¨®:</label>
                    <input type="text" placeholder="ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢" />
                </div>
                
                <div class="form-field">
                    <label>éƒ¨ç½²:</label>
                    <select>
                        <option>å–¶æ¥­éƒ¨</option>
                        <option>é–‹ç™ºéƒ¨</option>
                        <option>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨</option>
                        <option>äººäº‹éƒ¨</option>
                    </select>
                </div>
                
                <div class="form-field">
                    <label>å…¥ç¤¾æ—¥:</label>
                    <input type="date" />
                </div>
                
                <button class="btn-primary">âœ¨ AIç”Ÿæˆå®Ÿè¡Œ</button>
                
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px; display: none;" id="result">
                    <h4>ç”Ÿæˆçµæœ:</h4>
                    <div style="background: white; padding: 15px; border-radius: 4px;">
                        AIç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
                    </div>
                    <button class="btn-primary">ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                </div>
            </div>
        </div>

        <h2>âš¡ å®Ÿè£…ãƒ‡ãƒ¢: HTML + JavaScript</h2>
        
        <div class="ai-features">
            <h3>ğŸ¯ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…</h3>
            
            <h4>Step 1: HTMLæ§‹é€ </h4>
            <div class="code-block">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;äººäº‹å°‚ç”¨AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ&lt;/title&gt;
    &lt;style&gt;
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        .form-group { margin: 20px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { 
            width: 100%; 
            padding: 10px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }
        button { 
            background: #4285f4; 
            color: white; 
            padding: 15px 30px; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
        }
        .result { 
            margin-top: 20px; 
            padding: 20px; 
            background: #f8f9fa; 
            border-radius: 4px; 
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;ğŸ¤– äººäº‹å°‚ç”¨AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ&lt;/h1&gt;
    
    &lt;div class="form-group"&gt;
        &lt;label&gt;ç”Ÿæˆã‚¿ã‚¤ãƒ—:&lt;/label&gt;
        &lt;select id="contentType"&gt;
            &lt;option value="welcome"&gt;æ­“è¿ãƒ¡ãƒ¼ãƒ«&lt;/option&gt;
            &lt;option value="onboarding"&gt;å…¥ç¤¾æ¡ˆå†…æ–‡æ›¸&lt;/option&gt;
            &lt;option value="reminder"&gt;ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€šçŸ¥&lt;/option&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    
    &lt;button onclick="generateContent()"&gt;âœ¨ AIç”Ÿæˆå®Ÿè¡Œ&lt;/button&gt;
    
    &lt;div id="result" class="result" style="display:none;"&gt;
        &lt;h3&gt;ç”Ÿæˆçµæœ:&lt;/h3&gt;
        &lt;div id="generatedContent"&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</div>
            
            <h4>Step 2: JavaScript ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å‡¦ç†</h4>
            <div class="code-block">
function generateContent() {
    // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®åé›†
    const data = {
        contentType: document.getElementById('contentType').value,
        name: document.getElementById('name').value,
        position: document.getElementById('position').value,
        startDate: document.getElementById('startDate').value,
        department: document.getElementById('department').value
    };
    
    // å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    if (!data.name || !data.position) {
        alert('å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
    }
    
    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
    showLoading();
    
    // Google Apps Script é–¢æ•°ã‚’å‘¼ã³å‡ºã—
    google.script.run
        .withSuccessHandler(displayResult)
        .withFailureHandler(displayError)
        .generateHRContent(data);
}

function displayResult(content) {
    document.getElementById('generatedContent').innerHTML = content;
    document.getElementById('result').style.display = 'block';
    hideLoading();
}

function displayError(error) {
    alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
    hideLoading();
}

function downloadContent() {
    const content = document.getElementById('generatedContent').innerHTML;
    const blob = new Blob([content], {type: 'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'ai_generated_content.html';
    a.click();
}</div>
        </div>

        <h2>ğŸ”§ ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å®Ÿè£…</h2>
        
        <div class="webapp-demo">
            <h3>âš™ï¸ Google Apps Script ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰</h3>
            
            <h4>WebApp ãƒ¡ã‚¤ãƒ³é–¢æ•°</h4>
            <div class="code-block">
function doGet() {
  return HtmlService.createTemplateFromFile('index')
    .evaluate()
    .setTitle('äººäº‹å°‚ç”¨AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ')
    .addMetaTag('viewport', 'width=device-width, initial-scale=1')
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}

function generateHRContent(data) {
  console.log('AIç”Ÿæˆé–‹å§‹:', data);
  
  try {
    // åˆ©ç”¨ãƒ­ã‚°è¨˜éŒ²
    logUsage(data, true);
    
    // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ
    let prompt = '';
    switch(data.contentType) {
      case 'welcome':
        prompt = createWelcomePrompt(data);
        break;
      case 'onboarding':
        prompt = createOnboardingPrompt(data);
        break;
      case 'reminder':
        prompt = createReminderPrompt(data);
        break;
      default:
        throw new Error('æœªå¯¾å¿œã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ã§ã™');
    }
    
    // ChatGPT APIå‘¼ã³å‡ºã—
    const aiResponse = callChatGPTAPI(prompt);
    const result = JSON.parse(aiResponse.getContentText());
    
    // ç”Ÿæˆçµæœã‚’æ•´å½¢ã—ã¦è¿”å´
    const generatedContent = result.choices[0].message.content;
    
    // æˆåŠŸãƒ­ã‚°
    logUsage(data, true);
    
    return formatGeneratedContent(generatedContent, data);
    
  } catch (error) {
    console.error('AIç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
    
    // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
    logUsage(data, false, error.message);
    
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
    return generateFallbackContent(data);
  }
}</div>
            
            <h4>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè‡ªå‹•ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ </h4>
            <div class="code-block">
function createWelcomePrompt(data) {
  const departmentContext = getDepartmentContext(data.department);
  
  return `
ã‚ãªãŸã¯çµŒé¨“è±Šå¯Œã§å¿ƒæ¸©ã‹ã„äººäº‹æ‹…å½“è€…ã§ã™ã€‚
ä»¥ä¸‹ã®æ–°å…¥ç¤¾å“¡ã¸ã®æ­“è¿ãƒ¡ãƒ¼ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€æ–°å…¥ç¤¾å“¡æƒ…å ±ã€‘
æ°å: ${data.name}
è·ç¨®: ${data.position}
å…¥ç¤¾æ—¥: ${data.startDate}
éƒ¨ç½²: ${data.department}

ã€éƒ¨ç½²ã®ç‰¹è‰²ã€‘
${departmentContext.description}

ã€è¦ä»¶ã€‘
1. æ¸©ã‹ãæ­“è¿ã™ã‚‹å£èª¿
2. ${data.position}ãƒ»${data.department}ã«ç‰¹åŒ–ã—ãŸå†…å®¹
3. 300-400æ–‡å­—ç¨‹åº¦
4. HTMLãƒ¡ãƒ¼ãƒ«å½¢å¼
5. ä¼šç¤¾ã¸ã®æœŸå¾…æ„Ÿã‚’é«˜ã‚ã‚‹å†…å®¹

ä»¶åã‚‚å«ã‚ã¦ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
`;
}

function createOnboardingPrompt(data) {
  return `
${data.name}ã•ã‚“ï¼ˆ${data.position}ã€${data.department}ï¼‰ã®å…¥ç¤¾æ¡ˆå†…æ–‡æ›¸ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€è¦ä»¶ã€‘
1. å…¥ç¤¾åˆæ—¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
2. å¿…è¦ãªæº–å‚™ç‰©
3. ä¼šç¤¾ã®åŸºæœ¬æƒ…å ±
4. éƒ¨ç½²ã®ç´¹ä»‹
5. ç·Šæ€¥é€£çµ¡å…ˆ
6. ã‚ˆãã‚ã‚‹è³ªå•ã¨å›ç­”

ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã§è¦ªã—ã¿ã‚„ã™ã„æ–‡æ›¸ã«ã—ã¦ãã ã•ã„ã€‚
HTMLå½¢å¼ã§è¦‹ã‚„ã™ãæ•´å½¢ã—ã¦ãã ã•ã„ã€‚
`;
}

function createReminderPrompt(data) {
  return `
${data.name}ã•ã‚“ï¼ˆ${data.department}ãƒ»${data.position}ï¼‰ã¸ã®å…¥ç¤¾å‰ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€šçŸ¥ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€è¦ä»¶ã€‘
1. å…¥ç¤¾æ—¥ã®ç¢ºèª
2. å¿…è¦æ›¸é¡ã®æœ€çµ‚ç¢ºèª
3. å½“æ—¥ã®æµã‚Œã®èª¬æ˜
4. æŒå‚ç‰©ã®ç¢ºèª
5. é€£çµ¡å…ˆã®å†ç¢ºèª

è¦ªã—ã¿ã‚„ã™ãã€ä¸å®‰ã‚’å’Œã‚‰ã’ã‚‹å†…å®¹ã«ã—ã¦ãã ã•ã„ã€‚
`;
}</div>
        </div>

        <h2>ğŸ“Š åˆ©ç”¨çµ±è¨ˆãƒ»ç®¡ç†æ©Ÿèƒ½</h2>
        
        <div class="feature-highlight">
            <h3>ğŸ“ˆ WebAppåˆ©ç”¨çŠ¶æ³ã®å¯è¦–åŒ–</h3>
            
            <h4>åˆ©ç”¨ãƒ­ã‚°æ©Ÿèƒ½</h4>
            <div class="code-block">
function logUsage(userData, success, errorMessage = '') {
  try {
    const logSheet = getOrCreateUsageLogSheet();
    
    logSheet.appendRow([
      new Date(),                                    // å®Ÿè¡Œæ—¥æ™‚
      Session.getActiveUser().getEmail(),           // åˆ©ç”¨è€…
      userData.contentType,                         // ç”Ÿæˆã‚¿ã‚¤ãƒ—
      userData.name,                                // å¯¾è±¡è€…å
      userData.department,                          // éƒ¨ç½²
      success ? 'Success' : 'Failed',               // çµæœ
      errorMessage,                                 // ã‚¨ãƒ©ãƒ¼è©³ç´°
      JSON.stringify(userData)                      // è©³ç´°ãƒ‡ãƒ¼ã‚¿
    ]);
    
  } catch (error) {
    console.error('ãƒ­ã‚°è¨˜éŒ²ã‚¨ãƒ©ãƒ¼:', error);
  }
}

function getUsageStats() {
  const logSheet = getOrCreateUsageLogSheet();
  const data = logSheet.getDataRange().getValues();
  
  if (data.length <= 1) return null; // ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã¿ã®å ´åˆ
  
  // çµ±è¨ˆæƒ…å ±ã‚’é›†è¨ˆ
  const stats = {
    totalGenerations: data.length - 1,
    successCount: data.slice(1).filter(row => row[5] === 'Success').length,
    failureCount: data.slice(1).filter(row => row[5] === 'Failed').length,
    successRate: 0,
    popularContentTypes: {},
    departmentUsage: {},
    activeUsers: new Set()
  };
  
  // æˆåŠŸç‡è¨ˆç®—
  stats.successRate = stats.totalGenerations > 0 ? 
    (stats.successCount / stats.totalGenerations * 100).toFixed(1) : 0;
  
  // è©³ç´°åˆ†æ
  data.slice(1).forEach(row => {
    const contentType = row[2];
    const department = row[4];
    const user = row[1];
    
    // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—åˆ¥é›†è¨ˆ
    stats.popularContentTypes[contentType] = 
      (stats.popularContentTypes[contentType] || 0) + 1;
    
    // éƒ¨ç½²åˆ¥é›†è¨ˆ
    stats.departmentUsage[department] = 
      (stats.departmentUsage[department] || 0) + 1;
    
    // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼
    stats.activeUsers.add(user);
  });
  
  stats.activeUsers = stats.activeUsers.size;
  
  return stats;
}</div>
            
            <div class="success-tip">
                <strong>ğŸ“Š çµ±è¨ˆæ´»ç”¨ã®ãƒ¡ãƒªãƒƒãƒˆ:</strong>
                <ul>
                    <li>ã©ã®éƒ¨ç½²ãŒã‚ˆãåˆ©ç”¨ã—ã¦ã„ã‚‹ã‹ã®æŠŠæ¡</li>
                    <li>äººæ°—æ©Ÿèƒ½ã®ç‰¹å®šã¨æ©Ÿèƒ½æ”¹å–„ã®æ–¹å‘æ€§</li>
                    <li>ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†æã¨å“è³ªå‘ä¸Š</li>
                    <li>åˆ©ç”¨è€…ã®æ´»å‹•çŠ¶æ³ã¨æ•™è‚²ãƒ‹ãƒ¼ã‚ºã®æŠŠæ¡</li>
                </ul>
            </div>
        </div>

        <h2>ğŸ›¡ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯</h2>
        
        <div class="ai-features">
            <h3>ğŸ”„ 3æ®µéšãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨­è¨ˆ</h3>
            
            <div class="code-block">
function generateHRContentWithFallback(data) {
  try {
    // ç¬¬ä¸€é¸æŠ: AIç”Ÿæˆ
    console.log('AIç”Ÿæˆã‚’è©¦è¡Œä¸­...');
    return generateAIContent(data);
    
  } catch (aiError) {
    console.log('AIç”Ÿæˆå¤±æ•—ã€é«˜å“è³ªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨:', aiError.message);
    
    try {
      // ç¬¬äºŒé¸æŠ: éƒ¨ç½²ç‰¹åŒ–ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
      return generateDepartmentSpecificTemplate(data);
      
    } catch (templateError) {
      console.log('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆå¤±æ•—ã€åŸºæœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä½¿ç”¨:', templateError.message);
      
      // ç¬¬ä¸‰é¸æŠ: åŸºæœ¬ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆç¢ºå®Ÿã«å‹•ä½œï¼‰
      return generateBasicContent(data);
    }
  }
}

function generateBasicContent(data) {
  // æœ€ä½é™ã®å“è³ªã‚’ä¿è¨¼ã™ã‚‹åŸºæœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
  const basicTemplates = {
    welcome: `
      <h2>${data.name}æ§˜</h2>
      <p>ã“ã®åº¦ã¯ã€å¼Šç¤¾ã¸ã®ã”å…¥ç¤¾èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚</p>
      <p><strong>å…¥ç¤¾æ—¥:</strong> ${data.startDate}</p>
      <p><strong>é…å±éƒ¨ç½²:</strong> ${data.department}</p>
      <p>${data.department}ãƒãƒ¼ãƒ ä¸€åŒã€å¿ƒã‚ˆã‚ŠãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚</p>
    `,
    onboarding: `
      <h2>å…¥ç¤¾æº–å‚™ã®ã”æ¡ˆå†…</h2>
      <h3>å…¥ç¤¾æ—¥: ${data.startDate}</h3>
      <h3>é…å±: ${data.department}</h3>
      <p>è©³ç´°ã¯åˆ¥é€”ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚</p>
    `,
    reminder: `
      <h2>å…¥ç¤¾å‰ã®ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼</h2>
      <p>${data.name}æ§˜ã€å…¥ç¤¾æ—¥ï¼ˆ${data.startDate}ï¼‰ãŒè¿‘ã¥ã„ã¦ãŠã‚Šã¾ã™ã€‚</p>
      <p>æº–å‚™ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ã€‚</p>
    `
  };
  
  return basicTemplates[data.contentType] || basicTemplates.welcome;
}</div>
            
            <div class="warning-box">
                <h4>ğŸš¨ ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾ç­–</h4>
                <ul>
                    <li><strong>ChatGPT APIåˆ¶é™:</strong> åˆ©ç”¨é »åº¦ã®ç›£è¦–ã¨åˆ¶é™è¨­å®š</li>
                    <li><strong>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:</strong> ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ã®å®Ÿè£…</li>
                    <li><strong>JSONè§£æå¤±æ•—:</strong> ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã®äº‹å‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</li>
                    <li><strong>æ¨©é™ã‚¨ãƒ©ãƒ¼:</strong> é©åˆ‡ãªã‚¹ã‚³ãƒ¼ãƒ—è¨­å®šã¨æ¨©é™ç®¡ç†</li>
                </ul>
            </div>
        </div>

        <h2>ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ã¨å…¬é–‹</h2>
        
        <div class="webapp-demo">
            <h3>ğŸ“± WebAppå…¬é–‹æ‰‹é †</h3>
            
            <div class="before-after">
                <div>
                    <h4>ğŸ”§ é–‹ç™ºæ®µéš</h4>
                    <ol>
                        <li>Apps Script ã‚¨ãƒ‡ã‚£ã‚¿ã§ã‚³ãƒ¼ãƒ‰ä½œæˆ</li>
                        <li>HTML ãƒ•ã‚¡ã‚¤ãƒ«ã§UIè¨­è¨ˆ</li>
                        <li>æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°</li>
                        <li>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ç¢ºèª</li>
                    </ol>
                </div>
                <div>
                    <h4>ğŸŒ æœ¬ç•ªå…¬é–‹</h4>
                    <ol>
                        <li><strong>ãƒ‡ãƒ—ãƒ­ã‚¤:</strong> æ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆä½œæˆ</li>
                        <li><strong>æ¨©é™è¨­å®š:</strong> çµ„ç¹”å†…ãƒ¡ãƒ³ãƒãƒ¼ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯</li>
                        <li><strong>URLé…å¸ƒ:</strong> äººäº‹éƒ¨ãƒ¡ãƒ³ãƒãƒ¼ã«å…±æœ‰</li>
                        <li><strong>åˆ©ç”¨é–‹å§‹:</strong> ãƒ–ãƒ©ã‚¦ã‚¶ã§å³åº§ã«åˆ©ç”¨å¯èƒ½</li>
                    </ol>
                </div>
            </div>
            
            <div class="success-tip">
                <strong>ğŸ¯ å…¬é–‹å¾Œã®åŠ¹æœ:</strong> äººäº‹éƒ¨å…¨å“¡ãŒæŠ€è¡“çŸ¥è­˜ãªã—ã§AIæ´»ç”¨ã€‚æ¥­å‹™åŠ¹ç‡ãŒåŠ‡çš„å‘ä¸Šï¼
            </div>
        </div>

        <h2>ğŸ“ˆ æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ</h2>
        
        <div class="highlight-box">
            <h3>ğŸš€ WebAppå°å…¥ã«ã‚ˆã‚‹å¤‰é©</h3>
            <div class="before-after" style="color: #2c3e50;">
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px;">
                    <h4>ğŸ‘¥ åˆ©ç”¨è€…æ‹¡å¤§åŠ¹æœ</h4>
                    <ul>
                        <li>AIåˆ©ç”¨è€…: 1å â†’ äººäº‹éƒ¨å…¨å“¡</li>
                        <li>å­¦ç¿’æ™‚é–“: 1é€±é–“ â†’ 5åˆ†</li>
                        <li>æŠ€è¡“ä¾å­˜: ã‚ã‚Š â†’ ãªã—</li>
                        <li><strong>ãƒãƒ¼ãƒ ç”Ÿç”£æ€§: 5å€å‘ä¸Š</strong></li>
                    </ul>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px;">
                    <h4>ğŸ¯ å“è³ªãƒ»åŠ¹ç‡åŠ¹æœ</h4>
                    <ul>
                        <li>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå“è³ª: ä¸å®‰å®š â†’ ä¸€å®š</li>
                        <li>æ“ä½œæ™‚é–“: 10åˆ† â†’ 30ç§’</li>
                        <li>ã‚¨ãƒ©ãƒ¼ç‡: 20% â†’ 2%</li>
                        <li><strong>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å“è³ª: å¤§å¹…å‘ä¸Š</strong></li>
                    </ul>
                </div>
            </div>
        </div>

        <h2>ğŸ”® æ¬¡å›äºˆå‘Š</h2>
        
        <div class="feature-highlight">
            <h3>å‹•ç”»6: Google APIsçµ±åˆé€£æºï¼è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€å…ƒè‡ªå‹•æ“ä½œ</h3>
            <p>æ§‹ç¯‰ã—ãŸWebAppã‚’åŸºç›¤ã¨ã—ã¦ã€Gmailã€Calendarã€Chatã€Driveãªã©è¤‡æ•°ã®Google APIã‚’é€£æºã•ã›ãŸçµ±åˆè‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚</p>
            
            <div class="success-tip">
                <strong>ğŸ¯ æ¬¡å›ã®å­¦ç¿’å†…å®¹:</strong>
                <ul>
                    <li>Gmail API ã«ã‚ˆã‚‹é«˜åº¦ãªãƒ¡ãƒ¼ãƒ«é…ä¿¡</li>
                    <li>Calendar API ã«ã‚ˆã‚‹è¤‡æ•°äºˆå®šè‡ªå‹•ç™»éŒ²</li>
                    <li>Chat API ã«ã‚ˆã‚‹ãƒªãƒƒãƒé€šçŸ¥é…ä¿¡</li>
                    <li>Drive API ã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ç®¡ç†</li>
                </ul>
            </div>
        </div>

        <div style="text-align: center; margin-top: 40px; padding: 20px; background: #e8f0fe; border-radius: 8px;">
            <h3>ğŸ‰ äººäº‹å°‚ç”¨AI WebAppã€å®Œæˆï¼</h3>
            <p style="font-size: 18px; color: #2c3e50;">æ¬¡å›ã¯ã€ã“ã®åŸºç›¤ã‚’æ´»ç”¨ã—ã¦Google APIçµ±åˆã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚</p>
        </div>
    </div>
</body>
</html>