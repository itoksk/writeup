# 動画7: Google Workspace完結！スプレッドシート自動タスク管理とGoogle Chat部署別リマインド通知システム

**撮影時間**: 10分  
**目標**: Google Workspace統合タスク管理と進捗追跡システムをマスター

---

## 🎬 オープニング（0:00-1:00）

### **セリフ**
「前回、素晴らしいGoogle APIs統合システムができましたが、『あの作業、ちゃんと進んでいるかな？』『期限前にリマインドしたいな』と思いませんでしたか？」

「今回は、Google Workspace完結型のタスク管理システムと、Google Chatによる自動リマインド機能を構築します。外部サービス不要で、タスクの抜け漏れを完全に防ぎます！」

**【画面】**: タスク管理とリマインド通知の完成形

---

## 🎯 タスク管理自動化の価値（1:00-2:00）

### **セリフ**
「なぜタスク管理の自動化が重要なのでしょうか？」

**【画面】**: Before/After比較
- Before: 手動でタスク管理、期限間近になって慌てて確認
- After: 自動タスク生成、期限前自動リマインド、完了状況一元管理

「各部署の準備状況が可視化され、期限前の適切なタイミングで自動リマインド。管理コストゼロで確実な進捗管理を実現します。」

---

## 🏗️ システム設計（2:00-3:00）

### **セリフ**
「今回構築するタスク管理システムの全体設計をご説明します」

**【画面】**: システム構成図
```
新入社員データ（トリガー）
    ↓
タスク自動生成（スプレッドシート）
    ↓
部署別Chat通知（即座）
    ↓
進捗追跡システム（継続監視）
    ↓
自動リマインド（期限前）
    ↓
完了確認・報告（フォローアップ）
```

「データドリブンなタスク管理で、人的な管理コストを削減しながら確実性を向上させます。」

---

## 🛠️ 実装デモ Part1: 自動タスク生成（3:00-4:30）

### **セリフ**
「まず、新入社員情報から必要なタスクを自動生成する仕組みを作ります」

#### **Step 1**: タスク管理シート設計（3:00-3:30）
**【操作・セリフ】**:
1. 新しいスプレッドシート作成: 「タスク管理マスター」
2. ヘッダー設定

**【画面表示】**:
```
A列: 作成日時
B列: 対象者名
C列: 部署
D列: タスク名
E列: 担当部署
F列: 担当者
G列: 優先度
H列: 期限
I列: ステータス
J列: 完了日時
K列: カテゴリ
```

#### **Step 2**: タスク自動生成ロジック（3:30-4:30）
**【コード実演】**:
```javascript
function createEmployeeTasks(employeeData) {
  console.log('タスク生成開始:', employeeData.name);
  
  const taskSheet = getOrCreateTaskSheet();
  const tasks = generateDepartmentTasks(employeeData);
  
  const createdTasks = [];
  
  tasks.forEach(task => {
    const taskRow = [
      new Date(), // 作成日時
      employeeData.name, // 対象者
      employeeData.department, // 部署
      task.title, // タスク名
      task.assignedDept, // 担当部署
      task.assignedPerson, // 担当者
      task.priority, // 優先度
      task.dueDate, // 期限
      '未着手', // ステータス
      '', // 完了日時
      task.category // カテゴリ
    ];
    
    taskSheet.appendRow(taskRow);
    createdTasks.push({...task, row: taskSheet.getLastRow()});
  });
  
  console.log(`タスク${tasks.length}件を生成`);
  return createdTasks;
}

function generateDepartmentTasks(employeeData) {
  const baseTasks = [
    {
      title: 'PC・周辺機器の準備',
      assignedDept: 'IT部門',
      assignedPerson: 'IT管理者',
      priority: '高',
      dueDate: getDateBefore(employeeData.startDate, 3),
      category: 'ハードウェア'
    },
    {
      title: 'アカウント・権限設定',
      assignedDept: 'IT部門', 
      assignedPerson: 'システム管理者',
      priority: '高',
      dueDate: getDateBefore(employeeData.startDate, 2),
      category: 'アカウント'
    },
    {
      title: '座席・デスクの確保',
      assignedDept: '総務部',
      assignedPerson: '総務担当',
      priority: '高',
      dueDate: getDateBefore(employeeData.startDate, 5),
      category: 'オフィス環境'
    },
    {
      title: '名刺・社員証の準備',
      assignedDept: '総務部',
      assignedPerson: '庶務担当',
      priority: '中',
      dueDate: getDateBefore(employeeData.startDate, 1),
      category: '身分証明'
    }
  ];
  
  // 部署固有タスクを追加
  const deptSpecificTasks = getDepartmentSpecificTasks(employeeData);
  
  return [...baseTasks, ...deptSpecificTasks];
}
```

**【セリフ】**: 「入社日から逆算して、適切な期限でタスクが自動生成されました」

---

## 💬 実装デモ Part2: Google Chat通知システム（4:30-6:30）

### **セリフ**
「生成されたタスクを、担当部署に美しいカード形式で通知します」

#### **Step 1**: リッチカード通知設計（4:30-5:30）
**【コード実演】**:
```javascript
function sendDepartmentNotifications(employeeData, tasks) {
  console.log('部署別通知送信中');
  
  const departmentTasks = groupTasksByDepartment(tasks);
  const notifications = [];
  
  Object.keys(departmentTasks).forEach(department => {
    const deptTasks = departmentTasks[department];
    const webhookUrl = getDepartmentWebhook(department);
    
    if (webhookUrl && deptTasks.length > 0) {
      const message = createDepartmentTaskMessage(employeeData, deptTasks, department);
      const result = sendChatMessage(webhookUrl, message);
      
      notifications.push({
        department: department,
        taskCount: deptTasks.length,
        success: result.success
      });
    }
  });
  
  return notifications;
}

function createDepartmentTaskMessage(employeeData, tasks, department) {
  const taskList = tasks.map(task => 
    `• <b>${task.title}</b><br>  担当: ${task.assignedPerson} | 期限: ${formatDate(task.dueDate)} | 優先度: ${task.priority}`
  ).join('<br><br>');
  
  return {
    text: `🆕 新入社員準備のお願い`,
    cards: [{
      header: {
        title: `${department}への新入社員準備依頼`,
        subtitle: `${employeeData.name}様（${employeeData.position}）`,
        imageUrl: 'https://developers.google.com/chat/images/quickstart-app-avatar.png'
      },
      sections: [{
        widgets: [{
          textParagraph: {
            text: `<b>新入社員情報:</b><br>
👤 氏名: ${employeeData.name}<br>
📅 入社日: ${formatDate(employeeData.startDate)}<br>
🏢 部署: ${employeeData.department}<br>
💼 職種: ${employeeData.position}`
          }
        }]
      }, {
        header: `📋 ${department}担当タスク（${tasks.length}件）`,
        widgets: [{
          textParagraph: {
            text: taskList
          }
        }]
      }, {
        widgets: [{
          buttons: [{
            textButton: {
              text: 'タスク管理シートを開く',
              onClick: {
                openLink: {
                  url: getTaskSheetUrl()
                }
              }
            }
          }, {
            textButton: {
              text: '人事部に質問',
              onClick: {
                openLink: {
                  url: 'mailto:hr@company.com?subject=新入社員準備について'
                }
              }
            }
          }]
        }]
      }]
    }]
  };
}
```

#### **Step 2**: 通知送信実演（5:30-6:30）
**【セリフ・操作】**:
1. 「実際にChat通知を送信してみましょう」
2. 関数実行
3. Google Chatで結果確認
4. 「IT部門と総務部に、美しいカード形式で通知が配信されました！」

**【セリフ】**: 「必要な情報が整理され、アクションボタンも含まれているので、担当者はすぐに行動を開始できます」

---

## ⏰ 実装デモ Part3: 自動リマインドシステム（6:30-8:00）

### **セリフ**
「タスクを作るだけでは不十分。期限前の自動リマインドで確実な実行を担保します」

#### **Step 1**: 時間ベーストリガー設定（6:30-7:00）
**【コード実演】**:
```javascript
function setupProgressTracking(employeeData, tasks) {
  console.log('進捗追跡設定中');
  
  try {
    // 毎日朝9時に実行するリマインダートリガー
    ScriptApp.newTrigger('sendTaskReminders')
      .timeBased()
      .everyDays(1)
      .atHour(9)
      .create();
    
    // 入社3日後の完了確認トリガー
    const followUpDate = getDateAfter(employeeData.startDate, 3);
    
    ScriptApp.newTrigger('checkTaskCompletion')
      .timeBased()
      .at(followUpDate)
      .create();
    
    console.log('進捗追跡設定完了');
    
  } catch (error) {
    console.error('進捗追跡設定エラー:', error);
  }
}
```

#### **Step 2**: リマインダー送信ロジック（7:00-8:00）
**【コード実演】**:
```javascript
function sendTaskReminders() {
  console.log('タスクリマインダー送信中');
  
  const taskSheet = getOrCreateTaskSheet();
  const data = taskSheet.getDataRange().getValues();
  
  const today = new Date();
  const tomorrow = new Date(today);
  tomorrow.setDate(today.getDate() + 1);
  
  // 明日が期限のタスクを抽出
  const urgentTasks = data.slice(1).filter(row => {
    const dueDate = new Date(row[7]); // 期限列
    const status = row[8]; // ステータス列
    return dueDate.toDateString() === tomorrow.toDateString() && status !== '完了';
  });
  
  if (urgentTasks.length > 0) {
    const groupedTasks = groupTasksByDepartment(urgentTasks.map(row => ({
      assignedDept: row[4],
      title: row[3],
      assignedPerson: row[5],
      priority: row[6],
      dueDate: row[7]
    })));
    
    Object.keys(groupedTasks).forEach(dept => {
      const webhookUrl = getDepartmentWebhook(dept);
      if (webhookUrl) {
        const reminderMessage = createReminderMessage(groupedTasks[dept], dept);
        sendChatMessage(webhookUrl, reminderMessage);
        console.log(`${dept}にリマインダー送信`);
      }
    });
  }
}

function createReminderMessage(tasks, department) {
  const taskList = tasks.map(task => 
    `🔥 <b>${task.title}</b> - ${task.assignedPerson}（明日期限）`
  ).join('<br>');
  
  return {
    text: `⚠️ 明日期限のタスクリマインダー`,
    cards: [{
      header: {
        title: `${department} - 明日期限タスク`,
        subtitle: `${tasks.length}件のタスクが明日期限です`,
        imageUrl: 'https://developers.google.com/chat/images/quickstart-app-avatar.png'
      },
      sections: [{
        widgets: [{
          textParagraph: {
            text: taskList
          }
        }]
      }, {
        widgets: [{
          buttons: [{
            textButton: {
              text: 'タスクシートで確認',
              onClick: {
                openLink: {
                  url: getTaskSheetUrl()
                }
              }
            }
          }]
        }]
      }]
    }]
  };
}
```

**【セリフ】**: 「これで、期限前日に自動的にリマインダーが送信されます。もう忘れる心配はありません」

---

## 📊 実装デモ Part4: 完了確認・報告（8:00-8:45）

### **セリフ**
「最後に、タスク完了状況の確認と人事部への報告機能を実装します」

#### **完了確認システム**
**【コード実演】**:
```javascript
function checkTaskCompletion() {
  console.log('タスク完了確認中');
  
  const taskSheet = getOrCreateTaskSheet();
  const data = taskSheet.getDataRange().getValues();
  
  // 未完了タスクを確認
  const incompleteTasks = data.slice(1).filter(row => {
    const status = row[8]; // ステータス列
    const dueDate = new Date(row[7]); // 期限列
    return status !== '完了' && dueDate < new Date();
  });
  
  if (incompleteTasks.length > 0) {
    // 人事部に未完了タスク報告
    const hrWebhook = getDepartmentWebhook('人事部');
    if (hrWebhook) {
      const completionReport = createCompletionReport(incompleteTasks);
      sendChatMessage(hrWebhook, completionReport);
    }
  }
}

function createCompletionReport(incompleteTasks) {
  const taskSummary = incompleteTasks.map(row => 
    `• ${row[1]}様 - ${row[3]} (${row[4]}担当)`
  ).join('<br>');
  
  return {
    text: `📋 入社準備進捗レポート`,
    cards: [{
      header: {
        title: '未完了タスクの確認',
        subtitle: `${incompleteTasks.length}件のタスクが期限を過ぎています`
      },
      sections: [{
        widgets: [{
          textParagraph: {
            text: `<b>未完了タスク:</b><br><br>${taskSummary}`
          }
        }]
      }, {
        widgets: [{
          buttons: [{
            textButton: {
              text: '詳細確認',
              onClick: {
                openLink: {
                  url: getTaskSheetUrl()
                }
              }
            }
          }]
        }]
      }]
    }]
  };
}
```

**【セリフ】**: 「期限を過ぎた未完了タスクは人事部に自動報告。適切なフォローアップが可能になります」

---

## 🎯 統合テスト（8:45-9:15）

### **セリフ**
「完成したタスク管理システムを通しでテストしてみましょう！」

#### **実演**
**【操作・セリフ】**:
1. **新入社員データ投入**: 「田中次郎さん（営業部・営業担当）のデータでテスト」
2. **タスク自動生成**: 「8つのタスクが自動生成されました」
3. **Chat通知確認**: 「IT部門と総務部に通知が配信されています」
4. **リマインダーテスト**: 「明日期限のタスクに対するリマインダー送信」
5. **完了状況確認**: 「未完了タスクの人事部への報告」

**【セリフ】**: 「わずか数秒で、包括的なタスク管理システムが稼働開始しました！」

---

## 🎯 まとめ・次回予告（9:15-10:00）

### **セリフ**
「今日学んだこと」
- スプレッドシートベースのタスク自動生成
- Google Chat リッチカード通知
- 時間ベーストリガーによる自動リマインド
- 完了状況の可視化と報告

**【実現できたこと】**:
- タスクの抜け漏れゼロ
- 部署間連携の円滑化
- 進捗の可視化
- 管理コストの削減

**【次回予告】**:
「いよいよ最終回です！入社日をトリガーにしたGoogleカレンダー自動登録と、AI人事執事システムの完全完成をお見せします。全ての機能が統合された、真の『手作業ゼロ』システムの完成です！」

---

## 🎥 撮影メモ

### **画面構成**
- **メイン**: Apps Script エディタ
- **サブ**: スプレッドシート（タスク管理）
- **通知確認**: Google Chat画面

### **デモのポイント**
1. **タスク生成**: 自動生成の様子
2. **通知送信**: Chat通知の美しさ
3. **リマインダー**: タイムリーな通知
4. **進捗管理**: 可視化された状況

### **強調ポイント**
- 自動化の包括性
- 美しいUI/UX
- 確実性の担保
- 運用の簡単さ

このシステムにより、タスク管理の完全自動化が実現し、次の最終回への準備が整います。