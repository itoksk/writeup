# 動画8: 入社日をトリガーにGoogleカレンダーへ自動登録！AI人事を完成させ、手作業をゼロにする方法

**撮影時間**: 10分  
**目標**: 時間ベーストリガーによる完全自動化システムの完成とシリーズ総括

---

## 🎬 オープニング（0:00-1:00）

### **セリフ**
「ついに最終回です！これまで7回にわたって、Google Workspace完結型の自動化システムを構築してきました。今回は、その集大成として『時間』をトリガーにした完全自動化システムを完成させます。」

「入社日をトリガーに、事前準備から当日の対応、そして入社後のフォローアップまで。真の『AI人事執事』がついに完成します！」

**【画面】**: これまでの機能が時系列で動作する完成形イメージ

---

## 🎯 時間ベース自動化の価値（1:00-2:00）

### **セリフ**
「なぜ時間ベースの自動化が重要なのでしょうか？」

**【画面】**: タイムライン表示
- 1週間前: 準備確認通知
- 3日前: 最終準備リマインド
- 入社日: ウェルカムイベント自動実行
- 1週間後: フォローアップ面談
- 1ヶ月後: 定着度確認

**【セリフ】**: 「人事担当者が覚えていなくても、システムが適切なタイミングで自動実行。もう『忘れていた！』ということはありません。」

---

## 🏗️ 時間ベースシステム設計（2:00-3:00）

### **セリフ**
「今回の時間ベース自動化システムの全体設計をご説明します」

**【画面】**: システム構成図
```
日次実行トリガー（毎朝8時）
    ↓
入社日チェック処理
    ├→ 今日入社者の処理
    ├→ 入社予定者の事前処理
    └→ 入社後フォローアップ
    
各処理から
    ├→ カレンダーイベント作成
    ├→ メール自動送信
    ├→ Chat通知配信
    └→ 処理ログ記録
```

**【セリフ】**: 「毎日自動実行され、その日に必要な処理を自動判定・実行。完全に『手放し』で運用できます。」

---

## 🛠️ 実装デモ Part1: 日次チェック処理（3:00-4:30）

### **セリフ**
「まず、毎日実行される入社日チェック処理を実装します」

#### **Step 1**: メイン処理関数（3:00-3:45）
**【コード実演】**:
```javascript
function dailyEmployeeCheck() {
  console.log('=== 日次入社日チェック開始 ===');
  
  try {
    const today = new Date();
    
    // 1. 今日入社の社員をチェック
    const newEmployeesToday = checkTodayNewEmployees(today);
    
    // 2. 入社予定者の事前準備チェック
    const upcomingEmployees = checkUpcomingEmployees(today);
    
    // 3. 入社後フォローアップが必要な社員
    const followUpEmployees = checkFollowUpRequired(today);
    
    // 4. 各種自動処理実行
    processNewEmployees(newEmployeesToday);
    processUpcomingReminders(upcomingEmployees);
    processFollowUps(followUpEmployees);
    
    // 5. 処理結果をレポート
    generateDailyReport(newEmployeesToday, upcomingEmployees, followUpEmployees);
    
    console.log('=== 日次処理完了 ===');
    
  } catch (error) {
    console.error('日次処理エラー:', error);
    sendErrorNotification(error);
  }
}
```

#### **Step 2**: 入社日チェックロジック（3:45-4:30）
**【コード実演】**:
```javascript
function checkTodayNewEmployees(today) {
  console.log('今日入社の社員チェック中');
  
  const employeeSheet = SpreadsheetApp.getActiveSheet();
  const data = employeeSheet.getDataRange().getValues();
  
  const todayEmployees = [];
  
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const startDate = new Date(row[3]); // 入社日列
    
    if (isSameDate(startDate, today)) {
      const employee = {
        name: row[1],
        email: row[2],
        startDate: startDate,
        department: row[4],
        position: row[5],
        employmentType: row[6],
        rowIndex: i + 1,
        isNewEmployeeToday: true
      };
      
      todayEmployees.push(employee);
    }
  }
  
  console.log(`今日入社: ${todayEmployees.length}名`);
  return todayEmployees;
}

function checkUpcomingEmployees(today) {
  const employeeSheet = SpreadsheetApp.getActiveSheet();
  const data = employeeSheet.getDataRange().getValues();
  const upcomingEmployees = [];
  
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const startDate = new Date(row[3]);
    const daysDiff = Math.ceil((startDate - today) / (1000 * 60 * 60 * 24));
    
    // 1週間前、3日前、1日前にチェック
    if ([7, 3, 1].includes(daysDiff)) {
      upcomingEmployees.push({
        name: row[1],
        email: row[2],
        startDate: startDate,
        department: row[4],
        position: row[5],
        daysUntilStart: daysDiff
      });
    }
  }
  
  return upcomingEmployees;
}
```

**【セリフ】**: 「入社日との日数差を自動計算し、適切なタイミングで処理を実行します」

---

## ⚡ 実装デモ Part2: ウェルカムイベント自動作成（4:30-6:00）

### **セリフ**
「今日入社の方には、自動的にウェルカムイベントを作成します」

#### **Step 1**: 複数イベント自動生成（4:30-5:30）
**【コード実演】**:
```javascript
function processNewEmployees(employees) {
  console.log('新入社員自動処理実行中');
  
  employees.forEach(employee => {
    try {
      // 1. ウェルカムイベント作成
      createWelcomeEvents(employee);
      
      // 2. 歓迎メール送信（既存の関数を利用）
      generateAndSendWelcomeEmail(employee);
      
      // 3. 部署通知送信
      notifyDepartmentOfArrival(employee);
      
      // 4. 初日スケジュール自動生成
      createFirstDaySchedule(employee);
      
      // 5. 処理ステータス更新
      updateEmployeeStatus(employee, '入社日処理完了');
      
      console.log(`✅ ${employee.name}さんの入社日処理完了`);
      
    } catch (error) {
      console.error(`${employee.name}さんの処理エラー:`, error);
      updateEmployeeStatus(employee, `処理エラー: ${error.message}`);
    }
  });
}

function createWelcomeEvents(employee) {
  console.log('ウェルカムイベント作成:', employee.name);
  
  const events = [
    // 1. 朝のウェルカム面談（9:00-10:00）
    {
      summary: `【ウェルカム面談】${employee.name}さん`,
      start: getTimeSlot(employee.startDate, 9, 0),
      end: getTimeSlot(employee.startDate, 10, 0),
      attendees: [
        employee.email,
        'hr@company.com',
        getDepartmentManager(employee.department).email
      ],
      description: `新入社員ウェルカム面談

🎯 アジェンダ:
• 会社概要・企業理念の説明
• 就業規則・福利厚生の確認
• 初日スケジュールの説明
• 質問対応

📋 自動生成: Google Apps Script`,
      conferenceData: {
        createRequest: {
          requestId: `welcome-${employee.name}-${Date.now()}`
        }
      }
    },
    
    // 2. 部署オリエンテーション（14:00-15:30）
    {
      summary: `${employee.department} オリエンテーション - ${employee.name}さん`,
      start: getTimeSlot(employee.startDate, 14, 0),
      end: getTimeSlot(employee.startDate, 15, 30),
      attendees: [
        employee.email,
        ...getDepartmentMembers(employee.department).map(m => m.email)
      ],
      description: `部署オリエンテーション

🎯 内容:
• チーム紹介
• 業務概要説明
• 今後のスケジュール
• 質疑応答`,
      location: `${employee.department}会議室`
    },
    
    // 3. ウェルカムランチ（12:00-13:30）
    {
      summary: `🍽️ ${employee.name}さん ウェルカムランチ`,
      start: getTimeSlot(employee.startDate, 12, 0),
      end: getTimeSlot(employee.startDate, 13, 30),
      attendees: [
        employee.email,
        getDepartmentManager(employee.department).email,
        'hr@company.com'
      ],
      description: `歓迎ランチ会

新しい職場での第一印象を大切に、
リラックスした雰囲気で交流を深めましょう。

💰 経費: 会社負担
📍 場所: 社員食堂 または 近隣レストラン`,
      location: '社員食堂 または 近隣レストラン'
    }
  ];
  
  // イベント作成実行
  events.forEach(eventData => {
    try {
      const event = Calendar.Events.insert(eventData, 'primary');
      console.log(`📅 イベント作成成功: ${event.summary}`);
    } catch (error) {
      console.error(`イベント作成失敗: ${eventData.summary}`, error);
    }
  });
}
```

#### **Step 2**: 初日スケジュール詳細作成（5:30-6:00）
**【コード実演】**:
```javascript
function createFirstDaySchedule(employee) {
  console.log('初日スケジュール作成:', employee.name);
  
  const schedule = [
    { time: '9:00-9:30', activity: '受付・入社手続き', location: '1F受付' },
    { time: '9:30-10:00', activity: 'ウェルカム面談', location: '人事部会議室' },
    { time: '10:00-10:30', activity: 'PC・備品受け取り', location: 'IT部門' },
    { time: '10:30-11:30', activity: '社内ツール設定', location: '自席' },
    { time: '11:30-12:00', activity: '安全衛生説明', location: '総務部' },
    { time: '12:00-13:30', activity: 'ウェルカムランチ', location: '社員食堂' },
    { time: '13:30-14:00', activity: '自席案内・環境設定', location: employee.department },
    { time: '14:00-15:30', activity: '部署オリエンテーション', location: `${employee.department}会議室` },
    { time: '15:30-16:30', activity: '業務システム説明', location: '自席' },
    { time: '16:30-17:30', activity: '初日振り返り面談', location: '人事部' }
  ];
  
  // Googleスプレッドシートに初日スケジュール保存
  const scheduleSheet = getOrCreateScheduleSheet();
  
  schedule.forEach(item => {
    scheduleSheet.appendRow([
      employee.name,
      employee.startDate,
      item.time,
      item.activity,
      item.location,
      '予定',
      new Date()
    ]);
  });
  
  // スケジュール確認メール送信
  const scheduleHtml = createScheduleEmailContent(employee, schedule);
  sendScheduleConfirmationEmail(employee, scheduleHtml);
}
```

**【セリフ】**: 「初日の詳細スケジュールまで自動生成。新入社員は安心して初日を迎えられます」

---

## 📅 実装デモ Part3: フォローアップシステム（6:00-7:30）

### **セリフ**
「入社後のフォローアップも自動化します。1週間後、1ヶ月後、3ヶ月後の定期的な確認面談を自動設定」

#### **Step 1**: フォローアップ判定（6:00-6:45）
**【コード実演】**:
```javascript
function checkFollowUpRequired(today) {
  console.log('フォローアップ対象者チェック中');
  
  const employeeSheet = SpreadsheetApp.getActiveSheet();
  const data = employeeSheet.getDataRange().getValues();
  const followUpEmployees = [];
  
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const startDate = new Date(row[3]);
    const daysSinceStart = Math.ceil((today - startDate) / (1000 * 60 * 60 * 24));
    
    // 入社後1週間、1ヶ月、3ヶ月にフォローアップ
    if ([7, 30, 90].includes(daysSinceStart) && startDate <= today) {
      const employee = {
        name: row[1],
        email: row[2],
        startDate: startDate,
        department: row[4],
        position: row[5],
        daysSinceStart: daysSinceStart,
        followUpType: daysSinceStart === 7 ? '1週間後' : daysSinceStart === 30 ? '1ヶ月後' : '3ヶ月後'
      };
      
      followUpEmployees.push(employee);
    }
  }
  
  console.log(`フォローアップ対象: ${followUpEmployees.length}名`);
  return followUpEmployees;
}
```

#### **Step 2**: フォローアップ実行（6:45-7:30）
**【コード実演】**:
```javascript
function processFollowUps(employees) {
  console.log('フォローアップ処理中');
  
  employees.forEach(employee => {
    try {
      if (employee.followUpType === '1週間後') {
        // 1週間後フォローアップ
        createWeeklyFollowUpMeeting(employee);
        sendWeeklyCheckEmail(employee);
        
      } else if (employee.followUpType === '1ヶ月後') {
        // 1ヶ月後フォローアップ
        createMonthlyReviewMeeting(employee);
        sendMonthlyFeedbackRequest(employee);
        
      } else if (employee.followUpType === '3ヶ月後') {
        // 3ヶ月後フォローアップ
        createQuarterlyEvaluation(employee);
        sendQuarterlyReviewInvitation(employee);
      }
      
      console.log(`✅ ${employee.name}さんの${employee.followUpType}フォローアップ完了`);
      
    } catch (error) {
      console.error(`${employee.name}さんのフォローアップエラー:`, error);
    }
  });
}

function createWeeklyFollowUpMeeting(employee) {
  const meetingDate = new Date();
  meetingDate.setHours(16, 0, 0, 0); // 今日の16:00
  
  const meetingEnd = new Date(meetingDate);
  meetingEnd.setHours(16, 30, 0, 0);
  
  const event = {
    summary: `【1週間フォローアップ】${employee.name}さん`,
    start: { dateTime: meetingDate.toISOString() },
    end: { dateTime: meetingEnd.toISOString() },
    description: `入社1週間後のフォローアップミーティング

📋 確認事項:
• 業務理解度
• 職場適応状況
• 困っていること
• サポートが必要な点
• 今後の目標設定

🤖 自動生成: Google Apps Script`,
    attendees: [
      { email: employee.email },
      { email: getDepartmentManager(employee.department).email },
      { email: 'hr@company.com' }
    ]
  };
  
  Calendar.Events.insert(event, 'primary');
  console.log(`📅 1週間フォローアップ作成: ${employee.name}`);
}
```

**【セリフ】**: 「入社からの経過日数を自動計算し、適切なタイミングでフォローアップを実行。定着率向上に貢献します」

---

## 🔧 実装デモ Part4: トリガー設定と統合テスト（7:30-8:30）

### **セリフ**
「システムの心臓部、時間ベーストリガーを設定します」

#### **Step 1**: トリガー設定（7:30-8:00）
**【コード実演】**:
```javascript
function setupDailyTriggers() {
  console.log('日次トリガー設定中');
  
  // 既存のトリガーを削除（重複防止）
  const triggers = ScriptApp.getProjectTriggers();
  triggers.forEach(trigger => {
    if (trigger.getHandlerFunction() === 'dailyEmployeeCheck') {
      ScriptApp.deleteTrigger(trigger);
    }
  });
  
  // 新しいトリガーを設定（毎日朝8時）
  ScriptApp.newTrigger('dailyEmployeeCheck')
    .timeBased()
    .everyDays(1)
    .atHour(8)
    .create();
  
  console.log('✅ 日次トリガー設定完了');
}
```

#### **Step 2**: 統合テスト実行（8:00-8:30）
**【セリフ・操作】**:
1. **テストデータ準備**: 「今日入社、3日前、1週間後のデータを用意」
2. **手動実行**: 「dailyEmployeeCheck関数を手動実行」
3. **結果確認**:
   - カレンダーイベント作成確認
   - メール送信確認
   - Chat通知確認
   - スプレッドシート更新確認

**【セリフ】**: 「完璧に動作しています！これで真の自動化システムが完成しました」

---

## 🎉 シリーズ総括（8:30-9:30）

### **セリフ**
「8回のシリーズを通して、私たちは素晴らしいシステムを構築しました。振り返ってみましょう」

#### **構築した機能**
**【画面】**: 全機能の一覧表示
1. **動画1**: Google完結型アーキテクチャの威力体感
2. **動画2**: 統合フロー設計図の作成
3. **動画3**: Googleフォーム自動反映システム
4. **動画4**: ChatGPT AI歓迎メール生成
5. **動画5**: 人事専用AI WebApp開発
6. **動画6**: Google APIs統合連携
7. **動画7**: タスク管理・Chat通知システム
8. **動画8**: 時間ベース完全自動化

#### **達成した成果**
**【画面】**: 効果数値表示
- **工数削減**: 月20時間 → 月1時間（95%削減）
- **コスト削減**: 月額$86 → 月額$10（88%削減）
- **精度向上**: 人的ミス5% → システムエラー0%
- **速度向上**: 1件20分 → 1件30秒（40倍高速）

**【セリフ】**: 「これらの数値以上に価値があるのは、皆さんが創造的な人事業務に集中できるようになったことです」

---

## 🎯 最終メッセージ（9:30-10:00）

### **セリフ**
「皆さん、本当にお疲れ様でした。」

**【画面】**: 完成したシステムが動作する様子

「今日完成したのは、単なる自動化ツールではありません。これは、人事業務の未来を変える『AI人事執事』です。」

**【今後の可能性】**:
- 他の人事業務への横展開
- 他部署での同様システム構築
- より高度なAI機能の追加
- 会社全体のDX推進

**【セリフ（最後）】**:
「Google Workspace完結型アプローチで、安全で、経済的で、拡張性の高いシステムを手に入れました。これを機に、皆さんの会社でも真のデジタル変革を実現してください。」

「それでは、AI人事執事と共に、素晴らしい人事業務の未来を創っていきましょう！」

**【画面】**: エンドロール（完成したシステムの動作ダイジェスト）

---

## 🎥 撮影メモ

### **画面構成**
- **メイン**: Apps Script エディタ
- **サブ**: カレンダー、Gmail、Chat等の結果確認
- **総括**: 全機能の動作を順番に表示

### **デモのポイント**
1. **時間ベース処理**: 自動判定・実行の様子
2. **統合テスト**: 全機能の協調動作
3. **シリーズ振り返り**: 成果の可視化
4. **未来への展望**: 拡張性の示唆

### **エモーショナルポイント**
- 達成感の演出
- 学習の振り返り
- 未来への希望
- 感謝の気持ち

この最終回により、シリーズ全体が美しく完結し、受講者に大きな満足感と達成感を提供します。