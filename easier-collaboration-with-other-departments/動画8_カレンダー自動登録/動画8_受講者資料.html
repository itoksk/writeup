<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•ç”»8: å…¥ç¤¾æ—¥ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸è‡ªå‹•ç™»éŒ²ï¼AIäººäº‹åŸ·äº‹ã‚’å®Œæˆã•ã›ã€æ‰‹ä½œæ¥­ã‚’ã‚¼ãƒ­ã«ã™ã‚‹æ–¹æ³•</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #4285f4;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            border-left: 5px solid #4285f4;
            padding-left: 15px;
            margin-top: 40px;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .final-system {
            background-color: #e8f0fe;
            border: 2px solid #4285f4;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .before {
            background-color: #ffebee;
            border-left: 5px solid #f44336;
            padding: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .after {
            background-color: #e8f5e8;
            border-left: 5px solid #4caf50;
            padding: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .time-trigger {
            background-color: #fff3e0;
            border: 2px solid #ff9800;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .calendar-integration {
            background-color: #f3e5f5;
            border: 2px solid #9c27b0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .ai-butler {
            background-color: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .timeline {
            position: relative;
            margin: 30px 0;
        }
        
        .timeline-item {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-left: 4px solid #4285f4;
            border-radius: 0 8px 8px 0;
            position: relative;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 25px;
            width: 12px;
            height: 12px;
            background: #4285f4;
            border-radius: 50%;
        }
        
        .feature-highlight {
            background: linear-gradient(90deg, #e8f0fe 0%, #f3e5f5 100%);
            border-left: 5px solid #4285f4;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .success-tip {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .flow-diagram {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .achievement-card {
            background: #f8f9fa;
            border: 2px solid #4285f4;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        
        .achievement-card h4 {
            color: #4285f4;
            margin-top: 0;
        }
        
        .metrics-showcase {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
        }
        
        .final-celebration {
            background: linear-gradient(135deg, #ff9a56 0%, #ff6b35 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .before-after, .achievements-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‰ AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ å®Œæˆï¼æ™‚é–“ãƒ™ãƒ¼ã‚¹å®Œå…¨è‡ªå‹•åŒ–ã®é›†å¤§æˆ</h1>
        
        <div class="highlight-box">
            <h2 style="border: none; color: white; margin-top: 0;">ğŸ¯ æœ€çµ‚å›ã§å®Œæˆã•ã›ã‚‹ã“ã¨</h2>
            <ul>
                <li>æ™‚é–“ãƒ™ãƒ¼ã‚¹ãƒˆãƒªã‚¬ãƒ¼ã«ã‚ˆã‚‹å®Œå…¨è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ </li>
                <li>å…¥ç¤¾æ—¥ã‚’ã‚­ãƒ¼ã¨ã—ãŸGoogleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è‡ªå‹•ç™»éŒ²</li>
                <li>ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ ã®è‡ªå‹•å®Ÿè¡Œ</li>
                <li>AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ ã®é‹ç”¨é–‹å§‹ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</li>
            </ul>
        </div>

        <h2>ğŸš€ æ™‚é–“ãƒ™ãƒ¼ã‚¹è‡ªå‹•åŒ–ã®é©å‘½çš„ä¾¡å€¤</h2>
        
        <div class="before-after">
            <div class="before">
                <h3>âŒ å¾“æ¥ã®äººäº‹æ¥­å‹™</h3>
                <ul>
                    <li><strong>è¨˜æ†¶ä¾å­˜:</strong> ã€Œå…¥ç¤¾æ—¥ã®æº–å‚™ã€å¿˜ã‚Œã¦ãŸï¼ã€</li>
                    <li><strong>æ‰‹å‹•å®Ÿè¡Œ:</strong> æ¯å›æ‰‹å‹•ã§ãƒ¡ãƒ¼ãƒ«ãƒ»ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æ“ä½œ</li>
                    <li><strong>ã‚¿ã‚¤ãƒŸãƒ³ã‚°å•é¡Œ:</strong> é©åˆ‡ãªæ™‚æœŸã®åˆ¤æ–­ãŒå›°é›£</li>
                    <li><strong>ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—æ¼ã‚Œ:</strong> å…¥ç¤¾å¾Œã®ç¢ºèªã‚’å¿˜ã‚ŒãŒã¡</li>
                    <li><strong>å±äººåŒ–:</strong> æ‹…å½“è€…ä¸åœ¨æ™‚ã®å¯¾å¿œä¸å¯</li>
                </ul>
            </div>
            
            <div class="after">
                <h3>âœ… AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ </h3>
                <ul>
                    <li><strong>è‡ªå‹•è¨˜æ†¶:</strong> ã‚·ã‚¹ãƒ†ãƒ ãŒå…¨ã¦ã®æ—¥ç¨‹ã‚’ç®¡ç†</li>
                    <li><strong>è‡ªå‹•å®Ÿè¡Œ:</strong> é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è‡ªå‹•å‡¦ç†</li>
                    <li><strong>æœ€é©ã‚¿ã‚¤ãƒŸãƒ³ã‚°:</strong> AIãŒæœ€é©ãªå®Ÿè¡Œæ™‚æœŸã‚’åˆ¤å®š</li>
                    <li><strong>ç¢ºå®Ÿãƒ•ã‚©ãƒ­ãƒ¼:</strong> 1é€±é–“å¾Œã€1ãƒ¶æœˆå¾Œã‚‚è‡ªå‹•å®Ÿè¡Œ</li>
                    <li><strong>ã‚·ã‚¹ãƒ†ãƒ åŒ–:</strong> 24æ™‚é–“365æ—¥ç¨¼åƒã®ä¿¡é ¼æ€§</li>
                </ul>
            </div>
        </div>

        <h2>ğŸ—ï¸ å®Œæˆã‚·ã‚¹ãƒ†ãƒ å…¨ä½“è¨­è¨ˆ</h2>
        
        <div class="flow-diagram">
            <h3>ğŸ¤– AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ å®Œå…¨ç‰ˆ</h3>
            <div class="code-block" style="text-align: left;">
æ—¥æ¬¡å®Ÿè¡Œãƒˆãƒªã‚¬ãƒ¼ï¼ˆæ¯æœ8æ™‚ï¼‰
        â†“
å…¥ç¤¾æ—¥ãƒã‚§ãƒƒã‚¯å‡¦ç†
    â”œâ†’ ä»Šæ—¥å…¥ç¤¾è€…ã®å‡¦ç†
    â”‚   â”œâ†’ ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒ¼ãƒ«ï¼ˆAIç”Ÿæˆï¼‰
    â”‚   â”œâ†’ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ
    â”‚   â”œâ†’ éƒ¨ç½²é€šçŸ¥é€ä¿¡
    â”‚   â”œâ†’ ã‚¿ã‚¹ã‚¯è‡ªå‹•ç”Ÿæˆ
    â”‚   â””â†’ å€‹äººãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
    â”‚
    â”œâ†’ å…¥ç¤¾äºˆå®šè€…ã®äº‹å‰å‡¦ç†
    â”‚   â”œâ†’ 1é€±é–“å‰ï¼šäº‹å‰æº–å‚™é€šçŸ¥
    â”‚   â”œâ†’ 3æ—¥å‰ï¼šæœ€çµ‚ç¢ºèªãƒªãƒã‚¤ãƒ³ãƒ‰
    â”‚   â””â†’ 1æ—¥å‰ï¼šæ˜æ—¥æº–å‚™å®Œäº†ç¢ºèª
    â”‚
    â””â†’ å…¥ç¤¾å¾Œãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
        â”œâ†’ 1é€±é–“å¾Œï¼šé©å¿œçŠ¶æ³ç¢ºèª
        â”œâ†’ 1ãƒ¶æœˆå¾Œï¼šå®šç€åº¦é¢è«‡è¨­å®š
        â””â†’ 3ãƒ¶æœˆå¾Œï¼šè©•ä¾¡é¢è«‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°
        
â€» å…¨å‡¦ç†ãŒä¸¦è¡Œå®Ÿè¡Œã€ã‚¨ãƒ©ãƒ¼æ™‚ã¯è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
</div>
            <p><strong>ğŸ¯ æœ€çµ‚å½¢ã®ç‰¹å¾´ï¼š</strong> äººé–“ã®é–¢ä¸ãªã—ã«ã€æ–°å…¥ç¤¾å“¡ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å…¨ä½“ã‚’è‡ªå‹•ã‚µãƒãƒ¼ãƒˆ</p>
        </div>

        <h2>â° æ™‚é–“ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…</h2>
        
        <div class="time-trigger">
            <h3>ğŸ• æ—¥æ¬¡è‡ªå‹•å®Ÿè¡Œã‚·ã‚¹ãƒ†ãƒ </h3>
            
            <h4>Step 1: ãƒ¡ã‚¤ãƒ³æ—¥æ¬¡å‡¦ç†é–¢æ•°</h4>
            <div class="code-block">
function dailyEmployeeCheck() {
  console.log('=== æ—¥æ¬¡å…¥ç¤¾æ—¥ãƒã‚§ãƒƒã‚¯é–‹å§‹ ===');
  
  try {
    const today = new Date();
    console.log(`å®Ÿè¡Œæ—¥: ${Utilities.formatDate(today, 'JST', 'yyyyå¹´MMæœˆddæ—¥')}`);
    
    // 1. ä»Šæ—¥å…¥ç¤¾ã®ç¤¾å“¡ã‚’ãƒã‚§ãƒƒã‚¯
    const newEmployeesToday = checkTodayNewEmployees(today);
    
    // 2. å…¥ç¤¾äºˆå®šè€…ã®äº‹å‰æº–å‚™ãƒã‚§ãƒƒã‚¯
    const upcomingEmployees = checkUpcomingEmployees(today);
    
    // 3. å…¥ç¤¾å¾Œãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãŒå¿…è¦ãªç¤¾å“¡
    const followUpEmployees = checkFollowUpRequired(today);
    
    // 4. å„ç¨®è‡ªå‹•å‡¦ç†å®Ÿè¡Œï¼ˆä¸¦è¡Œå‡¦ç†ï¼‰
    const results = {
      newEmployees: processNewEmployees(newEmployeesToday),
      upcomingReminders: processUpcomingReminders(upcomingEmployees),
      followUps: processFollowUps(followUpEmployees)
    };
    
    // 5. å‡¦ç†çµæœã‚’ãƒ¬ãƒãƒ¼ãƒˆ
    const report = generateDailyReport(results, today);
    sendDailyReportToHR(report);
    
    console.log('=== æ—¥æ¬¡å‡¦ç†å®Œäº† ===');
    return { success: true, results: results };
    
  } catch (error) {
    console.error('æ—¥æ¬¡å‡¦ç†ã‚¨ãƒ©ãƒ¼:', error);
    sendErrorNotification(error);
    return { success: false, error: error.message };
  }
}

function checkTodayNewEmployees(today) {
  console.log('ä»Šæ—¥å…¥ç¤¾ã®ç¤¾å“¡ãƒã‚§ãƒƒã‚¯ä¸­');
  
  const employeeSheet = SpreadsheetApp.getActiveSheet();
  const data = employeeSheet.getDataRange().getValues();
  
  const todayEmployees = [];
  
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const startDate = new Date(row[3]); // å…¥ç¤¾æ—¥åˆ—
    
    if (isSameDate(startDate, today)) {
      const employee = {
        name: row[1],
        email: row[2],
        startDate: startDate,
        department: row[4],
        position: row[5],
        employmentType: row[6],
        rowIndex: i + 1,
        isNewEmployeeToday: true
      };
      
      todayEmployees.push(employee);
    }
  }
  
  console.log(`ä»Šæ—¥å…¥ç¤¾: ${todayEmployees.length}å`);
  return todayEmployees;
}</div>
            
            <h4>Step 2: å…¥ç¤¾å‰æ®µéšçš„æº–å‚™ã‚·ã‚¹ãƒ†ãƒ </h4>
            <div class="code-block">
function checkUpcomingEmployees(today) {
  console.log('å…¥ç¤¾äºˆå®šè€…ãƒã‚§ãƒƒã‚¯ä¸­');
  
  const employeeSheet = SpreadsheetApp.getActiveSheet();
  const data = employeeSheet.getDataRange().getValues();
  const upcomingEmployees = [];
  
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const startDate = new Date(row[3]);
    const daysDiff = Math.ceil((startDate - today) / (1000 * 60 * 60 * 24));
    
    // 7æ—¥å‰ã€3æ—¥å‰ã€1æ—¥å‰ã«ãƒã‚§ãƒƒã‚¯
    if ([7, 3, 1].includes(daysDiff)) {
      upcomingEmployees.push({
        name: row[1],
        email: row[2],
        startDate: startDate,
        department: row[4],
        position: row[5],
        daysUntilStart: daysDiff,
        preparationPhase: daysDiff === 7 ? '1é€±é–“å‰æº–å‚™' : 
                         daysDiff === 3 ? '3æ—¥å‰ç¢ºèª' : 'æœ€çµ‚æº–å‚™'
      });
    }
  }
  
  console.log(`å…¥ç¤¾äºˆå®šè€…: ${upcomingEmployees.length}å`);
  return upcomingEmployees;
}

function processUpcomingReminders(employees) {
  console.log('å…¥ç¤¾äºˆå®šè€…ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼å‡¦ç†ä¸­');
  
  const results = [];
  
  employees.forEach(employee => {
    try {
      let reminderResult = {};
      
      switch(employee.daysUntilStart) {
        case 7:
          // 1é€±é–“å‰ï¼šæº–å‚™é–‹å§‹é€šçŸ¥
          reminderResult = send1WeekBeforeReminder(employee);
          break;
        case 3:
          // 3æ—¥å‰ï¼šæº–å‚™çŠ¶æ³ç¢ºèª
          reminderResult = send3DaysBeforeReminder(employee);
          break;
        case 1:
          // 1æ—¥å‰ï¼šæœ€çµ‚ç¢ºèª
          reminderResult = send1DayBeforeReminder(employee);
          break;
      }
      
      results.push({
        employee: employee.name,
        phase: employee.preparationPhase,
        success: reminderResult.success
      });
      
    } catch (error) {
      console.error(`${employee.name}ã®ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼å‡¦ç†ã‚¨ãƒ©ãƒ¼:`, error);
      results.push({
        employee: employee.name,
        phase: employee.preparationPhase,
        success: false,
        error: error.message
      });
    }
  });
  
  return results;
}</div>
            
            <div class="success-tip">
                <strong>â° æ™‚é–“ãƒ™ãƒ¼ã‚¹å‡¦ç†ã®å¨åŠ›:</strong> äººé–“ãŒè¦šãˆã¦ã„ãªãã¦ã‚‚ã€ã‚·ã‚¹ãƒ†ãƒ ãŒé©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è‡ªå‹•å®Ÿè¡Œ
            </div>
        </div>

        <h2>ğŸ“… Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼çµ±åˆè‡ªå‹•ç™»éŒ²</h2>
        
        <div class="calendar-integration">
            <h3>ğŸ—“ï¸ ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚¤ãƒ™ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆ</h3>
            
            <h4>Step 1: è¤‡æ•°ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸ã®åŒæ™‚ç™»éŒ²</h4>
            <div class="code-block">
function processNewEmployees(employees) {
  console.log('æ–°å…¥ç¤¾å“¡è‡ªå‹•å‡¦ç†å®Ÿè¡Œä¸­');
  
  const results = [];
  
  employees.forEach(employee => {
    try {
      // çµ±åˆå‡¦ç†ã®å®Ÿè¡Œï¼ˆå‰å›ã¾ã§ã®æ©Ÿèƒ½ã‚’çµ±åˆï¼‰
      const integrationResult = {
        welcomeEmail: generateAndSendWelcomeEmail(employee),
        calendarEvents: createWelcomeEvents(employee),
        chatNotifications: sendDepartmentChatNotifications(employee),
        taskGeneration: createEmployeeTasks(employee),
        folderCreation: createEmployeeFolder(employee)
      };
      
      // å‡¦ç†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
      updateEmployeeStatus(employee, 'å…¥ç¤¾æ—¥å‡¦ç†å®Œäº†');
      
      results.push({
        employee: employee.name,
        success: true,
        integrationResult: integrationResult
      });
      
      console.log(`âœ… ${employee.name}ã•ã‚“ã®å…¥ç¤¾æ—¥å‡¦ç†å®Œäº†`);
      
    } catch (error) {
      console.error(`${employee.name}ã•ã‚“ã®å‡¦ç†ã‚¨ãƒ©ãƒ¼:`, error);
      updateEmployeeStatus(employee, `å‡¦ç†ã‚¨ãƒ©ãƒ¼: ${error.message}`);
      
      results.push({
        employee: employee.name,
        success: false,
        error: error.message
      });
    }
  });
  
  return results;
}

function createWelcomeEvents(employee) {
  console.log('ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ:', employee.name);
  
  const events = [
    // 1. æœã®ã‚¦ã‚§ãƒ«ã‚«ãƒ é¢è«‡ï¼ˆ9:00-10:00ï¼‰
    {
      summary: `ã€ã‚¦ã‚§ãƒ«ã‚«ãƒ é¢è«‡ã€‘${employee.name}ã•ã‚“`,
      start: getTimeSlot(employee.startDate, 9, 0),
      end: getTimeSlot(employee.startDate, 10, 0),
      attendees: [
        employee.email,
        'hr@company.com',
        getDepartmentManager(employee.department).email
      ],
      description: createEventDescription('ã‚¦ã‚§ãƒ«ã‚«ãƒ é¢è«‡', employee),
      conferenceData: {
        createRequest: {
          requestId: `welcome-${employee.name}-${Date.now()}`
        }
      }
    },
    
    // 2. éƒ¨ç½²ã‚ªãƒªã‚¨ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ14:00-15:30ï¼‰
    {
      summary: `${employee.department} ã‚ªãƒªã‚¨ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ - ${employee.name}ã•ã‚“`,
      start: getTimeSlot(employee.startDate, 14, 0),
      end: getTimeSlot(employee.startDate, 15, 30),
      attendees: getDepartmentMembersEmails(employee.department),
      description: createEventDescription('éƒ¨ç½²ã‚ªãƒªã‚¨ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³', employee),
      location: `${employee.department}ä¼šè­°å®¤`
    },
    
    // 3. ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ©ãƒ³ãƒï¼ˆ12:00-13:30ï¼‰
    {
      summary: `ğŸ½ï¸ ${employee.name}ã•ã‚“ ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ©ãƒ³ãƒ`,
      start: getTimeSlot(employee.startDate, 12, 0),
      end: getTimeSlot(employee.startDate, 13, 30),
      attendees: [
        employee.email,
        getDepartmentManager(employee.department).email,
        'hr@company.com'
      ],
      description: `æ­“è¿ãƒ©ãƒ³ãƒä¼š

æ–°ã—ã„è·å ´ã§ã®ç¬¬ä¸€å°è±¡ã‚’å¤§åˆ‡ã«ã€
ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ãŸé›°å›²æ°—ã§äº¤æµã‚’æ·±ã‚ã¾ã—ã‚‡ã†ã€‚

ğŸ’° çµŒè²»: ä¼šç¤¾è² æ‹…
ğŸ“ å ´æ‰€: ç¤¾å“¡é£Ÿå ‚ ã¾ãŸã¯ è¿‘éš£ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³`,
      location: 'ç¤¾å“¡é£Ÿå ‚ ã¾ãŸã¯ è¿‘éš£ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³'
    }
  ];
  
  // ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆå®Ÿè¡Œ
  const createdEvents = [];
  events.forEach(eventData => {
    try {
      const event = Calendar.Events.insert(eventData, 'primary');
      createdEvents.push({
        id: event.id,
        summary: event.summary,
        success: true
      });
      console.log(`ğŸ“… ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆæˆåŠŸ: ${event.summary}`);
    } catch (error) {
      console.error(`ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆå¤±æ•—: ${eventData.summary}`, error);
      createdEvents.push({
        summary: eventData.summary,
        success: false,
        error: error.message
      });
    }
  });
  
  return { events: createdEvents, totalCreated: createdEvents.filter(e => e.success).length };
}</div>
            
            <h4>Step 2: åˆæ—¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°ä½œæˆ</h4>
            <div class="code-block">
function createFirstDaySchedule(employee) {
  console.log('åˆæ—¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆ:', employee.name);
  
  const schedule = [
    { time: '9:00-9:30', activity: 'å—ä»˜ãƒ»å…¥ç¤¾æ‰‹ç¶šã', location: '1Få—ä»˜', responsible: 'äººäº‹éƒ¨' },
    { time: '9:30-10:00', activity: 'ã‚¦ã‚§ãƒ«ã‚«ãƒ é¢è«‡', location: 'äººäº‹éƒ¨ä¼šè­°å®¤', responsible: 'äººäº‹éƒ¨é•·' },
    { time: '10:00-10:30', activity: 'PCãƒ»å‚™å“å—ã‘å–ã‚Š', location: 'ITéƒ¨é–€', responsible: 'ITç®¡ç†è€…' },
    { time: '10:30-11:30', activity: 'ç¤¾å†…ãƒ„ãƒ¼ãƒ«è¨­å®š', location: 'è‡ªå¸­', responsible: 'ITæ‹…å½“è€…' },
    { time: '11:30-12:00', activity: 'å®‰å…¨è¡›ç”Ÿèª¬æ˜', location: 'ç·å‹™éƒ¨', responsible: 'ç·å‹™æ‹…å½“' },
    { time: '12:00-13:30', activity: 'ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ©ãƒ³ãƒ', location: 'ç¤¾å“¡é£Ÿå ‚', responsible: 'éƒ¨ç½²ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼' },
    { time: '13:30-14:00', activity: 'è‡ªå¸­æ¡ˆå†…ãƒ»ç’°å¢ƒè¨­å®š', location: employee.department, responsible: 'éƒ¨ç½²ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ' },
    { time: '14:00-15:30', activity: 'éƒ¨ç½²ã‚ªãƒªã‚¨ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³', location: `${employee.department}ä¼šè­°å®¤`, responsible: 'éƒ¨ç½²é•·' },
    { time: '15:30-16:30', activity: 'æ¥­å‹™ã‚·ã‚¹ãƒ†ãƒ èª¬æ˜', location: 'è‡ªå¸­', responsible: 'å…ˆè¼©ç¤¾å“¡' },
    { time: '16:30-17:30', activity: 'åˆæ—¥æŒ¯ã‚Šè¿”ã‚Šé¢è«‡', location: 'äººäº‹éƒ¨', responsible: 'äººäº‹æ‹…å½“' }
  ];
  
  // Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«åˆæ—¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¿å­˜
  const scheduleSheet = getOrCreateScheduleSheet();
  
  schedule.forEach(item => {
    scheduleSheet.appendRow([
      employee.name,
      employee.startDate,
      item.time,
      item.activity,
      item.location,
      item.responsible,
      'äºˆå®š',
      new Date()
    ]);
  });
  
  // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¢ºèªãƒ¡ãƒ¼ãƒ«é€ä¿¡
  const scheduleHtml = createScheduleEmailContent(employee, schedule);
  sendScheduleConfirmationEmail(employee, scheduleHtml);
  
  return { success: true, scheduleItems: schedule.length };
}</div>
            
            <div class="success-tip">
                <strong>ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼çµ±åˆã®ä¾¡å€¤:</strong> å…¥ç¤¾åˆæ—¥ã®è©³ç´°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¾ã§è‡ªå‹•ç”Ÿæˆã€‚æ–°å…¥ç¤¾å“¡ã¯å®‰å¿ƒã—ã¦åˆæ—¥ã‚’è¿ãˆã‚‰ã‚Œã‚‹
            </div>
        </div>

        <h2>ğŸ”„ ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ </h2>
        
        <div class="ai-butler">
            <h3>ğŸ“ˆ ç¶™ç¶šçš„æˆé•·ã‚µãƒãƒ¼ãƒˆ</h3>
            
            <h4>Step 1: ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ </h4>
            <div class="code-block">
function checkFollowUpRequired(today) {
  console.log('ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å¯¾è±¡è€…ãƒã‚§ãƒƒã‚¯ä¸­');
  
  const employeeSheet = SpreadsheetApp.getActiveSheet();
  const data = employeeSheet.getDataRange().getValues();
  const followUpEmployees = [];
  
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const startDate = new Date(row[3]);
    const daysSinceStart = Math.ceil((today - startDate) / (1000 * 60 * 60 * 24));
    
    // å…¥ç¤¾å¾Œ1é€±é–“ã€1ãƒ¶æœˆã€3ãƒ¶æœˆã«ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
    if ([7, 30, 90].includes(daysSinceStart) && startDate <= today) {
      const employee = {
        name: row[1],
        email: row[2],
        startDate: startDate,
        department: row[4],
        position: row[5],
        daysSinceStart: daysSinceStart,
        followUpType: daysSinceStart === 7 ? '1é€±é–“å¾Œ' : 
                     daysSinceStart === 30 ? '1ãƒ¶æœˆå¾Œ' : '3ãƒ¶æœˆå¾Œ'
      };
      
      followUpEmployees.push(employee);
    }
  }
  
  console.log(`ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å¯¾è±¡: ${followUpEmployees.length}å`);
  return followUpEmployees;
}

function processFollowUps(employees) {
  console.log('ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å‡¦ç†ä¸­');
  
  const results = [];
  
  employees.forEach(employee => {
    try {
      let followUpResult = {};
      
      if (employee.followUpType === '1é€±é–“å¾Œ') {
        // 1é€±é–“å¾Œãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
        followUpResult = {
          meeting: createWeeklyFollowUpMeeting(employee),
          email: sendWeeklyCheckEmail(employee),
          survey: sendAdaptationSurvey(employee)
        };
        
      } else if (employee.followUpType === '1ãƒ¶æœˆå¾Œ') {
        // 1ãƒ¶æœˆå¾Œãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
        followUpResult = {
          meeting: createMonthlyReviewMeeting(employee),
          feedback: sendMonthlyFeedbackRequest(employee),
          evaluation: initiateMonthlyEvaluation(employee)
        };
        
      } else if (employee.followUpType === '3ãƒ¶æœˆå¾Œ') {
        // 3ãƒ¶æœˆå¾Œãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
        followUpResult = {
          meeting: createQuarterlyEvaluation(employee),
          review: sendQuarterlyReviewInvitation(employee),
          development: createDevelopmentPlan(employee)
        };
      }
      
      results.push({
        employee: employee.name,
        followUpType: employee.followUpType,
        success: true,
        result: followUpResult
      });
      
      console.log(`âœ… ${employee.name}ã•ã‚“ã®${employee.followUpType}ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å®Œäº†`);
      
    } catch (error) {
      console.error(`${employee.name}ã•ã‚“ã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼:`, error);
      results.push({
        employee: employee.name,
        followUpType: employee.followUpType,
        success: false,
        error: error.message
      });
    }
  });
  
  return results;
}</div>
            
            <h4>Step 2: æ®µéšçš„ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—å®Ÿè£…</h4>
            <div class="code-block">
function createWeeklyFollowUpMeeting(employee) {
  const meetingDate = new Date();
  meetingDate.setHours(16, 0, 0, 0); // ä»Šæ—¥ã®16:00
  
  const meetingEnd = new Date(meetingDate);
  meetingEnd.setHours(16, 30, 0, 0);
  
  const event = {
    summary: `ã€1é€±é–“ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã€‘${employee.name}ã•ã‚“`,
    start: { dateTime: meetingDate.toISOString() },
    end: { dateTime: meetingEnd.toISOString() },
    description: `å…¥ç¤¾1é€±é–“å¾Œã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ğŸ“‹ ç¢ºèªäº‹é …:
â€¢ æ¥­å‹™ç†è§£åº¦ã¨åˆæœŸå°è±¡
â€¢ è·å ´é©å¿œçŠ¶æ³ã¨ãƒãƒ¼ãƒ é–¢ä¿‚
â€¢ å›°ã£ã¦ã„ã‚‹ã“ã¨ã‚„ä¸å®‰ãªç‚¹
â€¢ ã‚µãƒãƒ¼ãƒˆãŒå¿…è¦ãªå…·ä½“çš„ãªé ˜åŸŸ
â€¢ ä»Šå¾Œ1ãƒ¶æœˆé–“ã®ç›®æ¨™è¨­å®š

ğŸ¯ ç›®çš„:
æ—©æœŸã®é©å¿œæ”¯æ´ã¨å•é¡Œã®æ—©æœŸç™ºè¦‹ãƒ»è§£æ±º

ğŸ¤– è‡ªå‹•ç”Ÿæˆ: Google Apps Script`,
    attendees: [
      { email: employee.email },
      { email: getDepartmentManager(employee.department).email },
      { email: 'hr@company.com' }
    ],
    conferenceData: {
      createRequest: { requestId: `followup-1w-${employee.name}-${Date.now()}` }
    }
  };
  
  const createdEvent = Calendar.Events.insert(event, 'primary');
  console.log(`ğŸ“… 1é€±é–“ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ä½œæˆ: ${employee.name}`);
  
  return { success: true, eventId: createdEvent.id };
}

function createMonthlyReviewMeeting(employee) {
  const reviewDate = new Date();
  reviewDate.setDate(reviewDate.getDate() + 1); // æ˜æ—¥
  reviewDate.setHours(15, 0, 0, 0);
  
  const reviewEnd = new Date(reviewDate);
  reviewEnd.setHours(16, 0, 0, 0);
  
  const event = {
    summary: `ã€1ãƒ¶æœˆè©•ä¾¡é¢è«‡ã€‘${employee.name}ã•ã‚“`,
    start: { dateTime: reviewDate.toISOString() },
    end: { dateTime: reviewEnd.toISOString() },
    description: `å…¥ç¤¾1ãƒ¶æœˆå¾Œã®ç·åˆè©•ä¾¡é¢è«‡

ğŸ“Š è©•ä¾¡é …ç›®:
â€¢ æ¥­å‹™ã‚¹ã‚­ãƒ«ã®ç¿’å¾—çŠ¶æ³
â€¢ ãƒãƒ¼ãƒ ã¸ã®è²¢çŒ®åº¦
â€¢ ä¼šç¤¾æ–‡åŒ–ã¸ã®é©å¿œåº¦
â€¢ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èƒ½åŠ›
â€¢ ä»Šå¾Œã®æˆé•·è¨ˆç”»ç­–å®š

ğŸ“ æº–å‚™è³‡æ–™:
â€¢ 1ãƒ¶æœˆé–“ã®æ¥­å‹™æŒ¯ã‚Šè¿”ã‚Šã‚·ãƒ¼ãƒˆ
â€¢ ä¸Šå¸ãƒ»åŒåƒšã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
â€¢ æœ¬äººã®è‡ªå·±è©•ä¾¡

ğŸ¯ ç›®çš„:
æ­£å¼é…å±ã¸ã®æœ€çµ‚ç¢ºèªã¨ä»Šå¾Œã®æˆé•·æ”¯æ´è¨ˆç”»ç­–å®š`,
    attendees: [
      { email: employee.email },
      { email: getDepartmentManager(employee.department).email },
      { email: 'hr@company.com' }
    ]
  };
  
  const createdEvent = Calendar.Events.insert(event, 'primary');
  return { success: true, eventId: createdEvent.id };
}</div>
            
            <div class="success-tip">
                <strong>ğŸ“ˆ ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã®ä¾¡å€¤:</strong> å…¥ç¤¾ã‹ã‚‰ã®çµŒéæ—¥æ•°ã‚’è‡ªå‹•è¨ˆç®—ã—ã€é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ç¶™ç¶šã‚µãƒãƒ¼ãƒˆã€‚å®šç€ç‡å‘ä¸Šã«å¤§ããè²¢çŒ®
            </div>
        </div>

        <h2>ğŸ”§ ãƒˆãƒªã‚¬ãƒ¼è¨­å®šã¨é‹ç”¨é–‹å§‹</h2>
        
        <div class="final-system">
            <h3>âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ å¿ƒè‡“éƒ¨ã®è¨­å®š</h3>
            
            <h4>Step 1: æ—¥æ¬¡ãƒˆãƒªã‚¬ãƒ¼è¨­å®š</h4>
            <div class="code-block">
function setupDailyTriggers() {
  console.log('AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•ä¸­...');
  
  try {
    // æ—¢å­˜ã®ãƒˆãƒªã‚¬ãƒ¼ã‚’ç¢ºèªãƒ»å‰Šé™¤ï¼ˆé‡è¤‡é˜²æ­¢ï¼‰
    const triggers = ScriptApp.getProjectTriggers();
    triggers.forEach(trigger => {
      if (trigger.getHandlerFunction() === 'dailyEmployeeCheck') {
        ScriptApp.deleteTrigger(trigger);
        console.log('æ—¢å­˜ãƒˆãƒªã‚¬ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
      }
    });
    
    // æ–°ã—ã„ãƒˆãƒªã‚¬ãƒ¼ã‚’è¨­å®šï¼ˆæ¯æ—¥æœ8æ™‚å®Ÿè¡Œï¼‰
    const newTrigger = ScriptApp.newTrigger('dailyEmployeeCheck')
      .timeBased()
      .everyDays(1)
      .atHour(8)
      .create();
    
    console.log('âœ… æ—¥æ¬¡ãƒˆãƒªã‚¬ãƒ¼è¨­å®šå®Œäº†');
    console.log(`ãƒˆãƒªã‚¬ãƒ¼ID: ${newTrigger.getUniqueId()}`);
    
    // è¨­å®šç¢ºèªé€šçŸ¥ã‚’é€ä¿¡
    sendSystemStartupNotification();
    
    return { 
      success: true, 
      triggerId: newTrigger.getUniqueId(),
      executionTime: 'æ¯æ—¥8:00AM',
      status: 'AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒé–‹å§‹'
    };
    
  } catch (error) {
    console.error('ãƒˆãƒªã‚¬ãƒ¼è¨­å®šã‚¨ãƒ©ãƒ¼:', error);
    return { success: false, error: error.message };
  }
}

function sendSystemStartupNotification() {
  const message = {
    text: `ğŸ¤– AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒé–‹å§‹`,
    cards: [{
      header: {
        title: 'AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ ',
        subtitle: 'è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ãŒæ­£å¸¸ã«èµ·å‹•ã—ã¾ã—ãŸ'
      },
      sections: [{
        widgets: [{
          textParagraph: {
            text: `<b>ğŸš€ ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒé–‹å§‹</b><br>
æ¯æ—¥æœ8æ™‚ã«è‡ªå‹•å®Ÿè¡Œã—ã¾ã™<br><br>

<b>ğŸ“‹ è‡ªå‹•å®Ÿè¡Œæ©Ÿèƒ½:</b><br>
âœ… å…¥ç¤¾æ—¥ãƒã‚§ãƒƒã‚¯ãƒ»ã‚¦ã‚§ãƒ«ã‚«ãƒ å‡¦ç†<br>
âœ… äº‹å‰æº–å‚™ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼<br>
âœ… ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—é¢è«‡è¨­å®š<br>
âœ… é€²æ—ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ<br><br>

<b>ğŸ¯ åŠ¹æœ:</b><br>
â€¢ æ‰‹ä½œæ¥­æ™‚é–“ 95%å‰Šæ¸›<br>
â€¢ ä½œæ¥­æ¼ã‚Œ 100%é˜²æ­¢<br>
â€¢ å¯¾å¿œå“è³ªã®æ¨™æº–åŒ–<br>
â€¢ 24æ™‚é–“365æ—¥ç¨¼åƒ`
          }
        }]
      }]
    }]
  };
  
  const hrWebhook = getDepartmentWebhook('äººäº‹éƒ¨');
  if (hrWebhook) {
    sendChatMessage(hrWebhook, message);
  }
}</div>
            
            <h4>Step 2: ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ç›£è¦–</h4>
            <div class="code-block">
function systemHealthCheck() {
  console.log('ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ');
  
  const healthStatus = {
    timestamp: new Date(),
    services: {
      spreadsheet: checkSpreadsheetHealth(),
      chatGPT: checkChatGPTHealth(),
      gmail: checkGmailHealth(),
      calendar: checkCalendarHealth(),
      chat: checkChatHealth(),
      triggers: checkTriggerHealth()
    },
    overallStatus: 'OK'
  };
  
  // å„ã‚µãƒ¼ãƒ“ã‚¹ã®çŠ¶æ…‹ç¢ºèª
  Object.keys(healthStatus.services).forEach(service => {
    if (!healthStatus.services[service].healthy) {
      healthStatus.overallStatus = 'WARNING';
      console.warn(`${service}ã«å•é¡ŒãŒã‚ã‚Šã¾ã™:`, healthStatus.services[service].error);
    }
  });
  
  // ç•°å¸¸æ¤œçŸ¥æ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆ
  if (healthStatus.overallStatus !== 'OK') {
    sendHealthAlert(healthStatus);
  }
  
  // å¥å…¨æ€§ãƒ­ã‚°è¨˜éŒ²
  logHealthStatus(healthStatus);
  
  return healthStatus;
}

function checkTriggerHealth() {
  try {
    const triggers = ScriptApp.getProjectTriggers();
    const dailyTrigger = triggers.find(t => t.getHandlerFunction() === 'dailyEmployeeCheck');
    
    return {
      healthy: !!dailyTrigger,
      message: dailyTrigger ? 'ãƒˆãƒªã‚¬ãƒ¼æ­£å¸¸å‹•ä½œä¸­' : 'ãƒˆãƒªã‚¬ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
      lastRun: dailyTrigger ? 'ä¸æ˜' : null
    };
  } catch (error) {
    return {
      healthy: false,
      error: error.message
    };
  }
}

function sendHealthAlert(healthStatus) {
  const alertMessage = {
    text: `ğŸš¨ AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ  ã‚¢ãƒ©ãƒ¼ãƒˆ`,
    cards: [{
      header: {
        title: 'ã‚·ã‚¹ãƒ†ãƒ ç•°å¸¸æ¤œçŸ¥',
        subtitle: `ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${healthStatus.overallStatus}`
      },
      sections: [{
        widgets: [{
          textParagraph: {
            text: `ã‚·ã‚¹ãƒ†ãƒ ã®ä¸€éƒ¨ã§å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚<br>
ç®¡ç†è€…ã«ã‚ˆã‚‹ç¢ºèªãŒå¿…è¦ã§ã™ã€‚<br><br>
<b>ç¢ºèªæ—¥æ™‚:</b> ${Utilities.formatDate(healthStatus.timestamp, 'JST', 'yyyyå¹´MMæœˆddæ—¥ HH:mm:ss')}`
          }
        }]
      }]
    }]
  };
  
  const hrWebhook = getDepartmentWebhook('äººäº‹éƒ¨');
  if (hrWebhook) {
    sendChatMessage(hrWebhook, alertMessage);
  }
}</div>
        </div>

        <h2>ğŸ“Š ã‚·ãƒªãƒ¼ã‚ºç·æ‹¬ã¨æˆæœ</h2>
        
        <div class="metrics-showcase">
            <h3 style="color: white;">ğŸ¯ 8å›ã‚·ãƒªãƒ¼ã‚ºã§é”æˆã—ãŸé©å‘½çš„æˆæœ</h3>
            
            <div class="timeline">
                <div class="timeline-item">
                    <h4>å‹•ç”»1: Googleå®Œçµå‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ä½“æ„Ÿ</h4>
                    <p>è¤‡é›‘ãªå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æºã‹ã‚‰ã€Googleç’°å¢ƒå†…å®Œçµã¸ã®æ–¹é‡è»¢æ›</p>
                </div>
                <div class="timeline-item">
                    <h4>å‹•ç”»2: çµ±åˆãƒ•ãƒ­ãƒ¼è¨­è¨ˆå›³ä½œæˆ</h4>
                    <p>Apps Scriptä¸­å¤®ãƒãƒ–ã«ã‚ˆã‚‹çµ±åˆã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ</p>
                </div>
                <div class="timeline-item">
                    <h4>å‹•ç”»3: Googleãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•åæ˜ ã‚·ã‚¹ãƒ†ãƒ </h4>
                    <p>æ‰‹å‹•è»¢è¨˜ã‹ã‚‰ã®å®Œå…¨è§£æ”¾ã€ãƒ‡ãƒ¼ã‚¿å“è³ªå‘ä¸Š</p>
                </div>
                <div class="timeline-item">
                    <h4>å‹•ç”»4: ChatGPT AIæ­“è¿ãƒ¡ãƒ¼ãƒ«ç”Ÿæˆ</h4>
                    <p>å€‹åˆ¥åŒ–ã•ã‚ŒãŸAIç”Ÿæˆãƒ¡ãƒ¼ãƒ«ã§æ„Ÿå‹•ä½“é¨“ã‚’å‰µå‡º</p>
                </div>
                <div class="timeline-item">
                    <h4>å‹•ç”»5: äººäº‹å°‚ç”¨AI WebAppé–‹ç™º</h4>
                    <p>ãƒãƒ¼ãƒ å…¨ä½“ã§ã®AIæ´»ç”¨ã‚’å®Ÿç¾ã€æŠ€è¡“çš„æ•·å±…ã‚’æ’¤å»ƒ</p>
                </div>
                <div class="timeline-item">
                    <h4>å‹•ç”»6: Google APIsçµ±åˆé€£æº</h4>
                    <p>è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ã®å”èª¿è‡ªå‹•åŒ–ã€çœŸã®çµ±åˆã‚·ã‚¹ãƒ†ãƒ å®Œæˆ</p>
                </div>
                <div class="timeline-item">
                    <h4>å‹•ç”»7: ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ»Chaté€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ </h4>
                    <p>æŠœã‘æ¼ã‚Œã‚¼ãƒ­ã®å®Œç’§ãªé€²æ—ç®¡ç†ã‚’å®Ÿç¾</p>
                </div>
                <div class="timeline-item">
                    <h4>å‹•ç”»8: AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ å®Œæˆ</h4>
                    <p>æ™‚é–“ãƒ™ãƒ¼ã‚¹å®Œå…¨è‡ªå‹•åŒ–ã€çœŸã®ã€Œæ‰‹ä½œæ¥­ã‚¼ãƒ­ã€é”æˆ</p>
                </div>
            </div>
            
            <div class="achievements-grid">
                <div class="achievement-card">
                    <h4>â±ï¸ æ™‚é–“åŠ¹æœ</h4>
                    <p><strong>æœˆ20æ™‚é–“ â†’ æœˆ1æ™‚é–“</strong></p>
                    <p>95%ã®å·¥æ•°å‰Šæ¸›</p>
                </div>
                <div class="achievement-card">
                    <h4>ğŸ’° ã‚³ã‚¹ãƒˆåŠ¹æœ</h4>
                    <p><strong>æœˆé¡$86 â†’ æœˆé¡$10</strong></p>
                    <p>88%ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›</p>
                </div>
                <div class="achievement-card">
                    <h4>ğŸ¯ ç²¾åº¦å‘ä¸Š</h4>
                    <p><strong>äººçš„ãƒŸã‚¹5% â†’ 0%</strong></p>
                    <p>å®Œç’§ãªå®Ÿè¡Œç²¾åº¦</p>
                </div>
                <div class="achievement-card">
                    <h4>âš¡ é€Ÿåº¦å‘ä¸Š</h4>
                    <p><strong>1ä»¶20åˆ† â†’ 30ç§’</strong></p>
                    <p>40å€ã®å‡¦ç†é€Ÿåº¦</p>
                </div>
            </div>
        </div>

        <h2>ğŸ”® ä»Šå¾Œã®å¯èƒ½æ€§ã¨å±•é–‹</h2>
        
        <div class="feature-highlight">
            <h3>ğŸš€ AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ ã®æœªæ¥</h3>
            
            <h4>ğŸ“ˆ æ‹¡å¼µå¯èƒ½æ€§</h4>
            <ul>
                <li><strong>ä»–ã®äººäº‹æ¥­å‹™ã¸ã®æ¨ªå±•é–‹:</strong> è©•ä¾¡ã€æ˜‡é€²ã€é€€è·æ‰‹ç¶šãã®è‡ªå‹•åŒ–</li>
                <li><strong>ä»–éƒ¨ç½²ã§ã®åŒæ§˜ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰:</strong> å–¶æ¥­ã€é–‹ç™ºã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨é–€ã§ã®æ´»ç”¨</li>
                <li><strong>ã‚ˆã‚Šé«˜åº¦ãªAIæ©Ÿèƒ½ã®è¿½åŠ :</strong> è‡ªç„¶è¨€èªå‡¦ç†ã€äºˆæ¸¬åˆ†æã€ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</li>
                <li><strong>ä¼šç¤¾å…¨ä½“ã®DXæ¨é€²:</strong> ãƒ‡ã‚¸ã‚¿ãƒ«å¤‰é©ã®ãƒ¢ãƒ‡ãƒ«ã‚±ãƒ¼ã‚¹ã¨ã—ã¦å±•é–‹</li>
            </ul>
            
            <h4>ğŸ”§ ç¶™ç¶šçš„æ”¹å–„</h4>
            <ul>
                <li><strong>åˆ©ç”¨ãƒ‡ãƒ¼ã‚¿ã®åˆ†æ:</strong> è“„ç©ã•ã‚ŒãŸãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ”¹å–„ç‚¹ã‚’ç‰¹å®š</li>
                <li><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åæ˜ :</strong> å®Ÿéš›ã®åˆ©ç”¨è€…ã®å£°ã‚’ã‚·ã‚¹ãƒ†ãƒ ã«åæ˜ </li>
                <li><strong>æ–°Google APIæ´»ç”¨:</strong> æ–°æ©Ÿèƒ½ãƒ»æ–°ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€£æº</li>
                <li><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–:</strong> ç¶™ç¶šçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ</li>
            </ul>
            
            <div class="success-tip">
                <strong>ğŸ¯ æˆåŠŸã®è¦å› :</strong> Google Workspaceå®Œçµå‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€å®‰å…¨æ€§ãƒ»çµŒæ¸ˆæ€§ãƒ»æ‹¡å¼µæ€§ã®ä¸‰æ‹å­ãŒæƒã£ãŸæŒç¶šå¯èƒ½ãªã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿç¾
            </div>
        </div>

        <h2>ğŸ› ï¸ é‹ç”¨ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</h2>
        
        <div class="final-system">
            <h3>ğŸ“‹ ç¶™ç¶šé‹ç”¨ã®ãŸã‚ã®ãƒã‚¤ãƒ³ãƒˆ</h3>
            
            <h4>æ—¥å¸¸çš„ãªç›£è¦–é …ç›®</h4>
            <ul>
                <li><strong>ãƒˆãƒªã‚¬ãƒ¼å‹•ä½œç¢ºèª:</strong> æ¯æ—¥ã®è‡ªå‹•å®Ÿè¡ŒãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã‹</li>
                <li><strong>APIåˆ©ç”¨çŠ¶æ³:</strong> ChatGPT APIã®åˆ©ç”¨é‡ã¨ã‚³ã‚¹ãƒˆç®¡ç†</li>
                <li><strong>ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª:</strong> å‡¦ç†å¤±æ•—ã‚„ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã®æ—©æœŸç™ºè¦‹</li>
                <li><strong>ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯:</strong> ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ç¢ºèª</li>
            </ul>
            
            <h4>å®šæœŸçš„ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</h4>
            <ul>
                <li><strong>æœˆæ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼:</strong> ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨çŠ¶æ³ã¨åŠ¹æœæ¸¬å®š</li>
                <li><strong>å››åŠæœŸã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ:</strong> æ–°æ©Ÿèƒ½è¿½åŠ ã¨æ”¹å–„å®Ÿè£…</li>
                <li><strong>å¹´æ¬¡ã‚·ã‚¹ãƒ†ãƒ ç›£æŸ»:</strong> ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨æ€§èƒ½ã®ç·åˆè©•ä¾¡</li>
                <li><strong>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†:</strong> ãƒ‡ãƒ¼ã‚¿ã¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª</li>
            </ul>
            
            <div class="warning-box">
                <h4>âš ï¸ é‹ç”¨æ™‚ã®æ³¨æ„ç‚¹</h4>
                <ul>
                    <li><strong>APIåˆ¶é™ã®ç›£è¦–:</strong> Google APIã¨ChatGPT APIã®åˆ©ç”¨åˆ¶é™ã‚’è¶…ãˆãªã„ã‚ˆã†ç®¡ç†</li>
                    <li><strong>æ¨©é™ç®¡ç†:</strong> Apps Scriptã¨Webhookã®é©åˆ‡ãªæ¨©é™è¨­å®šã‚’ç¶­æŒ</li>
                    <li><strong>ãƒ‡ãƒ¼ã‚¿ä¿è­·:</strong> å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«é–¢ã™ã‚‹ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹éµå®ˆ</li>
                    <li><strong>éšœå®³å¯¾å¿œ:</strong> ã‚·ã‚¹ãƒ†ãƒ éšœå®³æ™‚ã®æ‰‹å‹•å‡¦ç†æ‰‹é †ã‚’æº–å‚™</li>
                </ul>
            </div>
        </div>

        <div class="final-celebration">
            <h2 style="color: white;">ğŸ‰ AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ å®ŒæˆãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</h2>
            <p style="font-size: 20px; color: white;">
                <strong>8å›ã®ã‚·ãƒªãƒ¼ã‚ºã‚’é€šã—ã¦ã€çš†ã•ã‚“ã¯ç´ æ™´ã‚‰ã—ã„ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸ</strong>
            </p>
            <p style="color: white;">
                ã“ã‚Œã¾ã§æ‰‹å‹•ã§è¡Œã£ã¦ã„ãŸç…©é›‘ãªäººäº‹æ¥­å‹™ãŒã€AIäººäº‹åŸ·äº‹ã«ã‚ˆã£ã¦å®Œå…¨è‡ªå‹•åŒ–ã•ã‚Œã¾ã—ãŸã€‚<br>
                Google Workspaceå®Œçµå‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã€å®‰å…¨ã§çµŒæ¸ˆçš„ã§æ‹¡å¼µæ€§ã®é«˜ã„ã‚·ã‚¹ãƒ†ãƒ ã‚’æ‰‹ã«å…¥ã‚ŒãŸã®ã§ã™ã€‚
            </p>
            <p style="font-size: 18px; color: white;">
                <strong>ã“ã‚Œã‚’æ©Ÿã«ã€çš†ã•ã‚“ã®ä¼šç¤¾ã§ã‚‚çœŸã®ãƒ‡ã‚¸ã‚¿ãƒ«å¤‰é©ã‚’å®Ÿç¾ã—ã¦ãã ã•ã„ã€‚</strong><br>
                AIäººäº‹åŸ·äº‹ã¨å…±ã«ã€ç´ æ™´ã‚‰ã—ã„äººäº‹æ¥­å‹™ã®æœªæ¥ã‚’å‰µã£ã¦ã„ãã¾ã—ã‚‡ã†ï¼
            </p>
        </div>

        <div style="text-align: center; margin-top: 40px; padding: 20px; background: #e8f0fe; border-radius: 8px;">
            <h3>âœ¨ æ‰‹ä½œæ¥­ã‚¼ãƒ­ã®æœªæ¥ã€ã“ã“ã«å®Œæˆï¼</h3>
            <p style="font-size: 18px; color: #2c3e50;">AIäººäº‹åŸ·äº‹ã‚·ã‚¹ãƒ†ãƒ ã§ã€äººäº‹æ¥­å‹™ã®æ–°æ™‚ä»£ã‚’åˆ‡ã‚Šé–‹ãã¾ã—ãŸã€‚</p>
        </div>
    </div>
</body>
</html>