# 動画2: 内定者情報の入力から社内連携まで、完全自動化フローの完成図を体感する

**撮影時間**: 10分  
**目標**: Google統合自動化フローの設計図を理解し、実装への確信を得る

---

## 🎬 オープニング（0:00-1:30）

### **セリフ**
「皆さん、前回の動画はいかがでしたか？あの5秒間の『魔法』に驚かれたのではないでしょうか。」

**【画面】**: 前回の最終デモシーンを簡単に振り返り

「今日は、その魔法の『設計図』を一緒に描いてみましょう。家を建てる時、いきなり釘を打ち始める人はいませんよね？まずは設計図を描きます。AIの自動化フローも同じです。」

**【画面切り替え】**: タイトル表示

「今回は、私たちがこれから作り上げる『AI人事執事』の完璧な設計図を、皆さんと一緒に描いていきたいと思います。これさえあれば、もう迷うことはありません。」

---

## 📊 設計の重要性（1:30-2:30）

### **セリフ**
「なぜ設計図が重要かというと、従来の複雑なシステムでは、こんな問題が起きていたからです。」

**【画面】**: Before状態の複雑な構成図

「頭の中やメモ帳に散らばるタスクリスト。場当たり的な対応で、抜け漏れが多発。全体像が見えず、常に不安を抱えながら作業していました。」

**【画面切り替え】**: After状態のシンプルな設計図

「改善後は、誰が見ても一目でわかる業務フロー図が存在する状態。各ツールの役割とデータの流れが明確になり、自信を持って構築を進められます。」

---

## 🏗️ Google統一アーキテクチャ（2:30-4:00）

### **セリフ**
「まず、私たちが採用するGoogle統一アーキテクチャの設計思想をご説明します。」

**【画面】**: 従来の複雑な外部依存型vs Google完結型の比較

「従来の複雑な外部依存型では、Googleフォームから始まって、Make、ChatGPT、Dify、Notion、Slackと、6つもの外部サービスを経由していました。これだと障害点が多く、セキュリティリスクも高い。」

**【画面切り替え】**: Google完結型アーキテクチャ

「新しいアプローチでは、Googleフォームから始まって、Google Apps Scriptを中央ハブとして、全てのGoogle APIに繋がります。シンプルで、セキュアで、管理が容易です。」

### **セリフ（続き）**
「ここで重要なのは、Google Apps Scriptが『中央ハブ』の役割を果たすことです。」

**【画面】**: GASの威力説明
- 統合力：全Googleサービス + 外部API
- 経済性：無料枠内で強力な処理
- セキュリティ：Google管理下で安全
- パフォーマンス：並行処理で高速実行

---

## 🎨 ライブ設計デモ（4:00-7:30） - メインパート

### **セリフ**
「では、実際に作図ツールを使って、この設計図をリアルタイムで描いてみましょう。私と一緒に、一つ一つのコンポーネントを配置していきます。」

**【画面】**: Miro またはLucidchartの空白画面

### **ライブ作図実演**

#### **Step 1**: 入力層の配置（4:00-4:30）
**【セリフ】**: 「まず、起点となるのは内定者情報が入力されるGoogleフォームです。ここにアイコンを配置します。」

**【操作】**:
- Googleフォームのアイコンを左上に配置
- 「情報入力ポイント」として赤色でマーキング

**【セリフ】**: 「次に、フォームから送信されたデータが蓄積されるGoogleスプレッドシートを配置します。ここから矢印を伸ばして...」

**【操作】**:
- スプレッドシートアイコンを配置
- フォームからスプレッドシートへの矢印を描画

#### **Step 2**: 処理層の配置（4:30-5:30）
**【セリフ】**: 「そして、ここが今回の核心部分。Google Apps Scriptを中央に配置します。これが我々の『司令塔』になります。」

**【操作】**:
- 中央にGASアイコンを大きく配置
- 「処理・変換ポイント」として黄色でマーキング

**【セリフ】**: 「GASから、複数のGoogle APIに同時に接続します。Gmail API、Calendar API、Chat API、Drive API...」

**【操作】**:
- 各APIアイコンを右側に配置
- GASから各APIへの矢印を並行して描画
- 「これが並行処理の視覚化です」

#### **Step 3**: 外部AI連携（5:30-6:00）
**【セリフ】**: 「AI機能のために、最小限のChatGPT APIも連携させます。重要なのは、これが唯一の外部サービスだということです。」

**【操作】**:
- ChatGPT APIアイコンを配置
- GASとの接続線を点線で描画（外部サービスであることを表現）

#### **Step 4**: 出力層の配置（6:00-7:00）
**【セリフ】**: 「最後に、各APIから実際のユーザーや部署への出力を描きます。」

**【操作】**:
- Gmail → 内定者への自動メール
- Calendar → 上長・HRへの予定通知
- Chat → 各部署への準備依頼
- Drive → 書類の自動準備

**【セリフ】**: 「見てください。この美しいフロー図が完成しました。データの流れが一目瞭然ですね。」

#### **Step 5**: エラーハンドリングの追加（7:00-7:30）
**【セリフ】**: 「実用的なシステムには、エラーハンドリングも必要です。」

**【操作】**:
- 点線でフォールバック経路を追加
- 「AI処理が失敗した場合のテンプレート処理」
- 「メール送信失敗時の再試行」

**【セリフ】**: 「これで、堅牢な自動化システムの設計図が完成しました！」

---

## ⚡ 高速化の秘密（7:30-8:30）

### **セリフ**
「前回のデモで、なぜあれが5秒で完了したのか、その秘密をお教えします。」

**【画面】**: 処理時間比較表

「従来の逐次処理では、メール生成3秒、送信2秒、カレンダー2秒、通知3秒で、合計10秒かかっていました。」

**【画面切り替え】**: 並行処理の図解

「新しい並行処理では、これらを全て同時実行します。最も時間のかかる処理が3秒なので、全体で3秒で完了するんです。」

**【画面】**: コード例表示

```javascript
// JavaScript Promise.all() による並行処理
const promises = [
  generateAndSendEmail(employeeData),    // 3秒
  createCalendarEvents(employeeData),    // 2秒  
  sendNotifications(employeeData),       // 3秒
  createTasks(employeeData)              // 1秒
];

const results = await Promise.allSettled(promises);
// 約3秒で全完了
```

**【セリフ】**: 「これが、5秒という驚異的な速度を実現している技術的な秘密です。」

---

## 🛡️ 堅牢性設計（8:30-9:00）

### **セリフ**
「実用的なシステムには、エラー耐性も重要です。『一つでも失敗したら全て止まる』では困りますからね。」

**【画面】**: エラーハンドリング戦略

「私たちの設計では、段階的フォールバック戦略を採用しています。AI生成が失敗しても、高品質テンプレートにフォールバック。それも失敗したら、基本メールに切り替わります。」

**【画面】**: コード例

```javascript
function robustEmailGeneration(employeeData) {
  try {
    return generateAIEmail(employeeData);
  } catch (aiError) {
    try {
      return generateTemplateEmail(employeeData);
    } catch (templateError) {
      return generateBasicEmail(employeeData);
    }
  }
}
```

**【セリフ】**: 「このように、部分的な失敗があっても、システム全体は動き続ける設計になっています。」

---

## 🎯 まとめ・次回予告（9:00-10:00）

### **セリフ**
「今日は、Google統合自動化フローの完璧な設計図を一緒に描きました。」

**【画面】**: 完成した設計図の全体表示

「重要なポイントを振り返りましょう。中央ハブとしてのGoogle Apps Script、並行処理による高速化、堅牢なエラーハンドリング、そして何より、シンプルで理解しやすい構成です。」

### **セリフ（次回予告）**
「設計図は完成しました。次回はいよいよ、実際の構築開始です！」

**【画面】**: 次回予告

「次回は、全ての情報の入り口となる『Googleフォーム』を設定し、入力された情報が自動でスプレッドシートに整理される、最も基本的で、しかし最も重要な仕組みを作ります。」

**【セリフ（最後）****: 「今日学んだ設計図があれば、もう迷うことはありません。次回から始まる実装フェーズを、自信を持って進めましょう！」

---

## 🎥 撮影メモ

### **画面構成**
- **メイン画面**: 作図ツール（Miro/Lucidchart）
- **サブ画面**: コード例、比較表等
- **画面録画**: 実際の図を描く過程を滑らかに撮影

### **重要な演出ポイント**
1. **ライブ感**: 実際に図を描きながら説明する臨場感
2. **視覚的インパクト**: 複雑→シンプルの変化を強調
3. **技術的説得力**: 並行処理等の具体的な仕組みも説明

### **事前準備**
- 作図ツールの操作練習
- アイコン素材の準備
- 途中段階での保存ポイント設定
- カメラアングルの調整（手元と画面の両方が見える）

### **撮影のコツ**
1. **音声**: 図を描きながらの説明なので、マイク位置に注意
2. **ペース**: 描画スピードと説明のタイミングを合わせる
3. **強調**: 重要な接続部分は少し時間をかけて描く

この設計図により、受講者は「なぜそうなるのか」を理解し、自信を持って次の実装段階に進むことができます。