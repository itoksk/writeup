# AppSheetで営業事務の"紙地獄"を脱出！ゼロから作る見積・請求アプリ

## コース概要

営業事務の現場では、ExcelやGoogleスプレッドシート、紙の帳票が散在し、案件ごとに転記作業が発生していませんか？本コースでは、ノーコードツール「AppSheet」を使って、見積・請求を一元管理するアプリを作成します。

**対象者**: プログラミング経験不要（Excelの基本的な関数が理解できればOK）  
**所要時間**: 全5回、各10分の動画  
**利用ツール**: AppSheet（無料プラン）、Googleスプレッドシート

---

## 動画一覧

### [動画1: AppSheetとは？基本画面とデータ連携の仕組み](./動画1_AppSheetとは？基本画面とデータ連携の仕組み/)
- AppSheetの概要と他ツールとの違い
- Googleスプレッドシートとの連携方法
- AppSheet Editorの基本画面（Data、UX、Actions、Automations）
- 本コースで作成するアプリの全体像

### [動画2: 顧客・社員・サービス・注文・注文詳細テーブルを設計する](./動画2_顧客・社員・サービス・注文・注文詳細テーブルを設計する/)
- 5つのテーブルの役割と関係性
- 参照型（Ref）を使ったテーブル間の接続方法
- 親子関係（注文と注文詳細）の設定方法
- 自動生成される仮想カラムの活用方法

### [動画3: フォームと一覧画面を整える](./動画3_フォームと一覧画面を整える/)
- Form ViewとTable/Card Viewの違い
- 入力フォームのカスタマイズ方法
- 一覧画面のフィルタとソート設定
- 使いやすいUI/UXのベストプラクティス

### [動画4: テンプレートから見積書・請求書を出力する](./動画4_テンプレートから見積書・請求書を出力する/)
- Google Docsテンプレートの作成方法
- AppSheetのプレースホルダー（<<[カラム名]>>）の使い方
- PDF出力の設定方法
- テンプレートの変数展開のデバッグ方法

### [動画5: アクションとオートメーションで業務を自動化する](./動画5_アクションとオートメーションで業務を自動化する/)
- アクション（Action）とオートメーション（Automation）の違い
- フラグを使ったトリガー設計
- 見積書・請求書発行の自動化フローを構築
- エラーハンドリングとデバッグ方法

---

## データ構造（5テーブル）

### 1. 顧客テーブル
- ID顧客（主キー、自動生成UUID）
- 顧客名（Text）
- カテゴリ（Enum: 法人 / 個人 / 官公庁）
- 住所（Address）
- 電話（Phone）
- メール（Email）

### 2. 社員テーブル
- ID社員（主キー、自動生成UUID）
- 社員名（Text）
- 役職（Enum: 営業 / 営業事務 / 管理職）
- 電話（Phone）
- メール（Email）

### 3. サービステーブル
- IDサービス（主キー、自動生成UUID）
- サービス名（Text）
- 価格（Price）
- 詳細（LongText）

### 4. 注文テーブル（親テーブル）
- ID注文（主キー、自動生成UUID）
- ID社員（Ref → 社員テーブル）
- ID顧客（Ref → 顧客テーブル）
- ステータス（Enum: 見積中 / 見積発行済 / 受注 / 請求済 / 入金済）
- 発行日（Date）
- 納期（Date）
- 見積番号（Formula）
- 請求番号（Formula）
- 納入単価合計（Virtual）
- 消費税（Formula）
- 合計金額（Formula）
- 見積書発行フラグ（Yes/No、初期値False）
- 請求書発行フラグ（Yes/No、初期値False）
- 一覧出力フラグ（Yes/No、初期値False）

### 5. 注文詳細テーブル（子テーブル）
- ID注文詳細（主キー、自動生成UUID）
- ID注文（Ref → 注文テーブル）
- IDサービス（Ref → サービステーブル）
- 数量（Number）
- 単価（Price、Initial Value: `[IDサービス].[価格]`）
- 納入金額（Formula: `[数量] * [単価]`）

---

## 重要な数式まとめ

### 見積番号の自動生成
```
CONCATENATE("MT", TEXT([発行日], "YYYYMMDD"), "-", RIGHT("0" & (COUNT(SELECT(注文[_ROWNUMBER], [発行日] = [_THISROW].[発行日])) + 1), 2))
```

### 請求番号の自動生成
```
SUBSTITUTE([見積番号], "MT", "SK")
```

### 納入単価合計
```
SUM([Related 注文詳細s][納入金額])
```

### 消費税
```
[納入単価合計] * 0.1
```

### 合計金額
```
[納入単価合計] + [消費税]
```

---

## 事前準備

1. **Googleアカウント（Gmail）を用意**
2. **Google Driveにフォルダを作成**
3. **demo_dataフォルダ内の5つのCSVファイルをGoogleスプレッドシートにインポート**
   - 顧客.csv
   - 社員.csv
   - サービス.csv
   - 注文.csv
   - 注文詳細.csv
4. **AppSheetアカウントを作成（Googleアカウントで無料登録）**

---

## アクション構成（3つ）

### 1. 見積書発行アクション
1. ボタンをクリック → 「見積書発行フラグ」をTrueに設定
2. オートメーション（Data Change: 注文テーブル）がトリガー
3. Google Docsテンプレートから見積書PDFを生成
4. 指定フォルダに保存
5. フラグをFalseに戻す

### 2. 請求書発行アクション
1. ボタンをクリック → 「請求書発行フラグ」をTrueに設定
2. オートメーション（Data Change: 注文テーブル）がトリガー
3. Google Docsテンプレートから請求書PDFを生成
4. 指定フォルダに保存
5. フラグをFalseに戻す

### 3. 一覧出力アクション
1. ボタンをクリック → 「一覧出力フラグ」をTrueに設定
2. オートメーション（Data Change: 注文テーブル）がトリガー
3. 注文詳細データをExcel形式で出力
4. 指定フォルダに保存
5. フラグをFalseに戻す

---

## よくある質問（FAQ）

**Q1: AppSheetは無料で使えますか？**  
A1: 個人利用や小規模チーム（10ユーザーまで）であれば無料プランで十分利用できます。本コースの内容も無料プランで実装可能です。

**Q2: プログラミング知識は必要ですか？**  
A2: 基本的なExcel関数（SUMやCONCATENATEなど）が理解できれば問題ありません。プログラミング経験は不要です。

**Q3: スマホアプリとして配布できますか？**  
A3: はい、AppSheetで作成したアプリはiOSとAndroidの両方で動作します。AppSheetアプリをインストールすることで、モバイルからもアクセスできます。

**Q4: 既存のExcelデータを移行できますか？**  
A4: はい、ExcelファイルをGoogleスプレッドシートにインポートすることで、既存データをそのまま活用できます。

**Q5: オフライン環境でも使えますか？**  
A5: AppSheetのモバイルアプリは「Sync」機能により、オフライン時でもデータ入力が可能です。オンラインに復帰したタイミングで自動的に同期されます。

---

## 学習のポイント

1. **データ設計が最重要**: テーブル構造とリレーションシップを正しく設計することで、後の作業が大幅に楽になります。
2. **フラグを使ったトリガー設計**: 直接的なボタンアクションではなく、フラグを介することで柔軟な自動化が実現できます。
3. **Virtual Columnの活用**: 計算式やリレーションシップから自動生成されるカラムを活用することで、データの整合性が保たれます。
4. **テンプレート設計の重要性**: Google Docsテンプレートの設計が、出力されるPDFの品質を左右します。
5. **段階的な構築**: 一度に全機能を実装するのではなく、動画の順序通りに段階的に構築することで、理解が深まります。

---

## 応用事例

本コースで学んだ内容は、以下のような業務アプリにも応用できます：

- 勤怠管理アプリ（社員・勤怠記録・休暇申請）
- 在庫管理アプリ（商品・入出庫・棚卸）
- 顧客管理アプリ（顧客・商談・活動記録）
- 工事管理アプリ（案件・工程・作業報告）
- 設備点検アプリ（設備・点検項目・点検記録）

---

## 参考リンク

- [AppSheet公式ドキュメント](https://help.appsheet.com/)
- [AppSheet Community Forum](https://community.appsheet.com/)
- [AppSheet YouTube Channel](https://www.youtube.com/c/AppSheet)
- [Googleスプレッドシート関数リファレンス](https://support.google.com/docs/table/25273)

---

## ライセンス

このコース教材は教育目的で自由に使用できます。商用利用の場合は、事前にご連絡ください。

---

**本コースの目標**: 10分×5本の動画を通じて、営業事務の"紙地獄"から脱出し、AppSheetで実用的な見積・請求アプリを自作できるようになること。
