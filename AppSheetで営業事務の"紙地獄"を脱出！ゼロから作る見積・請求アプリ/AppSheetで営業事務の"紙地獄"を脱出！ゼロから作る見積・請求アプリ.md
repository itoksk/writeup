# AppSheetで営業事務の"紙地獄"を脱出！ゼロから作る見積・請求アプリ

## 1. 想定する現場課題

現場ヒアリングでは、案件ごとにExcelと紙フォーマットが混在し、集計担当が週2回1.5時間ずつ転記していることが分かりました。営業事務3名で月平均42件の見積・請求を処理する際に、案件IDの重複と入力漏れが月4件発生し、請求漏れによる入金遅延が平均8日生じています。この状況から、紙ベース運用と散在するスプレッドシートが業務遅延を生む主要因であると結論づけられます。

## 2. 理想の状態（Before/After）

**Before：**  
見積→承認→請求→入金管理の各工程で別々のファイルを開き、転記とPDF作成に1件当たり平均32分、週合計6時間の事務作業が発生。最新ステータスが共有されず、営業は「請求出せていますか？」と1日3回チャットで確認。

**After：**  
AppSheetアプリ上で案件から請求までを一貫管理し、1件当たり作業時間を平均24分に短縮（約25%削減）。発行済み請求は自動で共有ドライブへ保存され、請求状況ビューで営業が即確認できる状態を想定します。

## 3. コース名

**AppSheetで営業事務の"紙地獄"を脱出！ゼロから作る見積・請求アプリ**

## 4. 改善方針

Googleスプレッドシートベースの5つのテーブル（顧客・社員・サービス・注文・注文詳細）を使い、AppSheetのみで10分以内の動画5本に分けて開発プロセスを解説します。ノーコード前提で、外部API連携やApps Script開発は扱いません。各回で「なぜそう設計するか」を先に示し、データモデリング→UI整備→自動ドキュメント→アクション→オートメーションの流れで段階的に組み上げます。

## 5. データ構造（5テーブル）

### 5.1 顧客テーブル
- ID顧客（主キー、自動生成UUID）
- 顧客名（Text）
- カテゴリ（Enum: 法人 / 個人 / 官公庁）
- 住所（Address）
- 電話（Phone）
- メール（Email）

### 5.2 社員テーブル
- ID社員（主キー、自動生成UUID）
- 社員名（Text）
- 役職（Enum: 営業 / 営業事務 / 管理職）
- 電話（Phone）
- メール（Email）

### 5.3 サービステーブル
- IDサービス（主キー、自動生成UUID）
- サービス名（Text）
- 価格（Price）
- 詳細（LongText）

### 5.4 注文テーブル（親テーブル）
- ID注文（主キー、自動生成UUID）
- ID社員（Ref → 社員テーブル）
- ID顧客（Ref → 顧客テーブル）
- ステータス（Enum: 見積中 / 見積発行済 / 受注 / 請求済 / 入金済）
- 発行日（Date）
- 納期（Date）
- 見積番号（Formula: `CONCATENATE("MT", TEXT([発行日], "YYYYMMDD"), "-", RIGHT("0" & (COUNT(SELECT(注文[_ROWNUMBER], [発行日] = [_THISROW].[発行日])) + 1), 2))`）
- 請求番号（Formula: `SUBSTITUTE([見積番号], "MT", "SK")`）
- 納入単価合計（Virtual: `SUM(注文詳細[納入金額])`）
- 消費税（Formula: `[納入単価合計金額] * 0.1`）
- 合計金額（Formula: `[納入単価合計金額] + [消費税]`）
- 見積書発行フラグ（Yes/No、初期値False）
- 請求書発行フラグ（Yes/No、初期値False）
- 一覧出力フラグ（Yes/No、初期値False）

### 5.5 注文詳細テーブル（子テーブル）
- ID注文詳細（主キー、自動生成UUID）
- ID注文（Ref → 注文テーブル）
- IDサービス（Ref → サービステーブル）
- 数量（Number）
- 単価（Price、Initial Value: `[IDサービス].[価格]`）
- 納入金額（Formula: `[数量] * [単価]`）

## 6. 動画タイトル一覧（各回10分想定）

1. **見積・請求アプリの全体像とAppSheetの基本**
2. **"分けてつなぐ"で迷わない！テーブル設計と参照関係の基本**
3. **使いやすいアプリは見た目で決まる！フォームと一覧ビューの整え方**
4. **請求書の自動出力＆作成ボタンをまとめて実装する**
5. **請求ステータスを自動で変える！オートメーションで運用効率UP**

## 7. アクション構成（3つ）

### 7.1 見積書発行アクション
1. ボタンをクリック → 「見積書発行フラグ」をTrueに設定
2. オートメーション（Data Change: 注文テーブル）がトリガー
3. Google Docsテンプレートから見積書PDFを生成
4. 指定フォルダに保存
5. フラグをFalseに戻す

### 7.2 請求書発行アクション
1. ボタンをクリック → 「請求書発行フラグ」をTrueに設定
2. オートメーション（Data Change: 注文テーブル）がトリガー
3. Google Docsテンプレートから請求書PDFを生成
4. 指定フォルダに保存
5. フラグをFalseに戻す

### 7.3 一覧出力アクション
1. ボタンをクリック → 「一覧出力フラグ」をTrueに設定
2. オートメーション（Data Change: 注文テーブル）がトリガー
3. 注文詳細データをExcel形式で出力
4. 指定フォルダに保存
5. フラグをFalseに戻す

## 8. 重要な数式まとめ

### 見積番号の自動生成
```
CONCATENATE("MT", TEXT([発行日], "YYYYMMDD"), "-", RIGHT("0" & (COUNT(SELECT(注文[_ROWNUMBER], [発行日] = [_THISROW].[発行日])) + 1), 2))
```
- 例: MT20251013-01（2025年10月13日の1件目）

### 請求番号の自動生成
```
SUBSTITUTE([見積番号], "MT", "SK")
```
- 例: SK20251013-01

### 納入単価合計
```
SUM(注文詳細[納入金額])
```

### 消費税
```
[納入単価合計金額] * 0.1
```

### 合計金額
```
[納入単価合計金額] + [消費税]
```

### 注文詳細の納入金額
```
[数量] * [単価]
```

## 9. ディレクトリ構造

```
AppSheetで営業事務の"紙地獄"を脱出！ゼロから作る見積・請求アプリ/
├── README.md（研修の目的・準備物・進め方）
├── demo_data/
│   ├── 顧客.csv
│   ├── 社員.csv
│   ├── サービス.csv
│   ├── 注文.csv
│   └── 注文詳細.csv
├── 動画1_見積・請求アプリの全体像とAppSheetの基本/
│   ├── script.md（台本）
│   ├── materials.html（literary-editorial-templateデザイン準拠の教材）
│   └── demo_code/（必要に応じて）
├── 動画2_"分けてつなぐ"で迷わない！テーブル設計と参照関係の基本/
│   ├── script.md
│   ├── materials.html
│   └── demo_code/
├── 動画3_使いやすいアプリは見た目で決まる！フォームと一覧ビューの整え方/
│   ├── script.md
│   ├── materials.html
│   └── demo_code/
├── 動画4_請求書の自動出力＆作成ボタンをまとめて実装する/
│   ├── script.md
│   ├── materials.html
│   └── demo_code/
└── 動画5_請求ステータスを自動で変える！オートメーションで運用効率UP/
    ├── script.md
    ├── materials.html
    └── demo_code/
```

## 10. 各動画の学習目標

### 動画1: 見積・請求アプリの全体像とAppSheetの基本（10分）
- AppSheetの概要と他ツールとの違いを理解
- Googleスプレッドシートとの連携方法を学ぶ
- AppSheet Editorの基本画面（Data、UX、Actions、Automations）を把握
- 本コースで作成するアプリの全体像を確認

### 動画2: "分けてつなぐ"で迷わない！テーブル設計と参照関係の基本（10分）
- 5つのテーブルの役割と関係性を理解
- 参照型（Ref）を使ったテーブル間の接続方法を学ぶ
- 親子関係（注文と注文詳細）の設定方法を習得
- 自動生成される仮想カラムの活用方法を理解

### 動画3: 使いやすいアプリは見た目で決まる！フォームと一覧ビューの整え方（10分）
- Form ViewとTable/Card Viewの違いを理解
- 入力フォームのカスタマイズ方法を学ぶ
- 一覧画面のフィルタとソート設定を習得
- 使いやすいUI/UXのベストプラクティスを理解

### 動画4: 請求書の自動出力＆作成ボタンをまとめて実装する（10分）
- Google Docsテンプレートの作成方法を学ぶ
- AppSheetのプレースホルダー（<<[カラム名]>>）の使い方を習得
- PDF出力の設定方法を理解
- テンプレートの変数展開のデバッグ方法を学ぶ

### 動画5: 請求ステータスを自動で変える！オートメーションで運用効率UP（10分）
- アクション（Action）とオートメーション（Automation）の違いを理解
- フラグを使ったトリガー設計を学ぶ
- 見積書・請求書発行の自動化フローを構築
- 一覧出力の自動化を実装
- エラーハンドリングとデバッグ方法を習得

## 11. 受講者への事前準備

- Googleアカウント（Gmail）
- Google Driveのフォルダ（教材データ保存用）
- AppSheetアカウント（Googleアカウントで無料登録）
- demo_dataフォルダ内の5つのCSVファイルをGoogleスプレッドシートにインポート

## 12. よくある質問（FAQ）

**Q1: AppSheetは無料で使えますか？**  
A1: 個人利用や小規模チーム（10ユーザーまで）であれば無料プランで十分利用できます。本コースの内容も無料プランで実装可能です。

**Q2: プログラミング知識は必要ですか？**  
A2: 基本的なExcel関数（SUMやCONCATENATEなど）が理解できれば問題ありません。プログラミング経験は不要です。

**Q3: スマホアプリとして配布できますか？**  
A3: はい、AppSheetで作成したアプリはiOSとAndroidの両方で動作します。AppSheetアプリをインストールすることで、モバイルからもアクセスできます。

**Q4: 既存のExcelデータを移行できますか？**  
A4: はい、ExcelファイルをGoogleスプレッドシートにインポートすることで、既存データをそのまま活用できます。

**Q5: オフライン環境でも使えますか？**  
A5: AppSheetのモバイルアプリは「Sync」機能により、オフライン時でもデータ入力が可能です。オンラインに復帰したタイミングで自動的に同期されます。

## 13. 学習のポイント

1. **データ設計が最重要**: テーブル構造とリレーションシップを正しく設計することで、後の作業が大幅に楽になります。
2. **フラグを使ったトリガー設計**: 直接的なボタンアクションではなく、フラグを介することで柔軟な自動化が実現できます。
3. **Virtual Columnの活用**: 計算式やリレーションシップから自動生成されるカラムを活用することで、データの整合性が保たれます。
4. **テンプレート設計の重要性**: Google Docsテンプレートの設計が、出力されるPDFの品質を左右します。
5. **段階的な構築**: 一度に全機能を実装するのではなく、動画の順序通りに段階的に構築することで、理解が深まります。

## 14. 応用事例

本コースで学んだ内容は、以下のような業務アプリにも応用できます：

- 勤怠管理アプリ（社員・勤怠記録・休暇申請）
- 在庫管理アプリ（商品・入出庫・棚卸）
- 顧客管理アプリ（顧客・商談・活動記録）
- 工事管理アプリ（案件・工程・作業報告）
- 設備点検アプリ（設備・点検項目・点検記録）

## 15. 参考リンク

- [AppSheet公式ドキュメント](https://help.appsheet.com/)
- [AppSheet Community Forum](https://community.appsheet.com/)
- [AppSheet YouTube Channel](https://www.youtube.com/c/AppSheet)
- [Googleスプレッドシート関数リファレンス](https://support.google.com/docs/table/25273)

---

**本コースの目標**: 10分×5本の動画を通じて、営業事務の"紙地獄"から脱出し、AppSheetで実用的な見積・請求アプリを自作できるようになること。
