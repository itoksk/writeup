# 動画4: 出力結果を左右する！必要情報を抽出するプロンプト作成術

## 📝 セリフと流れ（10分構成）

### 🎬 オープニング（0:00-1:00）
**セリフ**:
「OCRで文字は取り出せました。しかし、それはまだ『素材』に過ぎません。この素材を『料理』し、意味のある『情報』に変えるシェフがChatGPTです。そして、そのシェフに最高の仕事をさせるための指示書が『プロンプト』。

この回では、AIに『魂』を吹き込み、ただのチャットボットをあなたの意図を100%理解する超優秀な部下へと変貌させる、プロンプト設計の核心理論を学びます。

たった一つのプロンプトの違いで、AIの出力結果は天と地ほど変わります。この10分で、プロレベルのプロンプト設計技術を身につけましょう！」

**画面表示**: 悪いプロンプトと良いプロンプトの出力結果比較

---

### 💡 プロンプトの威力：実演比較（1:00-3:00）
**セリフ**:
「まず、プロンプトの威力を実際に見てみましょう。

悪い例から。『この注文書から情報を抜き出して』という曖昧な指示でChatGPTに依頼します。

結果を見てください。出力形式がバラバラで、必要な情報が漏れ、余計な説明まで含まれています。これでは、プログラムで自動処理することは不可能です。

では、良い例を試してみます。『営業事務担当者として、指定されたJSON形式で8項目を抽出』という具体的な指示です。

結果は歴然です。一貫した出力形式で、必要な情報がすべて含まれ、プログラムで即座に処理できる形になっています。

この違いを生むのが、プロンプト設計の技術なのです。同じAI、同じデータなのに、指示の仕方一つで、使い物にならない結果から、プロレベルの精度まで変わります。」

**画面表示**: 
- ChatGPT Web版での実際の比較デモ
- 悪い例の出力結果
- 良い例の出力結果
- 違いの明確な対比

---

### 🏗️ プロンプト設計の5原則（3:00-5:00）
**セリフ**:
「効果的なプロンプト設計には、5つの原則があります。

1つ目、『役割の明確化』。AIに具体的な役割を与えます。『営業事務担当者として』『経験豊富な専門家として』など、AIの『人格』を定義することで、より適切な回答を引き出せます。

2つ目、『明確な指示』。抽出する項目を具体的にリストアップします。『情報を抜き出して』ではなく、『会社名、担当者名、商品名、数量、単価、合計金額、納期、連絡先を抽出』と明確に指定します。

3つ目、『出力形式の固定』。JSON形式など、プログラムで処理しやすい形式を指定します。これにより、後続の自動処理が可能になります。

4つ目、『制約条件の設定』。不明な場合の対応、データ形式の統一ルールを明記します。『情報が見つからない場合はnullを設定』『数量・金額は数値のみ抽出』など。

5つ目、『例外処理の考慮』。複数商品、手書き文字など、現実的なケースに対応する指示を含めます。」

**画面表示**: 
- 5原則の図解
- 各原則の具体例
- Before/Afterの改善例

---

### 📝 完成版プロンプトテンプレートの解説（5:00-7:00）
**セリフ**:
「それでは、今回のシステム用に最適化された、完成版プロンプトテンプレートを詳しく解説します。

冒頭の役割定義。『あなたは優秀な営業事務担当者です』でAIの立場を明確化。

抽出する情報セクションでは、8つの項目を明確にリスト化。会社名から連絡先まで、必要な情報を漏れなく指定しています。

出力形式セクションが最重要です。JSON形式を指定し、各フィールドの構造を明確に定義。特に、itemsを配列形式にすることで、複数商品にも対応できます。

制約条件セクションで、品質を保つためのルールを設定。null値の扱い、数値形式の統一、日付形式の指定など、プログラムでの処理を考慮した細かな指示を含めています。

最後に、実際のOCRテキストを変数で挿入する構造になっています。このテンプレートをコピーして、${ocrText}部分を実際のテキストに置き換えるだけで使用できます。」

**画面表示**: 
- 完成プロンプトテンプレートの表示
- 各セクションの詳細説明
- 重要部分のハイライト

---

### 🧪 サンプルテキスト8種類での実証テスト（7:00-8:30）
**セリフ**:
「API実装前に、必ずChatGPT Web版で実証テストを行いましょう。今回は8つの異なるサンプルテキストを用意し、プロンプトの効果を徹底検証します。

まず、サンプル1：標準的な注文書で基本性能をテスト。完璧なJSON形式で、必要な情報がすべて抽出されています。

次に、サンプル2：手書き混在のOCR誤認識テキスト。`543l`が`5431`に、`l70,OOO`が`170,000`に自動修正されています。AIが文脈から正しい数字を推測しているのが分かります。

サンプル6：情報不足の注文書でも、利用可能な情報は確実に抽出し、不明な項目はnullで適切に処理されています。

サンプル7：製造業特化テキストでは、図面番号、材質（SUS304、S45C）も正確に認識。専門用語にも対応できています。

このような多様なケースをテストすることで、実際の運用で発生する様々な状況に対応できるプロンプトが完成します。」

**画面表示**: 
- 8つのサンプルテキスト一覧
- 各サンプルでの抽出結果比較
- 誤認識修正の実例
- 業界特化対応の実証

---

### 🚀 実践的テスト手順とトラブルシューティング（8:30-9:30）
**セリフ**:
「実際の運用では、4段階のテスト手順をお勧めします。

1. 基本テスト：サンプル1で標準的なケースの動作確認。JSON形式の正確性、必須項目の漏れをチェック。

2. 耐久性テスト：サンプル2の誤認識、サンプル6の情報不足で、エラー処理の頑健性を確認。

3. 応用テスト：サンプル3-5の複数ページ、サンプル7-8の業界特化で専門対応を検証。

4. 品質評価：各サンプルで抽出精度、処理速度、エラー処理の適切性を定量的に測定。

よくあるトラブルと対策も覚えておきましょう。

金額が正しく抽出されない場合：制約条件に『カンマは除去』『数値のみ抽出』を追加。
日付形式がバラバラな場合：『YYYY-MM-DD形式で統一』を明記。
複数商品で漏れが発生：『配列に全て含める』を強調。

段階的改善も重要です。いきなり完璧を目指さず、Phase 1で80%、Phase 2で90%、Phase 3で95%精度と段階的に向上させることで、確実にシステムを完成させられます。」

**画面表示**: 
- 4段階テスト手順の図解
- トラブル事例と対策一覧
- 段階的改善の成果グラフ
- 品質評価指標の表示

---

### 🔚 まとめと次回予告（9:30-10:00）
**セリフ**:
「お疲れさまでした！これで、AIから正確で一貫した結果を引き出すプロンプトが完成しました。

今回作成したプロンプトテンプレートは、そのままコピー&ペーストで使用できます。OCRテキストを変数部分に挿入するだけで、高精度な情報抽出が可能です。

次回の動画5では、このプロンプトを使って、実際にGoogle Apps ScriptからChatGPT APIを呼び出すシステムを構築します。

『GASからChatGPTを動かす！注文書から会社名と数量を抜き出す実践コード』では、API連携の実装から、エラーハンドリング、品質チェックまで、統合システムを完成させます。

プロンプトという『魔法の呪文』を、実際のシステムで動かしましょう！理論から実践へ、いよいよ本格的な自動化システムの構築に入ります。」

**画面表示**: 
- 今回の成果まとめ
- 完成プロンプトテンプレート
- 次回動画のプレビュー

---

## 📋 撮影チェックリスト

### 事前準備
- [ ] ChatGPT Web版のアカウント準備
- [ ] 8つのサンプルテキストの準備と動作確認
- [ ] 悪い例・良い例のプロンプト準備
- [ ] 完成テンプレートの最終確認
- [ ] 各サンプルでの期待される正解データ準備

### 撮影時の注意点
- [ ] プロンプトの重要性を強調
- [ ] 実際の比較デモで効果を実証
- [ ] コピー&ペースト可能な形で提供
- [ ] 段階的改善の重要性を強調

### 必要な画面録画
- [ ] 悪いプロンプトでの結果
- [ ] 良いプロンプトでの結果
- [ ] プロンプト設計の5原則説明
- [ ] 8つのサンプルテキストでの実証テスト
- [ ] 誤認識修正の実例
- [ ] 4段階テスト手順の実演
- [ ] トラブルシューティング例