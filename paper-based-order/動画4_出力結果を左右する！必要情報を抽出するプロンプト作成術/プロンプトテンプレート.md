# 動画4: プロンプトテンプレート集

## 🎯 基本プロンプトテンプレート（完成版）

### 主要プロンプト：注文書情報抽出用
```
あなたは優秀な営業事務担当者です。
以下のOCRで抽出されたテキストから、注文書の重要情報を抽出してください。

# 抽出する情報
- 会社名
- 担当者名  
- 商品名・品番
- 数量
- 単価
- 合計金額
- 納期
- 連絡先（メールアドレス、電話番号）

# 出力形式
必ず以下のJSON形式で回答してください：
{
  "company": "会社名",
  "contact_name": "担当者名",
  "contact_email": "メールアドレス",
  "contact_phone": "電話番号",
  "items": [
    {
      "name": "商品名",
      "code": "品番", 
      "quantity": 数量,
      "unit_price": 単価,
      "subtotal": 小計
    }
  ],
  "total_amount": 合計金額,
  "delivery_date": "納期",
  "order_date": "注文日",
  "notes": "特記事項"
}

# 制約条件
- 情報が見つからない場合は null を設定
- 数量・金額は数値のみ抽出（カンマは除去）
- 日付は YYYY-MM-DD 形式で統一
- 会社名は「株式会社」「有限会社」等の法人格も含める
- 複数商品がある場合は配列に全て含める
- 不明確な情報は推測せず null とする

# 抽出対象テキスト
${ocrText}
```

---

## 📄 テスト用サンプルテキスト集

### サンプル1: 標準的な注文書（OCR抽出後テキスト）
```
注文書

株式会社山田商事
〒100-0001 東京都千代田区千代田1-1-1
TEL: 03-1234-5678
Email: yamada@yamada-corp.co.jp

注文日: 2024/12/15
納期: 2024/12/25
担当者: 田中太郎

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
商品名         品番      数量    単価      小計
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
オフィスチェア   OC-2024   10個   15,000円   150,000円
デスクライト     DL-100    5個    8,500円    42,500円
ファイルキャビネット FC-300  2個   25,000円    50,000円
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

合計金額: 242,500円（税込）

特記事項:
・年末納期厳守
・組立設置サービス込み
・請求書は月末締め翌月末払い

以上
```

### サンプル2: 手書き混在の注文書（OCR誤認識含む）
```
発注書

有限会社 鈴木工業
住所: 大阪府大阪市北区梅田2-2-2
電話: 06-9876-543l (←「1」が「l」に誤認識)
担当: 佐藤花子

発注日: 2024/l2/20 (←「1」が「l」に誤認識)
希望納期: 2024年12月30目 (←「日」が「目」に誤認識)

商品リスト:
・スチール棚 S丁-200 x 3台 @20,OOO円 = 60,OOO円 (←「T」「O」に誤認識)
・作業台 WB-lOO x 2台 @35,OOO円 = 70,OOO円 (←「l」「O」に誤認識)
・工具箱 TB-50 x 5個 @8,OOO円 = 40,OOO円 (←「O」に誤認識)

総計: l70,OOO円 (税別) (←「1」「O」に誤認識)

※至急対応お願いします
```

### サンプル3: 複数ページの注文書（1ページ目）
```
株式会社グリーンテック 御中

発注書 No.2024-1215

発注者情報:
会社名: 株式会社ブルーオーシャン
住所: 〒150-0001 東京都渋谷区神宮前3-3-3
TEL: 03-5555-1111
FAX: 03-5555-2222
Email: order@blue-ocean.co.jp
担当者: 営業部 高橋次郎

発注日: 2024年12月15日
希望納期: 2025年1月10日

ページ 1/3
```

### サンプル4: 複数ページの注文書（2ページ目 - 商品明細）
```
ページ 2/3

商品明細

No. 商品名                    品番        数量    単価        金額
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1   プリンター複合機          MP-500      3台     120,000     360,000
2   プリンター用紙 A4         PP-A4-500   50箱    1,200       60,000
3   プリンター用紙 A3         PP-A3-250   20箱    2,400       48,000
4   トナーカートリッジ黒      TC-BK       15個    8,500       127,500
5   トナーカートリッジカラー  TC-COLOR    15セット 12,000      180,000
6   メンテナンスキット        MK-100      3個     15,000      45,000
7   延長保証サービス          EW-3Y       3契約   25,000      75,000

小計: 895,500円

消費税(10%): 89,550円
```

### サンプル5: 複数ページの注文書（3ページ目 - 最終）
```
ページ 3/3

合計金額: 985,050円（税込）

支払条件: 月末締め翌月末払い
配送先: 本社住所と同じ
配送時間: 平日9:00-17:00

特記事項:
・設置・設定作業込み
・既存機器の引き取り希望
・担当者立会い必須
・マニュアル・保証書の用意

承認者: 代表取締役 田中一郎 印

以上

━━━━━━━━━━━━━━━━━━━━━━━━
株式会社ブルーオーシャン
営業部 高橋次郎
直通: 03-5555-1234
携帯: 090-1234-5678
━━━━━━━━━━━━━━━━━━━━━━━━
```

### サンプル6: 不完全・情報不足の注文書
```
注文書

田中商店

商品:
・椅子 10脚
・机 5台

合計: 15万円

12月中にお願いします。

連絡先: 090-xxxx-xxxx
```

### サンプル7: 製造業特化の部品発注書
```
部品発注書

発注No: PO-2024-1215-001

発注先: 株式会社精密パーツ
発注者: 株式会社アルファ製作所
        技術部 調達課 山田太郎
        TEL: 042-123-4567
        Email: yamada@alpha-mfg.co.jp

発注日: 2024/12/15
納期: 2025/01/15

┌─────────────────────────────────────────┐
│品番      │品名              │材質      │数量│単価  │金額    │
├─────────────────────────────────────────┤
│AB-001    │ボルト M8×20      │SUS304    │1000│50    │50,000  │
│CD-002    │ワッシャー φ8     │SS400     │1000│10    │10,000  │
│EF-003    │プレート t=2.0    │A5052     │100 │800   │80,000  │
│GH-004    │シャフト φ20×100 │S45C      │50  │1,200 │60,000  │
└─────────────────────────────────────────┘

小計: 200,000円
消費税: 20,000円
合計: 220,000円

図面番号: DRW-2024-1215
検査基準: JIS B 0401
ロット管理: 必要
```

### サンプル8: 飲食業の仕入れ発注書
```
食材発注書

仕入先: 株式会社フレッシュフーズ
発注者: レストラン美味亭
        料理長 佐藤シェフ
        TEL: 03-7777-8888

発注日: 2024年12月15日
納期: 2024年12月18日 午前中必着

商品名              産地      数量    単価    小計      保存
─────────────────────────────────────────
国産牛サーロイン    宮崎県    2kg     4,000   8,000     冷蔵
天然真鯛            愛媛県    3匹     1,500   4,500     冷蔵  
有機野菜セット      千葉県    1箱     2,500   2,500     冷蔵
国産小麦粉          北海道    10kg    800     8,000     常温
生クリーム35%       北海道    6本     450     2,700     冷蔵
卵（赤玉Lサイズ）   茨城県    5パック 380     1,900     冷蔵

合計: 27,600円（税込）

特記事項:
・消費期限3日以上のもの
・アレルギー表示確認済み
・配送時間厳守（仕込み時間の関係上）
```

## 🧪 プロンプトテスト手順

### 1. 基本テスト
```
1. サンプル1（標準）でプロンプトをテスト
2. 抽出精度を確認
3. JSON形式の正確性をチェック
4. 必須項目の漏れがないか確認
```

### 2. 耐久性テスト
```
1. サンプル2（誤認識）で頑健性をテスト
2. サンプル6（情報不足）で最低限抽出をテスト
3. エラー処理の動作を確認
```

### 3. 応用テスト
```
1. サンプル3-5（複数ページ）で統合処理をテスト
2. サンプル7-8（業界特化）で専門対応をテスト
3. カスタマイズの効果を測定
```

### 4. 品質評価
```
各サンプルで以下を評価:
- 抽出精度（正解率）
- 処理速度
- エラー処理の適切性
- JSON形式の妥当性
```

## 📝 応用プロンプト：ケース別対応

### 1. 手書き文字が多い場合の特化プロンプト
```
あなたは手書き文字の読み取りに特化した事務スペシャリストです。
OCRで抽出されたテキストには手書き文字由来の誤認識が含まれています。
以下の点に注意して情報を抽出してください：

# 手書き文字の補正ルール
- 数字の「1」と「l」の区別
- 「0」と「O」の区別  
- カタカナ「ツ」と「シ」の区別
- 漢字の旧字体・略字の現代表記への変換

# 推測ロジック
- 文脈から判断して最も適切な文字に補正
- 金額計算の整合性チェック
- 一般的な商品名・会社名との照合

（以下、基本プロンプトと同じ形式）
```

### 2. 複数ページPDFの統合プロンプト
```
あなたは複数ページの注文書を統合処理する専門家です。
提供されるテキストは複数ページから抽出された内容が含まれています。

# 統合処理ルール
- 1ページ目：会社情報、注文日、納期等の基本情報
- 2ページ目以降：商品明細
- 最終ページ：合計金額、特記事項

# ページ判定の手がかり
- 「ページ」「P.」「1/2」等のページ番号
- 「小計」「合計」「総額」等の集計表示
- 「以上」「記」等の文書終了マーカー

（以下、基本プロンプトと同じ形式）
```

### 3. エラー処理・品質チェック用プロンプト
```
あなたは抽出データの品質管理担当者です。
以下のデータ品質チェックを実行してください：

# 必須項目チェック
- 会社名：必須（null不可）
- 合計金額：必須（数値である事）
- 商品情報：最低1件必須

# データ整合性チェック
- 小計の合計 = 総額
- 数量 × 単価 = 小計
- 日付の妥当性（未来日付チェック）

# 品質スコア
データの信頼度を0-100で評価し、以下を追加：
{
  ...（通常のJSON）,
  "quality_score": 85,
  "quality_issues": ["納期が過去日付", "電話番号が不完全"],
  "confidence_level": "high"
}
```

## 🔧 デバッグ用プロンプト

### OCRテキスト品質確認用
```
以下のOCRテキストの品質を評価してください：

# 評価項目
1. 文字認識精度（0-100%）
2. レイアウト保持率（0-100%）
3. 主要情報の可読性

# 出力形式
{
  "ocr_quality": {
    "text_accuracy": 85,
    "layout_preservation": 70,
    "key_info_readability": 90
  },
  "issues": [
    "手書き部分の認識率が低い",
    "表の罫線が文字と混在"
  ],
  "recommendations": [
    "画像の解像度を上げる",
    "表部分の前処理を追加"
  ]
}

# 対象テキスト
${ocrText}
```

## 📊 効果測定用プロンプト

### 抽出精度測定用
```
抽出結果と元データを比較し、精度を測定してください：

# 正解データ
${correctData}

# 抽出結果  
${extractedData}

# 評価出力
{
  "accuracy_by_field": {
    "company": 100,
    "total_amount": 95,
    "items": 85
  },
  "overall_accuracy": 93,
  "error_analysis": [
    {
      "field": "contact_phone",
      "expected": "03-1234-5678",
      "actual": "03-1234-567B",
      "error_type": "OCR誤認識"
    }
  ]
}
```

## 🚨 緊急時対応プロンプト

### 処理失敗時の最低限抽出用
```
通常の抽出処理が失敗しました。
以下の最低限の情報だけでも抽出してください：

# 最優先抽出項目（必須）
1. 会社名（曖昧でも可）
2. 合計金額（概算でも可）
3. 大まかな商品内容

# 簡易出力形式
{
  "emergency_extraction": true,
  "company_guess": "○○会社",
  "amount_guess": 50000,
  "items_summary": "オフィス用品",
  "confidence": "low",
  "manual_review_required": true
}

# 対象テキスト
${ocrText}
```

## 🎨 カスタマイズ例：業界特化

### 製造業向けプロンプト
```
製造業の部品発注書として以下の追加情報を抽出：

# 製造業特有項目
- 図面番号
- 材質・規格
- 検査基準
- 納期区分（通常/急ぎ/至急）
- ロット番号

# 業界用語の解釈
- 「SUS304」→ ステンレス鋼
- 「t=1.5」→ 板厚1.5mm
- 「□50」→ 角パイプ50mm角
```

### 飲食業向けプロンプト  
```
飲食店の仕入れ発注書として以下の追加情報を抽出：

# 飲食業特有項目
- 消費期限・賞味期限
- 保存方法（冷蔵/冷凍/常温）
- 産地情報
- アレルギー表示
- 容量・重量

# 単位の標準化
- 「1ケース」→ 個数に換算
- 「1kg」→ グラム換算
- 「1パック」→ 個数確認
```

## 💡 プロンプト改善のコツ

### 1. 段階的改善アプローチ
```
Phase 1: 基本抽出（80%精度目標）
Phase 2: エラーパターン特定・対策追加（90%精度目標）
Phase 3: 業界特化・例外処理追加（95%精度目標）
```

### 2. A/Bテスト用バリエーション
- 詳細指示 vs 簡潔指示
- 厳格モード vs 柔軟モード
- 構造化出力 vs 自然言語出力

### 3. フィードバックループ
```
抽出結果 → 人間確認 → エラーパターン分析 → プロンプト改善 → 再テスト
```