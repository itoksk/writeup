<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>動画4: 出力結果を左右する！必要情報を抽出するプロンプト作成術</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .section h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .section h3 {
            color: #34495e;
            font-size: 1.5em;
            margin: 20px 0 15px 0;
        }
        
        .prompt-showcase {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        
        .bad-prompt, .good-prompt {
            padding: 25px;
            border-radius: 10px;
        }
        
        .bad-prompt {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }
        
        .good-prompt {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
        }
        
        .prompt-template {
            background: #2d3436;
            color: #ddd;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
            border-left: 4px solid #74b9ff;
        }
        
        .json-example {
            background: #263238;
            color: #4caf50;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .principle-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .principle-card {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .principle-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .testing-workflow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 30px;
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            border-radius: 15px;
        }
        
        .workflow-step {
            text-align: center;
            flex: 1;
        }
        
        .workflow-arrow {
            font-size: 2em;
            color: #2c3e50;
            margin: 0 20px;
        }
        
        .highlight {
            background: linear-gradient(120deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .success-box {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .tip-box {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        ul {
            margin: 20px 0;
            padding-left: 30px;
        }
        
        li {
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .prompt-showcase {
                grid-template-columns: 1fr;
            }
            
            .testing-workflow {
                flex-direction: column;
            }
            
            .workflow-arrow {
                transform: rotate(90deg);
                margin: 20px 0;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🎯 動画4: 出力結果を左右する！必要情報を抽出するプロンプト作成術</h1>
            <p>効果的なプロンプト設計とChatGPT API連携</p>
        </header>

        <section class="section">
            <h2>🎯 学習目標</h2>
            <ul>
                <li>プロンプトがAI出力結果に与える決定的な影響を理解する</li>
                <li>注文書情報抽出に最適化されたプロンプトテンプレートを習得する</li>
                <li>JSON形式での構造化出力の重要性と実装方法を学ぶ</li>
                <li>8種類のサンプルテキストでの実証テスト手法を身につける</li>
                <li>4段階テスト手順とトラブルシューティング方法を理解する</li>
            </ul>
        </section>

        <section class="section">
            <h2>💡 プロンプトの威力：Before / After</h2>
            <div class="prompt-showcase">
                <div class="bad-prompt">
                    <h3>❌ 悪い例：曖昧なプロンプト</h3>
                    <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 5px; margin: 10px 0;">
                        <em>"この注文書から情報を抜き出して"</em>
                    </div>
                    <h4>結果：</h4>
                    <ul>
                        <li>出力形式がバラバラ</li>
                        <li>必要な情報が漏れる</li>
                        <li>余計な情報も含まれる</li>
                        <li>プログラムで処理困難</li>
                    </ul>
                </div>
                <div class="good-prompt">
                    <h3>✅ 良い例：具体的なプロンプト</h3>
                    <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 5px; margin: 10px 0;">
                        <em>"営業事務担当者として、指定されたJSON形式で8項目を抽出"</em>
                    </div>
                    <h4>結果：</h4>
                    <ul>
                        <li>一貫した出力形式</li>
                        <li>必要な情報を確実に抽出</li>
                        <li>プログラムで自動処理可能</li>
                        <li>高い精度と再現性</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>📝 完成版プロンプトテンプレート</h2>
            <h3>注文書情報抽出用（コピー&ペースト対応）</h3>
            
            <div class="prompt-template">
あなたは優秀な営業事務担当者です。
以下のOCRで抽出されたテキストから、注文書の重要情報を抽出してください。

# 抽出する情報
- 会社名
- 担当者名  
- 商品名・品番
- 数量
- 単価
- 合計金額
- 納期
- 連絡先（メールアドレス、電話番号）

# 出力形式
必ず以下のJSON形式で回答してください：
{
  "company": "会社名",
  "contact_name": "担当者名",
  "contact_email": "メールアドレス",
  "contact_phone": "電話番号",
  "items": [
    {
      "name": "商品名",
      "code": "品番", 
      "quantity": 数量,
      "unit_price": 単価,
      "subtotal": 小計
    }
  ],
  "total_amount": 合計金額,
  "delivery_date": "納期",
  "order_date": "注文日",
  "notes": "特記事項"
}

# 制約条件
- 情報が見つからない場合は null を設定
- 数量・金額は数値のみ抽出（カンマは除去）
- 日付は YYYY-MM-DD 形式で統一
- 会社名は「株式会社」「有限会社」等の法人格も含める
- 複数商品がある場合は配列に全て含める
- 不明確な情報は推測せず null とする

# 抽出対象テキスト
${ocrText}
            </div>
        </section>

        <section class="section">
            <h2>🏗️ プロンプト設計の5原則</h2>
            
            <div class="principle-grid">
                <div class="principle-card">
                    <div class="principle-icon">🎭</div>
                    <h3>1. 役割の明確化</h3>
                    <p>「営業事務担当者として」など、AIに具体的な役割を与える</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">📋</div>
                    <h3>2. 明確な指示</h3>
                    <p>抽出する項目を具体的にリストアップして指定</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">📊</div>
                    <h3>3. 出力形式の固定</h3>
                    <p>JSON形式など、プログラムで処理しやすい形式を指定</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">⚖️</div>
                    <h3>4. 制約条件の設定</h3>
                    <p>不明な場合の対応、データ形式の統一ルールを明記</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">🔍</div>
                    <h3>5. 例外処理の考慮</h3>
                    <p>複数商品、手書き文字など、現実的なケースに対応</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>📄 テスト用サンプルテキスト8種類</h2>
            <h3>多様なケースでの実証テスト</h3>
            
            <div class="principle-grid">
                <div class="principle-card">
                    <div class="principle-icon">📋</div>
                    <h3>サンプル1: 標準</h3>
                    <p>理想的なフォーマットの注文書</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">✍️</div>
                    <h3>サンプル2: 手書き混在</h3>
                    <p>OCR誤認識を含む現実的なケース</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">📄</div>
                    <h3>サンプル3-5: 複数ページ</h3>
                    <p>基本情報・明細・合計の分離</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">⚠️</div>
                    <h3>サンプル6: 情報不足</h3>
                    <p>最低限の情報のみの注文書</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">🏭</div>
                    <h3>サンプル7: 製造業</h3>
                    <p>図面番号・材質等の専門項目</p>
                </div>
                <div class="principle-card">
                    <div class="principle-icon">🍽️</div>
                    <h3>サンプル8: 飲食業</h3>
                    <p>産地・保存方法等の食品項目</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>🧪 4段階テスト手順</h2>
            <h3>段階的品質確認プロセス</h3>
            
            <div class="testing-workflow">
                <div class="workflow-step">
                    <strong>1️⃣ 基本テスト</strong><br>
                    サンプル1で標準的<br>ケースの動作確認
                </div>
                <div class="workflow-arrow">→</div>
                <div class="workflow-step">
                    <strong>2️⃣ 耐久性テスト</strong><br>
                    サンプル2,6で<br>エラー処理確認
                </div>
                <div class="workflow-arrow">→</div>
                <div class="workflow-step">
                    <strong>3️⃣ 応用テスト</strong><br>
                    サンプル3-5,7-8で<br>複雑ケース検証
                </div>
                <div class="workflow-arrow">→</div>
                <div class="workflow-step">
                    <strong>4️⃣ 品質評価</strong><br>
                    抽出精度・処理速度<br>の定量的測定
                </div>
            </div>

            <div class="success-box">
                <h3>💡 段階的テストのメリット</h3>
                <ul>
                    <li><strong>確実性:</strong> 段階的に品質を確認・向上</li>
                    <li><strong>効率性:</strong> 問題の早期発見と対策</li>
                    <li><strong>網羅性:</strong> 様々なケースに対応可能</li>
                    <li><strong>実用性:</strong> 実際の運用環境を想定</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>📋 出力例：期待される結果</h2>
            <h3>サンプル注文書での抽出結果</h3>
            
            <div class="json-example">
{
  "company": "株式会社サンプル商事",
  "contact_name": "田中 太郎",
  "contact_email": "tanaka@sample.co.jp",
  "contact_phone": "03-1234-5678",
  "items": [
    {
      "name": "オフィスチェア",
      "code": "OC-001",
      "quantity": 5,
      "unit_price": 15000,
      "subtotal": 75000
    },
    {
      "name": "デスク",
      "code": "DS-002", 
      "quantity": 3,
      "unit_price": 25000,
      "subtotal": 75000
    }
  ],
  "total_amount": 150000,
  "delivery_date": "2025-07-20",
  "order_date": "2025-07-10",
  "notes": "設置作業込み"
}
            </div>
        </section>

        <section class="section">
            <h2>🔧 よくあるトラブルと対策</h2>
            
            <div class="warning-box">
                <h3>⚠️ 実際の運用で発生する問題</h3>
                <ul>
                    <li><strong>金額の誤認識:</strong> 「20,000円」→「20000円」への変換失敗</li>
                    <li><strong>日付形式のバラつき:</strong> 「2024/12/15」「12月15日」の混在</li>
                    <li><strong>複数商品の漏れ:</strong> 最初の商品のみ抽出される</li>
                    <li><strong>手書き文字の誤認識:</strong> 「1」→「l」、「0」→「O」の混同</li>
                </ul>
            </div>

            <h3>📋 トラブルシューティング表</h3>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>問題</th>
                        <th>症状</th>
                        <th>対策</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>金額の誤抽出</td>
                        <td>「¥20,000」が文字列で抽出</td>
                        <td>制約条件に「数値のみ、カンマ除去」を追加</td>
                    </tr>
                    <tr>
                        <td>日付形式のバラつき</td>
                        <td>「2024/12/15」「12月15日」混在</td>
                        <td>「YYYY-MM-DD形式で統一」を明記</td>
                    </tr>
                    <tr>
                        <td>複数商品の漏れ</td>
                        <td>最初の商品のみ抽出</td>
                        <td>「配列に全て含める」を強調</td>
                    </tr>
                    <tr>
                        <td>手書き誤認識</td>
                        <td>「543l」「20,OOO円」の混在</td>
                        <td>「文脈から判断して補正」を指示</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="section">
            <h2>📊 実証テスト結果例</h2>
            
            <h3>各サンプルでの抽出精度</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>サンプル</th>
                        <th>抽出精度</th>
                        <th>特徴</th>
                        <th>対応状況</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>標準的注文書</td>
                        <td>98%</td>
                        <td>理想的なフォーマット</td>
                        <td>✅ 完全対応</td>
                    </tr>
                    <tr>
                        <td>手書き混在</td>
                        <td>85%</td>
                        <td>OCR誤認識含む</td>
                        <td>✅ 自動補正</td>
                    </tr>
                    <tr>
                        <td>複数ページ</td>
                        <td>92%</td>
                        <td>情報が分散</td>
                        <td>✅ 統合処理</td>
                    </tr>
                    <tr>
                        <td>情報不足</td>
                        <td>70%</td>
                        <td>項目の一部のみ</td>
                        <td>✅ null処理</td>
                    </tr>
                    <tr>
                        <td>製造業特化</td>
                        <td>95%</td>
                        <td>専門用語含む</td>
                        <td>✅ 業界対応</td>
                    </tr>
                    <tr>
                        <td>飲食業特化</td>
                        <td>93%</td>
                        <td>食品項目含む</td>
                        <td>✅ 業界対応</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="success-box">
                <h3>🎯 総合評価結果</h3>
                <ul>
                    <li><strong>平均抽出精度:</strong> 88.8%</li>
                    <li><strong>JSON形式準拠率:</strong> 100%</li>
                    <li><strong>エラー処理成功率:</strong> 95%</li>
                    <li><strong>実用レベル達成:</strong> ✅</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>🔧 業界別カスタマイズ例</h2>
            
            <h3>製造業向けの追加項目</h3>
            <div class="tip-box">
                <ul>
                    <li><strong>図面番号:</strong> 技術仕様の特定</li>
                    <li><strong>材質・規格:</strong> SUS304、JIS規格等</li>
                    <li><strong>検査基準:</strong> 品質管理要件</li>
                    <li><strong>納期区分:</strong> 通常/急ぎ/至急</li>
                </ul>
            </div>

            <h3>飲食業向けの追加項目</h3>
            <div class="tip-box">
                <ul>
                    <li><strong>消費期限:</strong> 食品安全管理</li>
                    <li><strong>保存方法:</strong> 冷蔵/冷凍/常温</li>
                    <li><strong>産地情報:</strong> トレーサビリティ</li>
                    <li><strong>アレルギー表示:</strong> 安全性確保</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>📝 実践的な実装ポイント</h2>
            
            <h3>段階的改善アプローチ</h3>
            <div class="testing-workflow">
                <div class="workflow-step">
                    <strong>Phase 1</strong><br>
                    基本抽出<br>80%精度目標
                </div>
                <div class="workflow-arrow">→</div>
                <div class="workflow-step">
                    <strong>Phase 2</strong><br>
                    エラー対策追加<br>90%精度目標
                </div>
                <div class="workflow-arrow">→</div>
                <div class="workflow-step">
                    <strong>Phase 3</strong><br>
                    業界特化対応<br>95%精度目標
                </div>
            </div>

            <div class="tip-box">
                <h3>💡 成功のためのベストプラクティス</h3>
                <ul>
                    <li><strong>まず基本から:</strong> 標準ケースで確実に動作させる</li>
                    <li><strong>段階的拡張:</strong> 一度に全てを実装しない</li>
                    <li><strong>継続的テスト:</strong> 新しいサンプルで定期的に検証</li>
                    <li><strong>フィードバック活用:</strong> エラーパターンを分析・改善</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>📈 精度向上のための継続改善</h2>
            
            <h3>フィードバックループの構築</h3>
            <ol>
                <li><strong>実運用開始:</strong> 基本プロンプトで処理開始</li>
                <li><strong>エラー収集:</strong> 抽出失敗・精度低下のパターン特定</li>
                <li><strong>プロンプト改善:</strong> 問題に対応した制約条件追加</li>
                <li><strong>A/Bテスト:</strong> 新旧プロンプトの性能比較</li>
                <li><strong>最適化完了:</strong> 高精度プロンプトの確定</li>
            </ol>

            <div class="success-box">
                <h3>🎯 目標精度</h3>
                <ul>
                    <li><strong>基本情報:</strong> 95%以上（会社名、金額等）</li>
                    <li><strong>詳細情報:</strong> 90%以上（商品詳細等）</li>
                    <li><strong>形式準拠:</strong> 100%（JSON形式出力）</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>🔗 次回への準備</h2>
            <div class="success-box">
                <h3>🎉 今回の成果</h3>
                <p>AIから<span class="highlight">正確で一貫した結果</span>を引き出すプロンプトが完成しました！</p>
                <p>これで、OCRテキストを構造化された情報に変換する準備が整いました。</p>
            </div>

            <h3>次回予告：動画5「GASからChatGPTを動かす！実践コード」</h3>
            <p>今回作成したプロンプトと8つのサンプルテキストを使って、<span class="highlight">実際のシステム統合</span>を行います。</p>
            
            <ul>
                <li>OpenAI APIキーの取得と安全な管理</li>
                <li>GASでのHTTPリクエスト実装</li>
                <li>8つのサンプルでの動作検証</li>
                <li>エラーハンドリングと品質チェック機能</li>
                <li>OCR→AI抽出の完全自動化フロー</li>
            </ul>

            <p>理論から実践へ！プロンプトという「魔法の呪文」を実際のシステムで動かし、自動化の威力を体感しましょう！</p>
        </section>
    </div>
</body>
</html>