<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>動画2: Google Cloud & GAS 3つの重要APIを有効化する方法</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .section h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .section h3 {
            color: #34495e;
            font-size: 1.5em;
            margin: 20px 0 15px 0;
        }
        
        .step-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .step-card {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 10px;
            position: relative;
        }
        
        .step-number {
            position: absolute;
            top: -10px;
            left: -10px;
            background: #e17055;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .api-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .api-card {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .api-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .folder-structure {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
        }
        
        .folder-structure .folder {
            color: #fd7e14;
            font-weight: bold;
        }
        
        .folder-structure .file {
            color: #28a745;
        }
        
        .spreadsheet-headers {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .header-cell {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }
        
        .code-block {
            background: #2d3436;
            color: #ddd;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .success-box {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .checklist {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .checklist ul {
            list-style: none;
            padding: 0;
        }
        
        .checklist li {
            padding: 8px 0;
            border-bottom: 1px solid #dee2e6;
        }
        
        .checklist li::before {
            content: "☐ ";
            color: #3498db;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .highlight {
            background: linear-gradient(120deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        ul {
            margin: 20px 0;
            padding-left: 30px;
        }
        
        li {
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .step-grid, .api-grid {
                grid-template-columns: 1fr;
            }
            
            .spreadsheet-headers {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>⚙️ 動画2: Google Cloud & GAS 3つの重要APIを有効化する方法</h1>
            <p>自動化の土台となるAPI環境構築</p>
        </header>

        <section class="section">
            <h2>🎯 学習目標</h2>
            <ul>
                <li>PDF自動処理に必要な基本フォルダ構造を作成する</li>
                <li>受注管理台帳（スプレッドシート）を設計・作成する</li>
                <li>Google Apps Script環境を準備し、基本設定を行う</li>
                <li>Drive API、Gmail API、Vision APIを有効化する</li>
                <li>設定完了後の動作確認方法を習得する</li>
            </ul>
        </section>

        <section class="section">
            <h2>📁 フォルダ構造の設計</h2>
            <h3>シンプルで効率的な2フォルダ構成</h3>
            <div class="folder-structure">
📁 Google Drive (ルート)<br>
├── 📁 <span class="folder">AI受注処理</span>     ← PDF投入フォルダ<br>
└── 📁 <span class="folder">処理済み</span>       ← 完了PDF保管フォルダ<br>
            </div>
            
            <div class="step-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3>AI受注処理フォルダ</h3>
                    <p>新しいPDFをドラッグ&ドロップする入り口。このフォルダに投入されたPDFが自動処理のトリガーとなります。</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3>処理済みフォルダ</h3>
                    <p>処理が完了したPDFの保管場所。データ抽出後、自動的にこちらに移動され、処理状況が一目で把握できます。</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>📊 受注管理台帳の設計</h2>
            <h3>必要最小限の8項目でシンプル管理</h3>
            <div class="spreadsheet-headers">
                <div class="header-cell">処理日時</div>
                <div class="header-cell">ステータス</div>
                <div class="header-cell">会社名</div>
                <div class="header-cell">担当者名</div>
                <div class="header-cell">商品名</div>
                <div class="header-cell">数量</div>
                <div class="header-cell">合計金額</div>
                <div class="header-cell">ファイル名</div>
            </div>
            
            <div class="success-box">
                <h3>💡 設計のポイント</h3>
                <ul>
                    <li><strong>シンプル重視:</strong> 必要最小限の項目で運用負荷を軽減</li>
                    <li><strong>拡張性:</strong> 将来的な項目追加にも対応可能</li>
                    <li><strong>視認性:</strong> ステータス列で処理状況を即座に把握</li>
                    <li><strong>トレーサビリティ:</strong> ファイル名で元データとの紐付けを保持</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>🔧 Google Apps Script環境構築</h2>
            <h3>スプレッドシートから直接アクセス</h3>
            
            <div class="step-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3>Apps Script起動</h3>
                    <p>作成したスプレッドシートから「拡張機能」→「Apps Script」を選択。新しいタブでコードエディタが開きます。</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3>プロジェクト設定</h3>
                    <p>プロジェクト名を「PDF自動処理システム」に変更。デフォルトのmyFunction()は削除し、クリーンな状態にします。</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>🔌 3つの重要API有効化</h2>
            
            <div class="api-grid">
                <div class="api-card">
                    <div class="api-icon">💾</div>
                    <h3>Drive API</h3>
                    <p>ファイル監視・操作</p>
                    <small>新しいPDFの検知と処理済みファイルの移動を担当</small>
                </div>
                <div class="api-card">
                    <div class="api-icon">📧</div>
                    <h3>Gmail API</h3>
                    <p>自動メール送信</p>
                    <small>顧客への確認メールとエラー通知の自動送信</small>
                </div>
                <div class="api-card">
                    <div class="api-icon">👁️</div>
                    <h3>Vision API</h3>
                    <p>OCR文字認識</p>
                    <small>PDFから文字を読み取るAIの「目」となる機能</small>
                </div>
            </div>

            <h3>📋 Drive API・Gmail API 有効化手順（Apps Script経由）</h3>
            <div class="step-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h4>サービス追加画面を開く</h4>
                    <p>Apps Scriptエディタの左サイドバー「サービス」の「+」をクリック</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h4>Drive API追加</h4>
                    <p>「Google Drive API」を検索→選択→「追加」をクリック</p>
                </div>
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h4>Gmail API追加</h4>
                    <p>同様に「Gmail API」を検索→選択→「追加」をクリック</p>
                </div>
                <div class="step-card">
                    <div class="step-number">4</div>
                    <h4>確認</h4>
                    <p>左側「サービス」に「Drive」と「Gmail」が表示されることを確認</p>
                </div>
            </div>

            <h3>🎯 Vision API 有効化手順（Google Cloud Console）</h3>
            <div class="warning-box">
                <h4>⚠️ 重要な注意点</h4>
                <p>Vision APIは<strong>Google Cloud Console</strong>での設定が必要です。また、<strong>課金アカウント</strong>の設定が必要ですが、少量使用なら月数百円程度です。</p>
            </div>

            <div class="step-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h4>GCPコンソールアクセス</h4>
                    <p>https://console.cloud.google.com にアクセスしてログイン</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h4>プロジェクト作成</h4>
                    <p>「プロジェクトを選択」→「新しいプロジェクト」→名前：「PDF自動処理」</p>
                </div>
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h4>課金アカウント設定</h4>
                    <p>「お支払い」→「課金アカウントをリンク」→クレジットカード情報を入力</p>
                </div>
                <div class="step-card">
                    <div class="step-number">4</div>
                    <h4>Vision API有効化</h4>
                    <p>「APIとサービス」→「ライブラリ」→「Vision」検索→「Cloud Vision API」→「有効にする」</p>
                </div>
                <div class="step-card">
                    <div class="step-number">5</div>
                    <h4>APIキー作成</h4>
                    <p>「認証情報」→「認証情報を作成」→「APIキー」→生成されたキーをコピー</p>
                </div>
                <div class="step-card">
                    <div class="step-number">6</div>
                    <h4>Apps Scriptに設定</h4>
                    <p>「プロジェクトの設定」→「スクリプト プロパティ」→「VISION_API_KEY」で保存</p>
                </div>
            </div>

            <h3>💡 APIキー設定の詳細手順</h3>
            <div class="code-block">
Apps Scriptでの設定方法：
1. スクリプトエディタで「プロジェクトの設定」（歯車アイコン）をクリック
2. 「スクリプト プロパティ」タブを選択
3. 「スクリプト プロパティを追加」をクリック
4. プロパティ：VISION_API_KEY
5. 値：Google Cloud ConsoleでコピーしたAPIキー
6. 「スクリプト プロパティを保存」をクリック
            </div>
        </section>

        <section class="section">
            <h2>⚠️ 詳細トラブルシューティング</h2>
            
            <h3>🚨 Drive API・Gmail API関連の問題</h3>
            <div class="warning-box">
                <h4>❌ 「Drive APIが見つからない」エラー</h4>
                <p><strong>症状:</strong> Apps Scriptでサービス追加時に「Drive API」が表示されない</p>
                <p><strong>解決策:</strong></p>
                <ul>
                    <li>検索欄に「Google Drive API」と正確に入力</li>
                    <li>ブラウザを更新してやり直し</li>
                    <li>Googleアカウントに管理者権限があることを確認</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>❌ 「承認が必要です」エラー</h4>
                <p><strong>症状:</strong> スクリプト実行時に権限エラーが発生</p>
                <p><strong>解決策:</strong></p>
                <ul>
                    <li>「承認」ボタンをクリック</li>
                    <li>「詳細」→「安全ではないページに移動」を選択</li>
                    <li>「許可」をクリックして権限を付与</li>
                </ul>
            </div>

            <h3>🎯 Vision API関連の問題</h3>
            <div class="warning-box">
                <h4>❌ 「プロジェクトが選択されていません」エラー</h4>
                <p><strong>症状:</strong> GCPコンソールでプロジェクトが表示されない</p>
                <p><strong>解決策:</strong></p>
                <ul>
                    <li>画面上部の「プロジェクトを選択」をクリック</li>
                    <li>「新しいプロジェクト」を選択</li>
                    <li>プロジェクト名を入力（例：PDF自動処理）</li>
                    <li>作成完了まで数分待機</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>❌ 「課金アカウントが必要です」エラー</h4>
                <p><strong>症状:</strong> Vision API有効化時に課金設定を求められる</p>
                <p><strong>解決策:</strong></p>
                <ul>
                    <li>「お支払い」メニューから課金アカウントをリンク</li>
                    <li>クレジットカード情報を入力</li>
                    <li>月間無料枠（1000リクエスト）あり</li>
                    <li>通常使用なら月数百円程度</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>❌ 「APIキーが正しくありません」エラー</h4>
                <p><strong>症状:</strong> Vision API実行時に認証エラー</p>
                <p><strong>解決策:</strong></p>
                <ul>
                    <li>GCPでAPIキーを再生成</li>
                    <li>Apps Scriptのプロパティを再設定</li>
                    <li>APIキーに制限がかかっていないか確認</li>
                    <li>Vision APIが有効化されているか再確認</li>
                </ul>
            </div>

            <h3>🔧 段階的な問題診断方法</h3>
            <div class="step-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h4>基本確認</h4>
                    <p>フォルダとスプレッドシートが正しく作成されているか確認</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h4>API確認</h4>
                    <p>Apps ScriptのサービスにDrive・Gmailが表示されているか確認</p>
                </div>
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h4>GCP確認</h4>
                    <p>Google Cloud ConsoleでVision APIが有効になっているか確認</p>
                </div>
                <div class="step-card">
                    <div class="step-number">4</div>
                    <h4>キー確認</h4>
                    <p>Apps ScriptプロパティにVISION_API_KEYが正しく設定されているか確認</p>
                </div>
            </div>

            <h3>✅ 動作確認用テストコード</h3>
            <div class="code-block">
// 提供されたAPI設定テストコード.jsを使用
// 以下の関数を順番に実行してください：

1. testBasicSetup()        // 基本設定確認
2. testDriveAPI()         // Drive API確認  
3. testGmailAPI()         // Gmail API確認
4. testVisionAPIConnection() // Vision API確認
5. comprehensiveTest()    // 総合テスト

// エラーが発生した場合は上記のトラブルシューティングを参照
            </div>

            <h3>📞 サポート情報</h3>
            <div class="success-box">
                <h4>🆘 それでも解決しない場合</h4>
                <ul>
                    <li><strong>エラーメッセージ:</strong> 正確なエラー文言をメモ</li>
                    <li><strong>実行環境:</strong> ブラウザ種類とバージョン</li>
                    <li><strong>実行手順:</strong> どの段階で問題が発生したか</li>
                    <li><strong>画面キャプチャ:</strong> エラー画面のスクリーンショット</li>
                </ul>
                <p>上記情報を準備して、コース内のサポートフォーラムまたはQ&Aセクションで質問してください。</p>
            </div>
        </section>

        <section class="section">
            <h2>✅ 完了チェックリスト</h2>
            <div class="checklist">
                <h3>フォルダ・ファイル作成</h3>
                <ul>
                    <li>「AI受注処理」フォルダの作成完了</li>
                    <li>「処理済み」フォルダの作成完了</li>
                    <li>「受注管理台帳」スプレッドシートの作成完了</li>
                    <li>スプレッドシートのヘッダー行設定完了</li>
                </ul>

                <h3>Apps Script環境</h3>
                <ul>
                    <li>Apps Scriptプロジェクトの作成完了</li>
                    <li>プロジェクト名の設定完了</li>
                    <li>デフォルトコードの削除完了</li>
                </ul>

                <h3>API有効化</h3>
                <ul>
                    <li>Drive APIの有効化完了</li>
                    <li>Gmail APIの有効化完了</li>
                    <li>Vision APIの有効化完了（GCP）</li>
                    <li>各APIの動作確認完了</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>💡 次回に向けた準備</h2>
            <p>今回構築した基盤の上に、次回はいよいよ<span class="highlight">Vision APIを使ったOCR機能</span>を実装します。</p>
            
            <h3>次回の学習内容</h3>
            <ul>
                <li>Vision APIの詳細設定とAPIキー取得</li>
                <li>PDFファイルの画像変換処理</li>
                <li>OCRリクエストの構築と実行</li>
                <li>抽出されたテキストの確認と整形</li>
            </ul>

            <div class="success-box">
                <h3>🎉 今回の成果</h3>
                <p>おめでとうございます！PDF自動処理システムの<span class="highlight">「土台」</span>が完成しました。</p>
                <p>次回は、この土台の上にAIの「目」を搭載し、PDFから文字を読み取る魔法を実現します。</p>
            </div>
        </section>
    </div>
</body>
</html>