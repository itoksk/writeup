<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•ç”»7: GASã¨Slackã‚’ç¹‹ã„ã§ã¿ã‚ˆã†ï¼å—æ³¨ã—ãŸã‚‰ãƒãƒ¼ãƒ ã«å³é€šçŸ¥ãŒé£›ã¶ä»•çµ„ã¿</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .section h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .section h3 {
            color: #34495e;
            font-size: 1.5em;
            margin: 20px 0 15px 0;
        }
        
        .notification-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 30px;
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            border-radius: 15px;
        }
        
        .flow-step {
            text-align: center;
            flex: 1;
        }
        
        .flow-arrow {
            font-size: 2em;
            color: #2c3e50;
            margin: 0 20px;
        }
        
        .slack-setup {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .setup-card {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 10px;
        }
        
        .notification-types {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .notification-card {
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .success-notification {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
        }
        
        .warning-notification {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
        }
        
        .error-notification {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }
        
        .slack-message-demo {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Slack', sans-serif;
        }
        
        .message-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .bot-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .message-content {
            background: white;
            border-left: 4px solid #00b894;
            padding: 15px;
            border-radius: 5px;
        }
        
        .message-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }
        
        .field-item {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        
        .code-section {
            background: #2d3436;
            color: #ddd;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
            border-left: 4px solid #74b9ff;
        }
        
        .code-section h4 {
            color: #74b9ff;
            margin-bottom: 15px;
            font-family: 'Segoe UI', sans-serif;
        }
        
        .webhook-guide {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        
        .guide-step {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
            padding: 25px;
            border-radius: 10px;
        }
        
        .highlight {
            background: linear-gradient(120deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .success-box {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .team-benefits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .benefit-card {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .benefit-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        ul {
            margin: 20px 0;
            padding-left: 30px;
        }
        
        li {
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .webhook-guide {
                grid-template-columns: 1fr;
            }
            
            .notification-flow {
                flex-direction: column;
            }
            
            .flow-arrow {
                transform: rotate(90deg);
                margin: 20px 0;
            }
            
            .notification-types {
                grid-template-columns: 1fr;
            }
            
            .message-fields {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ’¬ å‹•ç”»7: GASã¨Slackã‚’ç¹‹ã„ã§ã¿ã‚ˆã†ï¼</h1>
            <p>å—æ³¨ã—ãŸã‚‰ãƒãƒ¼ãƒ ã«å³é€šçŸ¥ãŒé£›ã¶ä»•çµ„ã¿</p>
        </header>

        <section class="section">
            <h2>ğŸ¯ å­¦ç¿’ç›®æ¨™</h2>
            <ul>
                <li><strong>å‹•ç”»1-6ã®çµ±åˆã‚·ã‚¹ãƒ†ãƒ </strong>ã«Slacké€šçŸ¥æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹</li>
                <li>Slack Webhookã®è¨­å®šæ–¹æ³•ã¨åŸºæœ¬æ¦‚å¿µã‚’ç†è§£ã™ã‚‹</li>
                <li>å“è³ªã‚¹ã‚³ã‚¢ä»˜ãã®é«˜æ©Ÿèƒ½é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã™ã‚‹</li>
                <li>ç·Šæ€¥åº¦åˆ¥ã®é€šçŸ¥ãƒ‡ã‚¶ã‚¤ãƒ³ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¨­è¨ˆã‚’ç¿’å¾—ã™ã‚‹</li>
                <li>ãƒãƒ¼ãƒ é€£æºã‚’åŠ¹ç‡åŒ–ã™ã‚‹çµ±åˆé€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Œæˆã™ã‚‹</li>
                <li>ã‚¨ãƒ©ãƒ¼æ™‚ã®ç·Šæ€¥é€šçŸ¥æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹</li>
            </ul>
        </section>

        <section class="section">
            <h2>ğŸ“¢ å‹•ç”»1-7çµ±åˆã‚·ã‚¹ãƒ†ãƒ ã®å…¨ä½“ãƒ•ãƒ­ãƒ¼</h2>
            <div class="notification-flow">
                <div class="flow-step">
                    <strong>ğŸ“ PDFå–å¾—</strong><br>
                    å‹•ç”»2<br>ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰å–å¾—
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ‘ï¸ OCRå‡¦ç†</strong><br>
                    å‹•ç”»3<br>Vision API
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ¤– AIæŠ½å‡º</strong><br>
                    å‹•ç”»4&5<br>ChatGPT API
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ“Š DBè¨˜éŒ²</strong><br>
                    å‹•ç”»6<br>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ’¬ Slacké€šçŸ¥</strong><br>
                    å‹•ç”»7<br>ãƒãƒ¼ãƒ é€£æº
                </div>
            </div>
            
            <div style="background: linear-gradient(135deg, #a8edea, #fed6e3); padding: 20px; border-radius: 10px; margin-top: 20px;">
                <h3 style="color: #2c3e50;">ğŸ¯ å‹•ç”»7ã§å®Ÿç¾ã™ã‚‹ã“ã¨</h3>
                <p style="margin: 0; color: #2c3e50;"><strong>å€‹äººã®åŠ¹ç‡åŒ– â†’ ãƒãƒ¼ãƒ å…¨ä½“ã®ç”Ÿç”£æ€§å‘ä¸Š</strong></p>
                <p style="margin: 0; color: #2c3e50;">å“è³ªã‚¹ã‚³ã‚¢ä»˜ããƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ã§æƒ…å ±å…±æœ‰ãŒåŠ‡çš„ã«æ”¹å–„</p>
            </div>
        </section>

        <section class="section">
            <h2>âš™ï¸ Slack Webhookè¨­å®šæ‰‹é †</h2>
            
            <div class="slack-setup">
                <div class="setup-card">
                    <h3>1ï¸âƒ£ Slackã‚¢ãƒ—ãƒªä½œæˆ</h3>
                    <ol>
                        <li>Slack APIå…¬å¼ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹</li>
                        <li>ã€ŒCreate New Appã€ã‚’é¸æŠ</li>
                        <li>ã€ŒFrom scratchã€ã‚’é¸æŠ</li>
                        <li>ã‚¢ãƒ—ãƒªåã¨å¯¾è±¡ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’è¨­å®š</li>
                    </ol>
                </div>
                <div class="setup-card">
                    <h3>2ï¸âƒ£ Webhookæœ‰åŠ¹åŒ–</h3>
                    <ol>
                        <li>ã€ŒIncoming Webhooksã€ã‚’é¸æŠ</li>
                        <li>ã€ŒActivate Incoming Webhooksã€ã‚’ON</li>
                        <li>ã€ŒAdd New Webhook to Workspaceã€</li>
                        <li>é€šçŸ¥å…ˆãƒãƒ£ãƒ³ãƒãƒ«ã‚’é¸æŠ</li>
                    </ol>
                </div>
                <div class="setup-card">
                    <h3>3ï¸âƒ£ URLå–å¾—ãƒ»è¨­å®š</h3>
                    <ol>
                        <li>ç”Ÿæˆã•ã‚ŒãŸWebhook URLã‚’ã‚³ãƒ”ãƒ¼</li>
                        <li>Apps Scriptã®Propertiesã«ä¿å­˜</li>
                        <li>ãƒ†ã‚¹ãƒˆé€ä¿¡ã§å‹•ä½œç¢ºèª</li>
                        <li>æœ¬ç•ªé‹ç”¨é–‹å§‹</li>
                    </ol>
                </div>
            </div>

            <div class="code-section">
                <h4>Webhook URL ã®å®‰å…¨ãªè¨­å®š</h4>
                <pre>function setSlackWebhookURL() {
  const webhookUrl = 'https://hooks.slack.com/services/YOUR/WEBHOOK/URL';
  PropertiesService.getScriptProperties()
    .setProperty('SLACK_WEBHOOK_URL', webhookUrl);
  console.log('Slack Webhook URLã‚’è¨­å®šã—ã¾ã—ãŸ');
}</pre>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ¨ å“è³ªã‚¹ã‚³ã‚¢åˆ¥é€šçŸ¥ãƒ‡ã‚¶ã‚¤ãƒ³</h2>
            
            <div class="notification-types">
                <div class="notification-card success-notification">
                    <h3>âœ… é«˜å“è³ªï¼ˆ80ç‚¹ä»¥ä¸Šï¼‰</h3>
                    <ul>
                        <li>ç·‘è‰²ã®é€šçŸ¥</li>
                        <li>ã€Œæ­£å¸¸å‡¦ç†ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</li>
                        <li>åŸºæœ¬æƒ…å ±ã®ã¿è¡¨ç¤º</li>
                        <li>ç¢ºèªä½œæ¥­ä¸è¦</li>
                    </ul>
                </div>
                <div class="notification-card warning-notification">
                    <h3>âš ï¸ ä¸­å“è³ªï¼ˆ60-79ç‚¹ï¼‰</h3>
                    <ul>
                        <li>é»„è‰²ã®é€šçŸ¥</li>
                        <li>ã€Œè¦ç¢ºèªã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</li>
                        <li>å•é¡Œç®‡æ‰€ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ</li>
                        <li>æ‰‹å‹•ç¢ºèªæ¨å¥¨</li>
                    </ul>
                </div>
                <div class="notification-card error-notification">
                    <h3>ğŸš¨ ä½å“è³ªï¼ˆ60ç‚¹æœªæº€ï¼‰</h3>
                    <ul>
                        <li>èµ¤è‰²ã®é€šçŸ¥</li>
                        <li>ã€Œç·Šæ€¥ç¢ºèªã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</li>
                        <li>ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’è¡¨ç¤º</li>
                        <li>å³åº§ã®å¯¾å¿œå¿…è¦</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ’¬ Slacké€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ‡ãƒ¢</h2>
            
            <div class="slack-message-demo">
                <div class="message-header">
                    <div class="bot-avatar">ğŸ¤–</div>
                    <div>
                        <strong>PDFè‡ªå‹•å‡¦ç†Bot</strong>
                        <span style="color: #888; font-size: 0.9em;">ä»Šæ—¥ 14:30</span>
                    </div>
                </div>
                <div class="message-content">
                    <strong>âœ… æ–°è¦å—æ³¨ã®ãŠçŸ¥ã‚‰ã› - æ­£å¸¸å‡¦ç†</strong>
                    <div class="message-fields">
                        <div class="field-item"><strong>ä¼šç¤¾å:</strong> æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«å•†äº‹</div>
                        <div class="field-item"><strong>é‡‘é¡:</strong> Â¥150,000</div>
                        <div class="field-item"><strong>å•†å“:</strong> ã‚ªãƒ•ã‚£ã‚¹ãƒã‚§ã‚¢</div>
                        <div class="field-item"><strong>æ•°é‡:</strong> 5è„š</div>
                        <div class="field-item"><strong>ç´æœŸ:</strong> 2025-07-20</div>
                        <div class="field-item"><strong>å“è³ªã‚¹ã‚³ã‚¢:</strong> 95/100</div>
                    </div>
                    <small style="color: #666;">å“è³ªãƒã‚§ãƒƒã‚¯: å•é¡Œãªã—</small>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ’» å‹•ç”»1-7çµ±åˆã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…</h2>
            
            <div class="code-section">
                <h4>ãƒ¡ã‚¤ãƒ³çµ±åˆãƒ•ãƒ­ãƒ¼ï¼ˆrunVideo7CompleteFlowï¼‰</h4>
                <pre>function runVideo7CompleteFlow() {
  try {
    console.log('=== å‹•ç”»7 å®Œå…¨çµ±åˆãƒ•ãƒ­ãƒ¼é–‹å§‹ ===');
    
    // Step 1: å‹•ç”»2ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰æœ€æ–°PDFå–å¾—
    const targetFile = getLatestPDFFromFolder();
    if (!targetFile) return false;
    
    // Step 2-5: çµ±åˆå‡¦ç† + Slacké€šçŸ¥
    const result = processOrderWithSlackNotification(targetFile.getId());
    
    if (result.success) {
      console.log('=== å…¨å·¥ç¨‹å®Œäº† ===');
      moveToProcessedFolder(targetFile);
      return true;
    } else {
      notifySlackError(result.error, targetFile.getName());
      return false;
    }
  } catch (error) {
    console.error('ãƒ¡ã‚¤ãƒ³å‡¦ç†ã‚¨ãƒ©ãƒ¼:', error);
    return false;
  }
}</pre>
            </div>
            
            <div class="code-section">
                <h4>çµ±åˆå‡¦ç†+Slacké€šçŸ¥ï¼ˆprocessOrderWithSlackNotificationï¼‰</h4>
                <pre>function processOrderWithSlackNotification(fileId) {
  try {
    // Step 1: å‹•ç”»3 OCRå‡¦ç†
    const ocrText = performOCRFromVideo3(fileId);
    if (!ocrText) throw new Error('OCRå‡¦ç†ãŒå¤±æ•—');
    
    // Step 2: å‹•ç”»4&5 ChatGPTæƒ…å ±æŠ½å‡º
    const extractedData = extractOrderInfo(ocrText);
    if (extractedData.extraction_failed) 
      throw new Error('AIæƒ…å ±æŠ½å‡ºãŒå¤±æ•—');
    
    // Step 3: ãƒ‡ãƒ¼ã‚¿å“è³ªæ¤œè¨¼
    const validation = validateExtractedData(extractedData);
    
    // Step 4: å‹•ç”»6 ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆè¨˜éŒ²
    const fileName = DriveApp.getFileById(fileId).getName();
    const spreadsheetResult = saveToSpreadsheet(extractedData, fileName, validation);
    
    // Step 5: å‹•ç”»7 Slacké€šçŸ¥
    const slackResult = notifySlackNewOrder(extractedData, validation, fileName);
    
    return {
      success: true,
      extracted_data: extractedData,
      validation: validation,
      spreadsheet_result: spreadsheetResult,
      slack_result: slackResult
    };
  } catch (error) {
    return { success: false, error: error.message };
  }
}</pre>
            </div>
            
            <div class="code-section">
                <h4>å“è³ªã‚¹ã‚³ã‚¢å¯¾å¿œSlacké€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ </h4>
                <pre>function notifySlackNewOrder(orderData, validation, fileName) {
  try {
    const webhookUrl = PropertiesService.getScriptProperties()
      .getProperty('SLACK_WEBHOOK_URL');
    
    // å“è³ªãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸçµµæ–‡å­—ã¨ã‚«ãƒ©ãƒ¼
    let emoji, color, qualityText;
    if (validation.score >= 80) {
      emoji = 'ğŸ‰'; color = 'good'; qualityText = 'é«˜å“è³ª';
    } else if (validation.score >= 60) {
      emoji = 'âš ï¸'; color = 'warning'; qualityText = 'è¦ç¢ºèª';
    } else {
      emoji = 'ğŸš¨'; color = 'danger'; qualityText = 'è¦ãƒã‚§ãƒƒã‚¯';
    }
    
    const message = {
      text: `${emoji} æ–°è¦å—æ³¨ã®ãŠçŸ¥ã‚‰ã›ï¼ˆå“è³ª: ${qualityText} ${validation.score}ç‚¹ï¼‰`,
      attachments: [{
        color: color,
        title: `ğŸ“‹ ${orderData.company || 'ä¼šç¤¾åä¸æ˜'} æ§˜ã‹ã‚‰ã®æ³¨æ–‡`,
        fields: [
          { title: 'ä¼šç¤¾å', value: orderData.company || 'ä¸æ˜', short: true },
          { title: 'æ‹…å½“è€…', value: orderData.contact_name || 'ä¸æ˜', short: true },
          { title: 'åˆè¨ˆé‡‘é¡', value: orderData.total_amount ? 
            `Â¥${orderData.total_amount.toLocaleString()}` : 'ä¸æ˜', short: true },
          { title: 'ç´æœŸ', value: orderData.delivery_date || 'ä¸æ˜', short: true }
        ],
        footer: 'è‡ªå‹•å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå‹•ç”»7ï¼‰'
      }]
    };
    
    // å“è³ªå•é¡ŒãŒã‚ã‚‹å ´åˆã®è¿½åŠ æƒ…å ±
    if (validation.issues && validation.issues.length > 0) {
      message.attachments[0].fields.push({
        title: 'âš ï¸ æ¤œå‡ºã•ã‚ŒãŸå•é¡Œ',
        value: validation.issues.join('\n'),
        short: false
      });
    }
    
    const response = UrlFetchApp.fetch(webhookUrl, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      payload: JSON.stringify(message)
    });
    
    return { success: response.getResponseCode() === 200 };
  } catch (error) {
    return { success: false, error: error.message };
  }
}</pre>
            </div>
        </section>

        <section class="section">
            <h2>ğŸš¨ ã‚¨ãƒ©ãƒ¼æ™‚ã®ç·Šæ€¥é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ </h2>
            
            <div class="code-section">
                <h4>ç·Šæ€¥ã‚¨ãƒ©ãƒ¼é€šçŸ¥æ©Ÿèƒ½</h4>
                <pre>function handleProcessingError(error, fileId, processingLog) {
  try {
    const webhookUrl = PropertiesService.getScriptProperties()
      .getProperty('SLACK_WEBHOOK_URL');
    
    if (webhookUrl) {
      const message = {
        text: 'ğŸš¨ æ³¨æ–‡å‡¦ç†ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ',
        attachments: [{
          color: 'danger',
          title: 'ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ - ç·Šæ€¥å¯¾å¿œãŒå¿…è¦ã§ã™',
          fields: [
            { title: 'ãƒ•ã‚¡ã‚¤ãƒ«ID', value: fileId, short: true },
            { title: 'ã‚¨ãƒ©ãƒ¼å†…å®¹', value: error.message, short: false },
            { title: 'ç™ºç”Ÿæ™‚åˆ»', value: new Date().toLocaleString(), short: true }
          ],
          text: `å‡¦ç†ãƒ­ã‚°:\n${processingLog.join('\n')}`
        }]
      };
      
      UrlFetchApp.fetch(webhookUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        payload: JSON.stringify(message)
      });
    }
    
  } catch (notificationError) {
    console.error('ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã®é€ä¿¡ã«å¤±æ•—:', notificationError);
  }
}</pre>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ‘¥ ãƒãƒ¼ãƒ é€£æºã®åŠ¹æœã¨åˆ©ç›Š</h2>
            
            <div class="team-benefits">
                <div class="benefit-card">
                    <div class="benefit-icon">âš¡</div>
                    <h3>å³åº§ã®æƒ…å ±å…±æœ‰</h3>
                    <p>å‡¦ç†å®Œäº†ã¨åŒæ™‚ã«å…¨å“¡ãŒçŠ¶æ³ã‚’æŠŠæ¡ã€‚é€£çµ¡ã®æ‰‹é–“ãŒä¸è¦ã€‚</p>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">ğŸ“Š</div>
                    <h3>é€æ˜æ€§ã®å‘ä¸Š</h3>
                    <p>å‡¦ç†çŠ¶æ³ãŒå¯è¦–åŒ–ã•ã‚Œã€é€²æ—ç®¡ç†ãŒå®¹æ˜“ã«ãªã‚‹ã€‚</p>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">ğŸ¯</div>
                    <h3>å„ªå…ˆåº¦ã®æ˜ç¢ºåŒ–</h3>
                    <p>å“è³ªã‚¹ã‚³ã‚¢ã§ç·Šæ€¥åº¦ãŒåˆ†ã‹ã‚Šã€å¯¾å¿œã®å„ªå…ˆé †ä½ãŒæ˜ç¢ºã€‚</p>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">ğŸ”„</div>
                    <h3>è¿…é€Ÿãªå¯¾å¿œ</h3>
                    <p>å•é¡Œç™ºç”Ÿæ™‚ã®æ—©æœŸç™ºè¦‹ãƒ»å¯¾å¿œã§é¡§å®¢æº€è¶³åº¦å‘ä¸Šã€‚</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ”§ é€šçŸ¥ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã¨å¿œç”¨</h2>
            
            <div class="webhook-guide">
                <div class="guide-step">
                    <h3>ğŸ“± é€šçŸ¥å…ˆã®ä½¿ã„åˆ†ã‘</h3>
                    <ul>
                        <li><strong>#å–¶æ¥­ãƒãƒ¼ãƒ :</strong> å…¨å—æ³¨æƒ…å ±</li>
                        <li><strong>#ç®¡ç†è€…:</strong> ã‚¨ãƒ©ãƒ¼ãƒ»è¦ç¢ºèªã®ã¿</li>
                        <li><strong>#çµŒç†:</strong> é«˜é¡æ¡ˆä»¶ã®ã¿</li>
                        <li><strong>DM:</strong> å€‹äººæ‹…å½“æ¡ˆä»¶</li>
                    </ul>
                </div>
                <div class="guide-step">
                    <h3>â° æ™‚é–“å¸¯ã«ã‚ˆã‚‹åˆ¶å¾¡</h3>
                    <ul>
                        <li><strong>å–¶æ¥­æ™‚é–“:</strong> å³åº§é€šçŸ¥</li>
                        <li><strong>å¤œé–“ãƒ»ä¼‘æ—¥:</strong> ç¿Œå–¶æ¥­æ—¥ã¾ã¨ã‚é€ä¿¡</li>
                        <li><strong>ç·Šæ€¥æ™‚:</strong> 24æ™‚é–“å³åº§é€šçŸ¥</li>
                        <li><strong>å®šæœŸå ±å‘Š:</strong> æ—¥æ¬¡ãƒ»é€±æ¬¡ã‚µãƒãƒªãƒ¼</li>
                    </ul>
                </div>
            </div>

            <h3>ğŸ’¡ é«˜åº¦ãªæ´»ç”¨ä¾‹</h3>
            <ul>
                <li><span class="highlight">æ¡ä»¶åˆ†å²é€šçŸ¥</span>: é‡‘é¡ãƒ»é¡§å®¢åˆ¥ã®é€šçŸ¥ãƒ«ãƒ¼ãƒ«</li>
                <li><span class="highlight">ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³æ©Ÿèƒ½</span>: æ‹…å½“è€…ã¸ã®ç›´æ¥é€šçŸ¥</li>
                <li><span class="highlight">ã‚¹ãƒ¬ãƒƒãƒ‰è¿”ä¿¡</span>: é€²æ—æ›´æ–°ã®è¿½è¨˜</li>
                <li><span class="highlight">ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½</span>: ç¢ºèªæ¸ˆã¿ã®è¡¨ç¤º</li>
            </ul>
        </section>

        <section class="section">
            <h2>âš ï¸ é‹ç”¨æ™‚ã®æ³¨æ„ç‚¹ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h2>
            
            <div class="warning-box">
                <h3>ğŸš¨ é¿ã‘ã‚‹ã¹ãå•é¡Œ</h3>
                <ul>
                    <li><strong>é€šçŸ¥éå¤š:</strong> é‡è¦ã§ãªã„æƒ…å ±ã§ã®é€šçŸ¥ç–²ã‚Œ</li>
                    <li><strong>æƒ…å ±ä¸è¶³:</strong> åˆ¤æ–­ã«å¿…è¦ãªæƒ…å ±ã®æ¬ å¦‚</li>
                    <li><strong>èª¤é€ä¿¡:</strong> ãƒ†ã‚¹ãƒˆé€šçŸ¥ã®æœ¬ç•ªãƒãƒ£ãƒ³ãƒãƒ«é€ä¿¡</li>
                    <li><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£:</strong> æ©Ÿå¯†æƒ…å ±ã®ä¸é©åˆ‡ãªå…±æœ‰</li>
                </ul>
            </div>

            <h3>âœ… æˆåŠŸã®ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li>å“è³ªã‚¹ã‚³ã‚¢é–¾å€¤ã®é©åˆ‡ãªè¨­å®š</li>
                <li>é€šçŸ¥å†…å®¹ã®ç°¡æ½”æ€§ã¨æƒ…å ±å……è¶³æ€§ã®ãƒãƒ©ãƒ³ã‚¹</li>
                <li>ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã®é€šçŸ¥è¨­å®šã®æœ€é©åŒ–</li>
                <li>å®šæœŸçš„ãªé€šçŸ¥ãƒ«ãƒ¼ãƒ«ã®è¦‹ç›´ã—ã¨æ”¹å–„</li>
            </ul>
        </section>

        <section class="section">
            <h2>ğŸ§ª å‹•ç”»7ãƒ‡ãƒ¢å®Ÿè¡Œé–¢æ•°</h2>
            
            <div class="code-section">
                <h4>ä¸»è¦ãªãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ¢é–¢æ•°</h4>
                <pre>// ãƒ¡ã‚¤ãƒ³çµ±åˆãƒ•ãƒ­ãƒ¼ï¼ˆå‹•ç”»1-7ã®å®Œå…¨çµ±åˆï¼‰
runVideo7CompleteFlow()

// Slacké€šçŸ¥ãƒ†ã‚¹ãƒˆ
testSlackNotification()

// 3ãƒ‘ã‚¿ãƒ¼ãƒ³ã®é€šçŸ¥ãƒ‡ãƒ¢
demonstrateSlackIntegration()

// å‹•ç”»1-7ã®ç·åˆè¨­å®šç¢ºèª
checkAllSystemSetup()

// Slack Webhook URLè¨­å®š
setSlackWebhookURL()</pre>
            </div>
            
            <div class="success-box">
                <h3>ğŸ“‹ å‹•ç”»7æ’®å½±æ™‚ã®å®Ÿè¡Œæ‰‹é †</h3>
                <ol style="color: white; margin: 15px 0;">
                    <li><strong>setSlackWebhookURL()</strong> ã§Webhook URLè¨­å®š</li>
                    <li><strong>checkAllSystemSetup()</strong> ã§ç·åˆè¨­å®šç¢ºèª</li>
                    <li><strong>runVideo7CompleteFlow()</strong> ã§ãƒ¡ã‚¤ãƒ³çµ±åˆãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ</li>
                    <li><strong>demonstrateSlackIntegration()</strong> ã§3ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ‡ãƒ¢</li>
                </ol>
            </div>
        </section>
        
        <section class="section">
            <h2>ğŸ”— æ¬¡å›ã¸ã®æº–å‚™</h2>
            <div class="success-box">
                <h3>ğŸ‰ å‹•ç”»7ã®æˆæœ</h3>
                <p><strong>å‹•ç”»1-6ã®å€‹äººåŠ¹ç‡åŒ–ã‚·ã‚¹ãƒ†ãƒ </strong>ãŒ<span class="highlight">ãƒãƒ¼ãƒ å…¨ä½“ã®ç”Ÿç”£æ€§å‘ä¸Šã‚·ã‚¹ãƒ†ãƒ </span>ã«é€²åŒ–ã—ã¾ã—ãŸï¼</p>
                <p>å“è³ªã‚¹ã‚³ã‚¢ä»˜ããƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ã§ãƒãƒ¼ãƒ é€£æºãŒåŠ‡çš„ã«æ”¹å–„ã•ã‚Œã¾ã™ã€‚</p>
            </div>

            <h3>æ¬¡å›äºˆå‘Šï¼šå‹•ç”»8ã€Œå®Œæˆç‰ˆã‚·ã‚¹ãƒ†ãƒ ã€</h3>
            <p>æœ€çµ‚å›ã§ã¯<span class="highlight">é¡§å®¢å¯¾å¿œã®è‡ªå‹•åŒ–ã¨ã‚¨ãƒ©ãƒ¼å¯¾å¿œ</span>ã‚’è¿½åŠ ã—ã€ãƒ—ãƒ­ãƒ¬ãƒ™ãƒ«ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Œæˆã•ã›ã¾ã™ã€‚</p>
            
            <ul>
                <li>é¡§å®¢ã¸ã®è‡ªå‹•ç¢ºèªãƒ¡ãƒ¼ãƒ«é€ä¿¡</li>
                <li>åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</li>
                <li>ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®çµ±åˆã¨æœ€é©åŒ–</li>
                <li>é‹ç”¨ãƒ»ä¿å®ˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</li>
            </ul>

            <p>ã¤ã„ã«ã€<strong>93%ã®æ¥­å‹™å‰Šæ¸›ã‚’å®Ÿç¾ã™ã‚‹</strong>å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸå—æ³¨å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ãŒå®Œæˆã—ã¾ã™ï¼</p>
        </section>
    </div>
</body>
</html>