# 動画7: GASとSlackを繋いでみよう！受注したらチームに即通知が飛ぶ仕組み

## 📝 セリフと流れ（10分構成）

### 🎬 オープニング（0:00-1:00）
**セリフ**:
「『〇〇さん、あの件どうなりました？』…オフィスで最も無駄な会話の一つかもしれません。情報共有のタイムラグが、チームのスピードを奪っています。

この回では、私たちが作った自動化フローに『報告機能』を搭載します。受注が発生した瞬間、関係者全員に情報が届く。そんな理想の連携プレーを、Slackを使って実現しましょう！

この10分で、PDFが投入された瞬間から、チーム全員が状況を把握できるリアルタイム通知システムを完成させます。もう『報告忘れ』や『連絡漏れ』で困ることはありません。」

**画面表示**: 従来の手動報告 vs リアルタイム自動通知の比較

---

### 📢 Slack連携の戦略的価値（1:00-2:30）
**セリフ**:
「なぜSlackなのか？その戦略的価値を理解しましょう。

第一に、即座性。受注処理が完了した瞬間、全員が同時に情報を受け取れます。第二に、透明性。誰が何を知っているかが明確になり、情報格差が解消されます。第三に、効率性。個別連絡や会議での報告が不要になります。

今回構築するのは、単純な通知ではありません。品質スコア付きの高機能通知システムです。

80点以上の高品質案件は緑色で『正常処理』。確認作業は不要です。
60-79点の中品質案件は黄色で『要確認』。念のため内容をチェック。
60点未満の低品質案件は赤色で『緊急確認』。即座の対応が必要です。

この色分けにより、チームメンバーは瞬時に優先度を判断し、適切な行動を取れます。マネージャーも、チーム全体の処理状況を一目で把握できます。」

**画面表示**: 
- Slack連携の価値説明
- 品質スコア別通知デザイン
- チーム連携効果の図解

---

### ⚙️ Slack Webhook設定手順（2:30-4:30）
**セリフ**:
「それでは、Slack Webhookの設定から始めましょう。

Slack API公式サイトにアクセスし、『Create New App』を選択。『From scratch』で新規作成し、アプリ名を『PDF自動処理Bot』、対象ワークスペースを選択します。

次に、『Incoming Webhooks』を選択し、『Activate Incoming Webhooks』をONに。『Add New Webhook to Workspace』で通知先チャンネルを指定します。通常は『#営業チーム』や『#受注管理』といった名前のチャンネルが適切です。

生成されたWebhook URLをコピーし、Apps ScriptのScript Propertiesに安全に保存。これで、GoogleのサーバーからSlackへの直接通信が可能になります。

重要なのは、Webhook URLの機密性。このURLを知る者は、誰でもあなたのSlackチャンネルにメッセージを送信できます。絶対にコードに直接書かず、必ずScript Propertiesを使用してください。

テスト送信で動作確認を行い、メッセージが正しく表示されることを確認します。」

**画面表示**: 
- Slack API画面での設定手順
- Webhook URL生成の様子
- Script Propertiesでの安全な保存
- テスト送信の確認

---

### 💻 動画1-6統合デモ + Slack通知実装（4:30-7:00）
**セリフ**:
「それでは、動画1-6で構築したシステムにSlack通知を統合していきます。

まず、統合デモコードの`runVideo7CompleteFlow`関数をご覧ください。これが、PDFファイルの取得から最終的なSlack通知まで、全工程を自動実行するメイン関数です。

ステップ1：動画2で作成したAI受注処理フォルダから最新PDFを取得
ステップ2：動画3のVision APIでOCR処理
ステップ3：動画4&5のChatGPTで情報抽出
ステップ4：動画6のスプレッドシート記録
ステップ5：動画7の新機能、Slack通知【追加！】

実際に動作させてみましょう。PDFをフォルダに投入すると...

（画面で実演）

`notifySlackNewOrder`関数が、品質スコアに基づく通知デザインを自動決定。スコアが80点以上なら緑色で『高品質』、60-79点なら黄色で『要確認』、60点未満なら赤色で『要チェック』として色分けします。

Slackのリッチメッセージ機能で、会社名、金額、商品、納期、品質スコアを構造化して表示。さらに品質に問題がある場合は、具体的な確認事項も表示されます。

この瞬間、チーム全員が受注状況を把握し、品質レベルに応じた適切なアクションを即座に判断できるのです。」

**画面表示**: 
- 統合フロー実行の様子
- 各ステップの処理状況
- Slack通知の実際の表示
- 品質別メッセージの違い

---

### 🚨 エラー時の緊急通知システム（7:00-8:00）
**セリフ**:
「システムの信頼性を確保するため、エラー時の緊急通知システムも実装しました。

`handleProcessingError`関数では、処理エラーが発生した瞬間に、管理者とチームに緊急アラートを送信します。

通知内容は、エラーメッセージ、発生時刻、ファイルID、処理ログなど、問題解決に必要な情報を全て含みます。色は赤色で『danger』レベルに設定し、緊急性を視覚的に表現。

さらに、管理者には個別にメール通知も送信。Slackを見ていない時間帯でも、重要なエラーを見逃すことがありません。

エラーログはスプレッドシートにも自動記録。発生パターンの分析や、システム改善の参考データとして活用できます。

この多層的なエラー通知により、問題の早期発見・対応が可能になり、システムの安定性が飛躍的に向上します。」

**画面表示**: 
- エラー通知のコード
- 実際のエラーアラート表示
- 管理者メール通知の様子

---

### 🎯 動画7統合機能のフルデモンストレーション（8:00-9:00）
**セリフ**:
「それでは、動画7で追加したSlack通知機能の全貌を、実際のデモでご覧いただきましょう。

まず、`demonstrateSlackIntegration`関数を実行します。この関数は、3つのパターンの通知をテストします。

パターン1：高品質データの通知（緑色）
株式会社優良企業からの25万円の注文。品質スコア95点の高精度抽出です。通知は緑色で表示され、『確認不要、そのまま処理継続』という状態を表します。

パターン2：要確認データの通知（黄色）
情報が不完全な注文書。品質スコア45点で複数の問題が検出されました。通知は黄色で表示され、具体的な確認事項が列挙されます。

パターン3：エラー通知（赤色）
システムエラーが発生した場合の緊急アラート。管理者に即座に通知されます。

従来の情報共有では30分かかっていた報告が、今や0秒。しかも品質レベル付きの詳細情報として、チーム全員が同時に受信します。

これで、動画1から6で構築したPDF自動処理システムが、完全なチーム連携型システムに進化しました。個人の効率化がチーム全体の生産性向上に発展したのです。」

**画面表示**: 
- demonstrateSlackIntegration関数の実行
- 3パターンの通知の実際の表示
- 統合システム全体の動作確認
- チーム連携効果の可視化

---

### 🔚 まとめと次回予告（9:00-10:00）
**セリフ**:
「素晴らしい！個人の効率化がチーム全体の生産性向上に進化しました。

今回実装した通知システムの特徴をまとめると、
- 品質スコア別の自動色分け通知
- 構造化された詳細情報表示
- エラー時の緊急アラート機能
- 管理者への多層的通知システム

これで、情報共有のタイムラグが完全に解消され、チーム連携が劇的に改善されました。

いよいよ次回、最終回の動画8では、顧客対応の自動化とシステム全体の完成を目指します。

『これで完璧！顧客へのGmail自動返信と、エラー通知もGASで追加する』では、プロフェッショナルな顧客対応メール、包括的なエラーハンドリング、運用・保守のベストプラクティスまで、完全自動化システムを最終形態に仕上げます。

ついに、93%の業務削減を実現する究極のシステムが完成します。最後まで一緒に頑張りましょう！」

**画面表示**: 
- 今回の成果まとめ
- 次回動画のプレビュー
- 最終回への期待感醸成

---

## 📋 撮影チェックリスト

### 事前準備
- [ ] Slackワークスペースとテストチャンネルの準備
- [ ] Webhook URLの生成と動作確認
- [ ] 動画1-6の統合デモコードの動作確認
- [ ] 品質別通知メッセージのテンプレート準備
- [ ] エラー通知機能のテストケース準備
- [ ] AI受注処理フォルダにテスト用PDFを配置

### 撮影時の注意点
- [ ] 動画1-6の流れを踏襲したストーリー展開
- [ ] 統合フロー実行の全工程を画面で表示
- [ ] Slack連携の戦略的価値を強調
- [ ] 実際の通知表示を画面で確認
- [ ] 品質別の色分け効果を明確に示す
- [ ] チーム連携効果を具体的に説明

### 必要な画面録画
- [ ] Slack Webhook設定の全手順
- [ ] runVideo7CompleteFlow関数の実行
- [ ] 統合フロー各ステップの処理状況
- [ ] 品質別通知の実際の表示
- [ ] demonstrateSlackIntegration関数のデモ
- [ ] エラー通知システムのデモ
- [ ] checkAllSystemSetup関数による総合確認

### デモ用実行関数
- [ ] runVideo7CompleteFlow() - メイン統合フロー
- [ ] testSlackNotification() - Slack通知テスト
- [ ] demonstrateSlackIntegration() - 3パターンデモ
- [ ] checkAllSystemSetup() - 動画1-7総合確認