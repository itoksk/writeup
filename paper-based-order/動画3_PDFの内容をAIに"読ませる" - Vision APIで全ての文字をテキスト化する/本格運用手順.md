# 📖 本格運用への移行手順

## 🎯 現在の状況
✅ テストモードでOCR機能が正常動作  
✅ PDF処理→テキスト抽出→ファイル移動が完了  
⏳ 本格運用（実際のVision API）への移行が必要  

---

## 🚀 本格運用セットアップ（3ステップ）

### 1️⃣ Google Cloud Console で課金を有効化

**手順：**
1. [Google Cloud Console](https://console.cloud.google.com) にアクセス
2. プロジェクト「PDF自動処理」を選択
3. 左メニューから「請求」をクリック
4. 「請求先アカウントをリンク」をクリック
5. クレジットカード情報を入力して課金を有効化

**料金について：**
- Vision API：月1,000回まで無料
- 超過分：$1.50 per 1,000 requests
- 月50件処理なら実質無料

---

### 2️⃣ Apps Script でテストモードを無効化

**実行するコード：**
```javascript
// テストモード無効化
disableTestMode()

// 設定確認
checkProductionReadiness()
```

**確認項目：**
- ✅ Vision API キー: 設定済み
- ✅ フォルダ構成: 作成済み  
- ✅ テストモード: 無効
- ✅ Drive API: 利用可能

---

### 3️⃣ 本格運用開始

**実行するコード：**
```javascript
// 本格運用でPDF処理実行
processLatestPDF()
```

**処理フロー：**
1. 🔄 PDFファイル検出
2. 🖼️ PDF→画像変換（Drive API）
3. 👁️ Vision API でOCR実行
4. 📝 テキスト抽出・解析
5. 📁 処理済みフォルダに移動

---

## 🛠️ 便利な管理関数

### 設定状況の確認
```javascript
checkProductionReadiness()
```

### 移行手順の表示
```javascript
showProductionSetupGuide()
```

### テストモードに戻す（必要時）
```javascript
enableTestMode()
```

---

## 🔧 トラブルシューティング

### エラー: "This API method requires billing"
→ **解決策**: 手順1の課金有効化を実行

### エラー: "Bad image data"  
→ **解決策**: PDFが正しくアップロードされているか確認

### エラー: "PDF→画像変換失敗"
→ **解決策**: Drive APIのアクセス権限を確認

### OCR精度が低い場合
→ **改善策**: 
- PDFの解像度を上げる
- 背景白・文字黒にする  
- 手書き文字を丁寧に書く

---

## 📊 運用モニタリング

### 処理状況の確認
- Google Drive の「処理済み」フォルダで処理済みファイル数を確認
- Apps Script の実行ログで処理時間・エラー状況を確認

### コスト管理
- [Google Cloud Console](https://console.cloud.google.com) → 請求 → 使用量
- Vision API の月間利用回数を確認

### パフォーマンス最適化
- 大量処理時は Batch API の活用を検討
- 処理時間の長いファイルの特定と対策

---

## ✅ 本格運用チェックリスト

- [ ] Google Cloud Console で課金有効化完了
- [ ] `disableTestMode()` 実行完了
- [ ] `checkProductionReadiness()` で全項目クリア
- [ ] `processLatestPDF()` で実際のPDF処理成功
- [ ] 処理済みファイルが「処理済み」フォルダに移動
- [ ] 抽出テキストの内容確認
- [ ] エラーログに問題がないことを確認

🎉 **これで本格運用の準備完了です！**

次は動画4のChatGPT連携で、抽出したテキストから構造化データを作成します。