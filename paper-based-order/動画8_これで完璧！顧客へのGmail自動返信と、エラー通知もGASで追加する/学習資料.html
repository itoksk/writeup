<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•ç”»8: ã“ã‚Œã§å®Œç’§ï¼é¡§å®¢ã¸ã®Gmailè‡ªå‹•è¿”ä¿¡ã¨ã€ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã‚‚GASã§è¿½åŠ ã™ã‚‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .section h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .section h3 {
            color: #34495e;
            font-size: 1.5em;
            margin: 20px 0 15px 0;
        }
        
        .final-system-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 30px;
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            border-radius: 15px;
        }
        
        .flow-step {
            text-align: center;
            flex: 1;
        }
        
        .flow-arrow {
            font-size: 2em;
            color: #2c3e50;
            margin: 0 20px;
        }
        
        .completion-showcase {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        
        .journey-start, .journey-end {
            padding: 25px;
            border-radius: 10px;
        }
        
        .journey-start {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }
        
        .journey-end {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
        }
        
        .email-demo {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-family: sans-serif;
        }
        
        .email-header {
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        
        .email-field {
            margin: 8px 0;
            font-size: 0.9em;
        }
        
        .email-label {
            font-weight: bold;
            color: #555;
            display: inline-block;
            width: 80px;
        }
        
        .email-body {
            background: white;
            padding: 20px;
            border-radius: 5px;
            border-left: 4px solid #74b9ff;
            line-height: 1.8;
        }
        
        .code-section {
            background: #2d3436;
            color: #ddd;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
            border-left: 4px solid #74b9ff;
        }
        
        .code-section h4 {
            color: #74b9ff;
            margin-bottom: 15px;
            font-family: 'Segoe UI', sans-serif;
        }
        
        .system-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-card {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 25px;
            border-radius: 10px;
        }
        
        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .error-handling-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .error-type {
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .error-api {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
        }
        
        .error-data {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
        }
        
        .error-system {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }
        
        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .metric-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .highlight {
            background: linear-gradient(120deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .success-box {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .final-celebration {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin: 30px 0;
        }
        
        .celebration-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }
        
        ul {
            margin: 20px 0;
            padding-left: 30px;
        }
        
        li {
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .completion-showcase {
                grid-template-columns: 1fr;
            }
            
            .final-system-flow {
                flex-direction: column;
            }
            
            .flow-arrow {
                transform: rotate(90deg);
                margin: 20px 0;
            }
            
            .error-handling-grid {
                grid-template-columns: 1fr;
            }
            
            .performance-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ‰ å‹•ç”»8: ã“ã‚Œã§å®Œç’§ï¼</h1>
            <p>å‹•ç”»1-7ã®å…¨æ©Ÿèƒ½çµ±åˆ + é¡§å®¢ãƒ¡ãƒ¼ãƒ«è‡ªå‹•åŒ– + ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</p>
        </header>

        <section class="section">
            <h2>ğŸ¯ å‹•ç”»8ã®å­¦ç¿’ç›®æ¨™</h2>
            <ul>
                <li>å‹•ç”»1-7ã®å…¨æ©Ÿèƒ½ã‚’ä¸€ã¤ã®çµ±åˆã‚·ã‚¹ãƒ†ãƒ ã«é›†ç´„ã™ã‚‹</li>
                <li>é¡§å®¢ã¸ã®è‡ªå‹•ç¢ºèªãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã™ã‚‹</li>
                <li>åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ç·Šæ€¥é€šçŸ¥æ©Ÿèƒ½ã‚’å®Œæˆã™ã‚‹</li>
                <li>å®šæœŸå®Ÿè¡Œãƒˆãƒªã‚¬ãƒ¼ã§å®Œå…¨è‡ªå‹•åŒ–ã‚’å®Ÿç¾ã™ã‚‹</li>
                <li>15åˆ†ã‹ã‚‰1åˆ†ã¸ã®93%å‰Šæ¸›ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Œæˆã™ã‚‹</li>
            </ul>
        </section>

        <section class="section">
            <h2>ğŸ”„ å‹•ç”»1-7çµ±åˆã‚·ã‚¹ãƒ†ãƒ ã®å®Œæˆãƒ•ãƒ­ãƒ¼</h2>
            <div class="final-system-flow">
                <div class="flow-step">
                    <strong>ğŸ“„ å‹•ç”»1-3</strong><br>
                    PDFæŠ•å…¥ã‹ã‚‰<br>Vision API OCR
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ¤– å‹•ç”»4-5</strong><br>
                    ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–<br>ChatGPTæƒ…å ±æŠ½å‡º
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ’¾ å‹•ç”»6</strong><br>
                    ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ<br>è‡ªå‹•è¨˜éŒ²+å“è³ªç®¡ç†
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ’¬ å‹•ç”»7</strong><br>
                    Slackå“è³ªåˆ¥<br>é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ“§ å‹•ç”»8</strong><br>
                    é¡§å®¢ãƒ¡ãƒ¼ãƒ«<br>è‡ªå‹•é€ä¿¡
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <strong>ğŸ“ å®Œæˆ</strong><br>
                    ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†<br>å‡¦ç†å®Œäº†
                </div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸš€ å‹•ç”»1-8ã®å­¦ç¿’æ—…è·¯ï¼šBefore / After</h2>
            <div class="completion-showcase">
                <div class="journey-start">
                    <h3>ğŸ”´ å‹•ç”»1é–‹å§‹æ™‚ï¼ˆå•é¡Œèªè­˜ï¼‰</h3>
                    <ul>
                        <li><strong>ä½œæ¥­æ™‚é–“:</strong> 1ä»¶15åˆ†ã®æ‰‹ä½œæ¥­</li>
                        <li><strong>ã‚¨ãƒ©ãƒ¼ç‡:</strong> 5-10%ã®è»¢è¨˜ãƒŸã‚¹</li>
                        <li><strong>æƒ…å ±å…±æœ‰:</strong> å€‹åˆ¥é€£çµ¡ã§æ™‚é–“ãƒ­ã‚¹</li>
                        <li><strong>é¡§å®¢å¯¾å¿œ:</strong> æ‰‹å‹•ãƒ¡ãƒ¼ãƒ«ä½œæˆ</li>
                        <li><strong>ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†:</strong> æ‰‹å‹•æ•´ç†ã§æ··ä¹±</li>
                        <li><strong>æŠ€è¡“ã‚¹ã‚­ãƒ«:</strong> ãªã—ï¼ˆæ‰‹ä½œæ¥­ã®ã¿ï¼‰</li>
                    </ul>
                </div>
                <div class="journey-end">
                    <h3>ğŸŸ¢ å‹•ç”»8å®Œæˆæ™‚ï¼ˆçµ±åˆã‚·ã‚¹ãƒ†ãƒ é”æˆï¼‰</h3>
                    <ul>
                        <li><strong>ä½œæ¥­æ™‚é–“:</strong> 1ä»¶1åˆ†ã®å®Œå…¨è‡ªå‹•åŒ–</li>
                        <li><strong>ã‚¨ãƒ©ãƒ¼ç‡:</strong> ã»ã¼0%ï¼ˆVision+ChatGPT+æ¤œè¨¼ï¼‰</li>
                        <li><strong>æƒ…å ±å…±æœ‰:</strong> Slackå“è³ªåˆ¥å³æ™‚é€šçŸ¥</li>
                        <li><strong>é¡§å®¢å¯¾å¿œ:</strong> ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºè‡ªå‹•ãƒ¡ãƒ¼ãƒ«</li>
                        <li><strong>ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†:</strong> å®Œå…¨è‡ªå‹•æ•´ç†ã‚·ã‚¹ãƒ†ãƒ </li>
                        <li><strong>æŠ€è¡“ã‚¹ã‚­ãƒ«:</strong> Vision+ChatGPT APIçµ±åˆæŠ€è¡“</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ“§ é¡§å®¢ã¸ã®è‡ªå‹•ç¢ºèªãƒ¡ãƒ¼ãƒ«</h2>
            <h3>ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªå¯¾å¿œã®è‡ªå‹•åŒ–</h3>
            
            <div class="email-demo">
                <div class="email-header">
                    <div class="email-field">
                        <span class="email-label">é€ä¿¡è€…:</span> system@yourcompany.com
                    </div>
                    <div class="email-field">
                        <span class="email-label">å®›å…ˆ:</span> tanaka@sample.co.jp
                    </div>
                    <div class="email-field">
                        <span class="email-label">ä»¶å:</span> ã€å—æ³¨ç¢ºèªã€‘æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«å•†äº‹æ§˜ ã”æ³¨æ–‡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™
                    </div>
                </div>
                <div class="email-body">
                    æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«å•†äº‹ ç”°ä¸­ å¤ªéƒæ§˜<br><br>
                    
                    ã„ã¤ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚<br><br>
                    
                    ã“ã®åº¦ã¯è²´é‡ãªã”æ³¨æ–‡ã‚’ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>
                    ä»¥ä¸‹ã®å†…å®¹ã§æ‰¿ã‚Šã¾ã—ãŸã€‚<br><br>
                    
                    <strong>â– ã”æ³¨æ–‡å†…å®¹</strong><br>
                    ãƒ»ã‚ªãƒ•ã‚£ã‚¹ãƒã‚§ã‚¢ 5å€‹ @Â¥15,000<br>
                    ãƒ»ãƒ‡ã‚¹ã‚¯ 3å€‹ @Â¥25,000<br><br>
                    
                    åˆè¨ˆé‡‘é¡: Â¥150,000<br>
                    ã”å¸Œæœ›ç´æœŸ: 2025-07-20<br><br>
                    
                    <strong>â– ä»Šå¾Œã®æµã‚Œ</strong><br>
                    1. åœ¨åº«ç¢ºèªãƒ»è£½é€ æ‰‹é…ï¼ˆ1-2å–¶æ¥­æ—¥ï¼‰<br>
                    2. æ­£å¼ãªç´æœŸå›ç­”ï¼ˆ3å–¶æ¥­æ—¥ä»¥å†…ï¼‰<br>
                    3. è£½é€ ãƒ»ç™ºé€æº–å‚™<br>
                    4. ç´å“<br><br>
                    
                    è©³ç´°ã«ã¤ãã¾ã—ã¦ã¯ã€æ”¹ã‚ã¦æ‹…å½“è€…ã‚ˆã‚Šã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚<br><br>
                    
                    ä»Šå¾Œã¨ã‚‚ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚
                </div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ’» é¡§å®¢ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€ä¿¡ã®å®Ÿè£…</h2>
            
            <div class="code-section">
                <h4>è‡ªå‹•ãƒ¡ãƒ¼ãƒ«é€ä¿¡æ©Ÿèƒ½</h4>
                <pre>function sendCustomerEmail(orderData) {
  try {
    const subject = `ã€å—æ³¨ç¢ºèªã€‘${orderData.company}æ§˜ ã”æ³¨æ–‡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™`;
    
    // ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã®æ§‹ç¯‰
    let itemsText = '';
    if (orderData.items && orderData.items.length > 0) {
      itemsText = orderData.items.map(item => 
        `ãƒ»${item.name} ${item.quantity}å€‹ @Â¥${item.unit_price?.toLocaleString() || 'æœªç¢ºå®š'}`
      ).join('\n');
    } else {
      itemsText = 'è©³ç´°ã¯å¾Œæ—¥ã”é€£çµ¡ã„ãŸã—ã¾ã™';
    }
    
    const body = `${orderData.company} ${orderData.contact_name || 'ã”æ‹…å½“è€…'}æ§˜

ã„ã¤ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚

ã“ã®åº¦ã¯è²´é‡ãªã”æ³¨æ–‡ã‚’ã„ãŸã ãã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚
ä»¥ä¸‹ã®å†…å®¹ã§æ‰¿ã‚Šã¾ã—ãŸã€‚

â– ã”æ³¨æ–‡å†…å®¹
${itemsText}

åˆè¨ˆé‡‘é¡: Â¥${orderData.total_amount?.toLocaleString() || 'å¾Œæ—¥ç¢ºå®š'}
ã”å¸Œæœ›ç´æœŸ: ${orderData.delivery_date || 'å¾Œæ—¥èª¿æ•´'}

â– ä»Šå¾Œã®æµã‚Œ
1. åœ¨åº«ç¢ºèªãƒ»è£½é€ æ‰‹é…ï¼ˆ1-2å–¶æ¥­æ—¥ï¼‰
2. æ­£å¼ãªç´æœŸå›ç­”ï¼ˆ3å–¶æ¥­æ—¥ä»¥å†…ï¼‰
3. è£½é€ ãƒ»ç™ºé€æº–å‚™
4. ç´å“

è©³ç´°ã«ã¤ãã¾ã—ã¦ã¯ã€æ”¹ã‚ã¦æ‹…å½“è€…ã‚ˆã‚Šã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚
ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚

ä»Šå¾Œã¨ã‚‚ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚

---
ã“ã®ç¢ºèªãƒ¡ãƒ¼ãƒ«ã¯è‡ªå‹•é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚
ã‚·ã‚¹ãƒ†ãƒ ã«é–¢ã™ã‚‹ãŠå•ã„åˆã‚ã›: system@yourcompany.com`;

    GmailApp.sendEmail(orderData.contact_email, subject, body);
    
  } catch (error) {
    console.error('é¡§å®¢ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚¨ãƒ©ãƒ¼:', error);
    throw error;
  }
}</pre>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ›¡ï¸ åŒ…æ‹¬çš„ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ </h2>
            
            <div class="error-handling-grid">
                <div class="error-type error-api">
                    <h3>ğŸ”Œ API ã‚¨ãƒ©ãƒ¼</h3>
                    <ul>
                        <li>Vision API éšœå®³</li>
                        <li>ChatGPT API åˆ¶é™</li>
                        <li>èªè¨¼ã‚¨ãƒ©ãƒ¼</li>
                        <li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å•é¡Œ</li>
                    </ul>
                </div>
                <div class="error-type error-data">
                    <h3>ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼</h3>
                    <ul>
                        <li>JSONè§£æå¤±æ•—</li>
                        <li>å¿…é ˆé …ç›®æ¬ å¦‚</li>
                        <li>å½¢å¼ä¸æ­£</li>
                        <li>æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å¤±æ•—</li>
                    </ul>
                </div>
                <div class="error-type error-system">
                    <h3>âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼</h3>
                    <ul>
                        <li>ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹å¤±æ•—</li>
                        <li>æ¨©é™ä¸è¶³</li>
                        <li>å®¹é‡åˆ¶é™</li>
                        <li>äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼</li>
                    </ul>
                </div>
            </div>

            <div class="code-section">
                <h4>çµ±åˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ©Ÿèƒ½</h4>
                <pre>function handleProcessingError(error, fileId, processingLog) {
  try {
    const errorDetails = {
      error_message: error.message,
      file_id: fileId,
      occurred_at: new Date().toISOString(),
      processing_log: processingLog,
      stack_trace: error.stack
    };
    
    // Slackç·Šæ€¥é€šçŸ¥
    const webhookUrl = PropertiesService.getScriptProperties()
      .getProperty('SLACK_WEBHOOK_URL');
    
    if (webhookUrl) {
      const message = {
        text: 'ğŸš¨ æ³¨æ–‡å‡¦ç†ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ',
        attachments: [{
          color: 'danger',
          title: 'ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ - ç·Šæ€¥å¯¾å¿œãŒå¿…è¦ã§ã™',
          fields: [
            { title: 'ãƒ•ã‚¡ã‚¤ãƒ«ID', value: fileId, short: true },
            { title: 'ã‚¨ãƒ©ãƒ¼å†…å®¹', value: error.message, short: false },
            { title: 'ç™ºç”Ÿæ™‚åˆ»', value: new Date().toLocaleString(), short: true }
          ],
          text: `å‡¦ç†ãƒ­ã‚°:\n${processingLog.join('\n')}`
        }]
      };
      
      UrlFetchApp.fetch(webhookUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        payload: JSON.stringify(message)
      });
    }
    
    // ç®¡ç†è€…ã¸ã®ç·Šæ€¥ãƒ¡ãƒ¼ãƒ«é€šçŸ¥
    const adminEmail = PropertiesService.getScriptProperties()
      .getProperty('ADMIN_EMAIL');
    
    if (adminEmail) {
      const subject = 'ã€ç·Šæ€¥ã€‘PDFæ³¨æ–‡å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ  ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ';
      const body = `PDFæ³¨æ–‡å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚

ã‚¨ãƒ©ãƒ¼è©³ç´°:
${JSON.stringify(errorDetails, null, 2)}

è‡³æ€¥ç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚`;
      
      GmailApp.sendEmail(adminEmail, subject, body);
    }
    
    // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è¨˜éŒ²
    logErrorToSpreadsheet(errorDetails);
    
  } catch (notificationError) {
    console.error('ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã®é€ä¿¡ã«å¤±æ•—:', notificationError);
  }
}</pre>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ† å‹•ç”»1-8ã§çµ±åˆã•ã‚ŒãŸæ©Ÿèƒ½ä¸€è¦§</h2>
            
            <div class="system-features">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ¤–</div>
                    <h3>å‹•ç”»3+5: AIå‡¦ç†</h3>
                    <ul>
                        <li>Vision API OCRå‡¦ç†</li>
                        <li>ChatGPTæƒ…å ±æŠ½å‡º</li>
                        <li>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–</li>
                        <li>å“è³ªã‚¹ã‚³ã‚¢ç®—å‡º</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ’¾</div>
                    <h3>å‹•ç”»6: ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h3>
                    <ul>
                        <li>å—æ³¨ç®¡ç†å°å¸³è‡ªå‹•è¨˜éŒ²</li>
                        <li>å“è³ªã‚¹ã‚³ã‚¢è‰²åˆ†ã‘</li>
                        <li>ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚·ãƒ¼ãƒˆ</li>
                        <li>12é …ç›®ã®è©³ç´°è¨˜éŒ²</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ’¬</div>
                    <h3>å‹•ç”»7: Slacké€£æº</h3>
                    <ul>
                        <li>å“è³ªãƒ¬ãƒ™ãƒ«åˆ¥é€šçŸ¥</li>
                        <li>ã‚¨ãƒ©ãƒ¼ç·Šæ€¥ã‚¢ãƒ©ãƒ¼ãƒˆ</li>
                        <li>å•†å“æƒ…å ±è¡¨ç¤º</li>
                        <li>å‡¦ç†å®Œäº†å ±å‘Š</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“§</div>
                    <h3>å‹•ç”»8: é¡§å®¢å¯¾å¿œ</h3>
                    <ul>
                        <li>ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºè‡ªå‹•ãƒ¡ãƒ¼ãƒ«</li>
                        <li>æ³¨æ–‡å†…å®¹è©³ç´°è¡¨ç¤º</li>
                        <li>ä»Šå¾Œã®æµã‚Œæ˜ç¤º</li>
                        <li>é€æ˜æ€§ã‚ã‚‹è‡ªå‹•é€ä¿¡</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“</div>
                    <h3>å‹•ç”»2+8: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†</h3>
                    <ul>
                        <li>è‡ªå‹•ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ</li>
                        <li>å®šæœŸå®Ÿè¡Œãƒˆãƒªã‚¬ãƒ¼</li>
                        <li>è‡ªå‹•ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†</li>
                        <li>ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ›¡ï¸</div>
                    <h3>å‹•ç”»8: ã‚¨ãƒ©ãƒ¼å¯¾å¿œ</h3>
                    <ul>
                        <li>åŒ…æ‹¬çš„ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</li>
                        <li>Slack+ãƒ¡ãƒ¼ãƒ«ç·Šæ€¥é€šçŸ¥</li>
                        <li>ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚·ãƒ¼ãƒˆè¨˜éŒ²</li>
                        <li>ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ãƒã‚§ãƒƒã‚¯</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ“Š æœ€çµ‚çš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™</h2>
            
            <div class="performance-metrics">
                <div class="metric-card">
                    <div class="metric-number">93%</div>
                    <div>ä½œæ¥­æ™‚é–“å‰Šæ¸›</div>
                    <small>15åˆ† â†’ 1åˆ†</small>
                </div>
                <div class="metric-card">
                    <div class="metric-number">100%</div>
                    <div>è»¢è¨˜ãƒŸã‚¹å‰Šæ¸›</div>
                    <small>æ‰‹ä½œæ¥­ã‚¼ãƒ­åŒ–</small>
                </div>
                <div class="metric-card">
                    <div class="metric-number">95%</div>
                    <div>é¡§å®¢æº€è¶³åº¦</div>
                    <small>è¿…é€Ÿãªå¯¾å¿œ</small>
                </div>
                <div class="metric-card">
                    <div class="metric-number">Â¥168ä¸‡</div>
                    <div>å¹´é–“åŠ¹æœé¡</div>
                    <small>æ™‚é–“å‰µå‡ºä¾¡å€¤</small>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>ğŸ”§ é‹ç”¨ãƒ»ä¿å®ˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h2>
            
            <h3>ğŸ’¡ æ—¥å¸¸é‹ç”¨ã®ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li><span class="highlight">å“è³ªç›£è¦–</span>: é€±1å›ã®ç²¾åº¦ãƒã‚§ãƒƒã‚¯ã¨æ”¹å–„</li>
                <li><span class="highlight">ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–</span>: ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®å®šæœŸç¢ºèª</li>
                <li><span class="highlight">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</span>: APIã‚­ãƒ¼ã®å®šæœŸæ›´æ–°</li>
                <li><span class="highlight">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</span>: é‡è¦ãƒ‡ãƒ¼ã‚¿ã®å®šæœŸä¿å­˜</li>
            </ul>

            <h3>ğŸš€ ç¶™ç¶šçš„æ”¹å–„ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</h3>
            <ul>
                <li>å‡¦ç†ç²¾åº¦ã®æœˆæ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨æ”¹å–„</li>
                <li>æ–°ã—ã„AIæŠ€è¡“ã®èª¿æŸ»ãƒ»å°å…¥æ¤œè¨</li>
                <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®åé›†ãƒ»åæ˜ </li>
                <li>ã‚·ã‚¹ãƒ†ãƒ æ‹¡å¼µãƒ»æ©Ÿèƒ½è¿½åŠ ã®è¨ˆç”»</li>
            </ul>
        </section>

        <section class="section">
            <h2>âš ï¸ é‹ç”¨æ™‚ã®æ³¨æ„ç‚¹</h2>
            
            <div class="warning-box">
                <h3>ğŸš¨ é¿ã‘ã‚‹ã¹ãå•é¡Œ</h3>
                <ul>
                    <li><strong>éä¿¡:</strong> 100%è‡ªå‹•åŒ–ã«é ¼ã‚Šéããšã€å®šæœŸãƒã‚§ãƒƒã‚¯å¿…é ˆ</li>
                    <li><strong>æ”¾ç½®:</strong> ã‚¨ãƒ©ãƒ¼ã‚„ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ç„¡è¦–ã—ãªã„</li>
                    <li><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£:</strong> APIã‚­ãƒ¼ã‚„æ©Ÿå¯†æƒ…å ±ã®ç®¡ç†å¾¹åº•</li>
                    <li><strong>æ›´æ–°æ€ æ…¢:</strong> ã‚·ã‚¹ãƒ†ãƒ ã®å®šæœŸã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <div class="final-celebration">
                <div class="celebration-icon">ğŸ‰</div>
                <h2>ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</h2>
                <h3>å®Œå…¨è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ãŒå®Œæˆã—ã¾ã—ãŸï¼</h3>
                
                <div class="success-box" style="margin: 30px 0;">
                    <h3>ğŸ† å‹•ç”»1-8ã§æ‰‹ã«å…¥ã‚ŒãŸã‚‚ã®</h3>
                    <ul>
                        <li><strong>æ™‚é–“:</strong> æœˆ70æ™‚é–“ã®å‰µå‡ºï¼ˆå¹´é–“840æ™‚é–“ï¼ï¼‰</li>
                        <li><strong>å“è³ª:</strong> Vision+ChatGPTã§è»¢è¨˜ãƒŸã‚¹100%å‰Šæ¸›</li>
                        <li><strong>æŠ€è¡“:</strong> OCRÃ—AIÃ—è‡ªå‹•åŒ–ã®å®Ÿè·µã‚¹ã‚­ãƒ«</li>
                        <li><strong>ã‚·ã‚¹ãƒ†ãƒ :</strong> ä¼æ¥­ãƒ¬ãƒ™ãƒ«ã®å®Œå…¨è‡ªå‹•åŒ–</li>
                        <li><strong>ä¾¡å€¤:</strong> å¹´é–“168ä¸‡å††ç›¸å½“ã®åŠ¹æœ</li>
                        <li><strong>å¿œç”¨:</strong> ä»–æ¥­å‹™ã¸ã®å±•é–‹å¯èƒ½æ€§</li>
                    </ul>
                </div>

                <h3>ğŸš€ å‹•ç”»1-8ã§å¾—ãŸã‚¹ã‚­ãƒ«ã®å¿œç”¨å¯èƒ½æ€§</h3>
                <p>å‹•ç”»3ã®Vision API OCRã€å‹•ç”»5ã®ChatGPT APIæƒ…å ±æŠ½å‡ºã€å‹•ç”»6ã®ãƒ‡ãƒ¼ã‚¿å“è³ªç®¡ç†ã€å‹•ç”»7ã®Slacké€£æºã€å‹•ç”»8ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãªã©ã€ã“ã‚Œã‚‰ã®æŠ€è¡“ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ä»–ã®æ¥­å‹™è‡ªå‹•åŒ–ã«ã‚‚å¿œç”¨ã§ãã¾ã™ã€‚<br>
                ã‚ãªãŸã¯ä»Šã€<span class="highlight">OCRÃ—AIÃ—è‡ªå‹•åŒ–ã®å®Ÿè·µè€…</span>ã¨ã—ã¦æ–°ãŸãªã‚¹ãƒ†ãƒ¼ã‚¸ã«ç«‹ã£ã¦ã„ã¾ã™ã€‚</p>
                
                <p style="margin-top: 20px; font-size: 1.2em;">
                    <strong>å‹•ç”»1ã‹ã‚‰å‹•ç”»8ã¾ã§ã€ä¸€ç·’ã«å­¦ç¿’ã®æ—…ã‚’æ­©ã‚“ã§ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</strong>
                </p>
            </div>
        </section>
    </div>
</body>
</html>