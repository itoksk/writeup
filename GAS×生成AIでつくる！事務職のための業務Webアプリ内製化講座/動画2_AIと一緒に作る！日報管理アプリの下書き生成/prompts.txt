# 第2回：AIと一緒に作る！日報管理アプリの下書き生成
# 使用プロンプト集

---

## プロンプト0: 機能要件の洗い出しヒアリング（新規追加）

### 使用タイミング
コード生成前の要件整理時、または既存フォームのカスタマイズ時

### プロンプト本文

```
あなたは業務システム設計の専門家です。
**Google Apps Script（GAS）**を使った日報管理アプリを作成するにあたり、必要な機能を一緒に整理してください。

【現在決まっていること】
- 使用ツール: **Googleフォーム**、**Googleスプレッドシート**、**Google Apps Script（GAS）**
- 基本機能: フォームから日報を入力し、スプレッドシートに自動蓄積

以下の観点で、必要な機能を質問してください：
1. **入力項目**: どんな情報を記録したいですか？（日付、氏名、業務内容、所感など）
2. **入力方法**: どんな入力形式が使いやすいですか？（テキスト入力、プルダウン、日付選択など）
3. **必須/任意**: どの項目を必須にしますか？
4. **データの保存先**: スプレッドシートの列構成はどうしますか？
5. **通知機能**: 提出時にメール通知などは必要ですか？
6. **集計・検索**: どのようにデータを活用したいですか？

この質問に答えることで、Google Apps Scriptのコード生成に必要な仕様を固めます。
```

### 期待される回答例

```
【機能要件の整理】

1. 入力項目
   → 日付、氏名、業務内容、所感の4項目

2. 入力形式
   → 日付: 日付選択
   → 氏名: プルダウン（メンバー名を事前登録）
   → 業務内容: 長文テキスト
   → 所感: 長文テキスト（任意）

3. 必須/任意
   → 日付、氏名、業務内容: 必須
   → 所感: 任意

4. スプレッドシートの列構成
   → A列: タイムスタンプ、B列: 日付、C列: 氏名、D列: 業務内容、E列: 所感

5. 通知機能
   → 今回は不要（将来的に検討）

6. 集計・検索
   → 氏名別、日付別に検索できるようにしたい

【次のステップ】
この仕様をもとに、Google Apps Scriptのコードを生成しましょう。
```

---

## プロンプト1: ChatGPTでGASコードを生成（再現性重視版）

### 使用タイミング
動画内デモ（3:30-5:30）、受講者の実践時

### プロンプト本文

```
**Google Apps Script（GAS）**で、**Googleフォーム**の送信内容を**Googleスプレッドシート**に転記するコードを作成してください。

【技術仕様】
- プラットフォーム: **Google Apps Script**
- イベントトリガー: フォーム送信時（onFormSubmit）
- 対象サービス: Googleフォーム、Googleスプレッドシート

【フォーム項目（項目順）】
1. 日付（日付形式）
2. 氏名（短い回答）
3. 業務内容（段落形式）
4. 所感（段落形式）

【スプレッドシートの列構成】
- A列: タイムスタンプ（送信日時）
- B列: 日付
- C列: 氏名
- D列: 業務内容
- E列: 所感
- シート名: 「シート1」

【処理フロー】
1. フォーム送信イベント（e）を受け取る
2. 送信内容（itemResponses）を取得
3. タイムスタンプを生成（new Date()）
4. 各項目の値を取得（itemResponses[0], [1], [2], [3]）
5. スプレッドシートの最終行に追加（appendRow）

【コード要件】
- 関数名: `onFormSubmit`
- 引数: `e`（フォーム送信イベントオブジェクト）
- 各行に日本語コメントを付ける
- 変数名は分かりやすい日本語ローマ字（例: timestamp, name, content, feedback）
- エラーハンドリングは今回不要（基本形のみ）

上記の仕様に従って、Google Apps Scriptのコードを生成してください。
```

### 期待される回答例

```javascript
function onFormSubmit(e) {
  // フォームの送信内容を取得
  var itemResponses = e.response.getItemResponses();

  // スプレッドシートを取得
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('シート1');

  // タイムスタンプを取得
  var timestamp = new Date();

  // 各項目の回答を取得
  var date = itemResponses[0].getResponse();        // 日付
  var name = itemResponses[1].getResponse();        // 氏名
  var content = itemResponses[2].getResponse();     // 業務内容
  var feedback = itemResponses[3].getResponse();    // 所感

  // スプレッドシートの最終行に追加
  sheet.appendRow([timestamp, date, name, content, feedback]);
}
```

### 注意点
- AIの出力するコードは毎回少し異なります
- コメントの有無や変数名が違うことがありますが、機能は同じです
- エラーが出た場合は、「エラー内容を教えてください」とAIに再度質問してください

---

## プロンプト2: Geminiでコード生成（再現性重視・比較用）

### 使用タイミング
受講者が別のAIでも試したい時、またはGeminiの詳しいコメントが欲しい時

### プロンプト本文

```
**Googleフォーム**の送信データを**Googleスプレッドシート**に自動転記する**Google Apps Script（GAS）**のコードを書いてください。

【技術仕様】
- プラットフォーム: **Google Apps Script**
- イベントトリガー: フォーム送信時（onFormSubmit関数）
- 対象サービス: Googleフォーム、Googleスプレッドシート

【フォームの入力項目（項目順）】
1. 日付（日付形式）
2. 氏名（短い回答）
3. 業務内容（段落形式・長文）
4. 所感・気づき（段落形式・長文、任意項目）

【スプレッドシートの列構成】
- A列: 送信日時（タイムスタンプ）
- B列: 日付
- C列: 氏名
- D列: 業務内容
- E列: 所感
- シート名: 「シート1」

【処理フロー】
1. フォーム送信イベント（e）を受け取る
2. アクティブなスプレッドシートから「シート1」を取得
3. 送信日時を取得（new Date()）
4. フォームの回答を取得（e.response.getItemResponses()）
5. 各項目の値を配列の順番通りに取得（itemResponses[0], [1], [2], [3]）
6. スプレッドシートの最終行に追加（appendRow）

【コード要件】
- 関数名: `onFormSubmit`
- 引数: `e`（フォーム送信イベントオブジェクト）
- **初心者向けに、各行に詳しい日本語コメントを付けてください**
- 変数名は分かりやすい名前を使用（timestamp, sheet, itemResponses など）
- JSDocコメント（/** */）で関数の説明も追加してください
- エラーハンドリングは不要（基本形のみ）

上記の仕様に厳密に従って、Google Apps Scriptのコードを生成してください。
```

### 期待される回答例

Geminiは日本語のコメントをより詳しく付けてくれる傾向があります。

```javascript
/**
 * フォーム送信時に実行される関数
 * @param {Object} e - フォーム送信イベントオブジェクト
 */
function onFormSubmit(e) {
  // アクティブなスプレッドシートの「シート1」を取得
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('シート1');

  // 送信日時を取得
  var timestamp = new Date();

  // フォームの回答を取得
  var responses = e.response.getItemResponses();

  // 各項目の値を取得
  var date = responses[0].getResponse();        // 日付
  var name = responses[1].getResponse();        // 氏名
  var content = responses[2].getResponse();     // 業務内容
  var feedback = responses[3].getResponse();    // 所感

  // 新しい行としてデータを追加
  sheet.appendRow([timestamp, date, name, content, feedback]);

  // ログに記録（デバッグ用）
  Logger.log('日報を追加しました: ' + name + ' - ' + date);
}
```

---

## プロンプト3: エラー対処用プロンプト

### 使用タイミング
コードを貼り付けて実行した際にエラーが出た時

### プロンプト本文（テンプレート）

```
Google Apps Scriptで以下のエラーが出ました。
原因と解決方法を教えてください。

【エラー内容】
[ここにエラーメッセージをコピペ]

【実行したコード】
[ここにコードをコピペ]

【状況】
- Googleフォームから送信テストを実行
- Apps Scriptエディタに上記コードを貼り付けて保存済み
```

### 使い方
1. Apps Scriptエディタでエラーが出た時、エラーメッセージをコピー
2. [エラー内容] 部分に貼り付け
3. [実行したコード] 部分に、自分が貼り付けたコードをコピペ
4. AIに質問

### よくあるエラーと対処法

**エラー1**: `TypeError: Cannot read property 'getItemResponses' of null`
- **原因**: トリガーが設定されていない、またはフォームと連携していない
- **対処**: 次回（第3回）でトリガー設定を行います。今回はエラーが出ても正常です

**エラー2**: `ReferenceError: e is not defined`
- **原因**: 手動実行しようとした（フォーム送信時のみ動作する関数）
- **対処**: フォームから実際に送信テストを行う必要があります。次回で実施します

**エラー3**: `Cannot find sheet named 'シート1'`
- **原因**: スプレッドシートのシート名が違う
- **対処**: コード内の `'シート1'` を実際のシート名に変更

---

## プロンプト4: コードのカスタマイズ依頼（再現性重視版）

### 使用タイミング
自分の業務に合わせてコードを変更したい時

### プロンプト本文（テンプレート）

```
以下の**Google Apps Script（GAS）**のコードを、要件に合わせて修正してください。

【現在のコード】
```javascript
[ここに現在のコードを正確にコピペ]
```

【変更したい内容】
- [変更点1（例：「作業時間」という項目を追加したい）]
- [変更点2（例：データを「日報」という名前のシートに保存したい）]
- [変更点3（例：氏名の代わりにメールアドレスを記録したい）]

【技術仕様（変更後）】
- プラットフォーム: **Google Apps Script**
- 対象サービス: Googleフォーム、Googleスプレッドシート
- 関数名: `onFormSubmit`（変更しない）
- イベントトリガー: フォーム送信時（変更しない）

【出力要件】
1. 修正後のコード全体を提示してください
2. 変更箇所に「// 🔄 変更: 〇〇を追加」のようなコメントを付けてください
3. コード全体の動作フローも簡潔に説明してください

上記の仕様に従って、Google Apps Scriptのコードを修正してください。
```

### 使い方例

**例1: 項目を追加したい場合**
```
【変更したい内容】
- 「作業時間（分）」という項目を追加したい
- スプレッドシートのF列に記録したい
```

**例2: シート名を変更したい場合**
```
【変更したい内容】
- データを「日報」という名前のシートに保存したい
- 「シート1」ではなく「日報」シートを使用
```

**例3: データの並び順を変えたい場合**
```
【変更したい内容】
- スプレッドシートの列順を変更したい
- A列: 氏名、B列: 日付、C列: タイムスタンプ、D列: 業務内容、E列: 所感
```

---

## プロンプト活用のコツ（第2回版）

### 1. コード生成時は「詳細なコメントを付けて」と指定
- AIは指示しないとコメントを省略することがあります
- 「初心者向けに」「各行にコメント」と明記すると親切なコードが得られます

### 2. エラーは恐れずAIに相談
- エラーメッセージをそのままコピペして質問してOK
- AIは「このエラーは〇〇が原因です」と教えてくれます

### 3. 段階的にカスタマイズ
- いきなり複雑な機能を追加せず、まず基本形を動かす
- 動いたら「ここに〇〇を追加したい」と段階的に依頼

### 4. 複数AIで比較する意義
- ChatGPT: 簡潔で実用的なコード
- Gemini: 日本語コメントが詳しい
- Claude: 説明が丁寧で、セキュリティ面の注意も教えてくれる

### 5. コードの理解は後回しでOK
- 今は「動けば良い」という姿勢でOK
- 何度か使ううちに、自然と理解が深まります

---

## よくある質問

**Q1: AIが生成したコードは、そのまま使って大丈夫ですか？**
A1: 基本的にはOKですが、以下を確認してください：
    - フォーム項目の順番が合っているか
    - シート名が正しいか
    - 変数名が分かりやすいか（後から見て理解できるか）

**Q2: コードをコピペしたのに動きません**
A2: 今回はまだトリガー設定をしていないので、動かなくて正常です。
    次回（第3回）でトリガーを設定すれば動くようになります。

**Q3: ChatGPTとGemini、どちらを使えばいいですか？**
A3: どちらでもOKです。迷ったらChatGPTから始めてください。
    Geminiは日本語のコメントが詳しい傾向があります。

**Q4: コードが長すぎて、どこを修正すればいいか分かりません**
A4: 「このコードの〇〇の部分を△△に変更したい」とAIに質問してください。
    修正箇所を具体的に教えてくれます。

---

## demo_code/daily_report_draft.gs の使い方

このフォルダには、動画で生成したGASコードのサンプルが入っています。

### ファイルの内容
- **daily_report_draft.gs**: ChatGPTが生成したコード例
- コメント付きで、初心者でも理解しやすい構造

### 使い方
1. このファイルを開いて内容を確認
2. 自分のApps Scriptエディタにコピペ
3. フォーム項目の順番やシート名を、自分の環境に合わせて修正

### 注意点
- これはあくまで「例」です。自分のフォーム構成に合わせて調整してください
- トリガー設定は第3回で行います。今回は貼り付けるだけでOK

---

## 次回予告

次回（第3回）では、今回作ったコードを実際に動かします。

**次回使用予定のプロンプト**:
- 「トリガー設定の手順を教えて」
- 「スプレッドシートのヘッダー行を追加するコード」
- 「Googleサイトに埋め込む方法」

お楽しみに！

---

**ファイル作成日**: 2025-10-25
**対象動画**: 第2回（10分）
**使用AI**: ChatGPT、Gemini
**次回**: トリガー設定、動作確認、Googleサイト公開
